<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="May the Force be with you.">
<meta property="og:type" content="website">
<meta property="og:title" content="hxt&#39;s Blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="hxt&#39;s Blog">
<meta property="og:description" content="May the Force be with you.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="hxt">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>hxt's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">hxt's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>æ—¥ç¨‹è¡¨</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/07/27/Transformer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/07/27/Transformer/" class="post-title-link" itemprop="url">Transformer</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-07-27 23:07:02" itemprop="dateCreated datePublished" datetime="2025-07-27T23:07:02+08:00">2025-07-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-30 23:17:07" itemprop="dateModified" datetime="2025-07-30T23:17:07+08:00">2025-07-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Transformer/" itemprop="url" rel="index"><span itemprop="name">Transformer</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>3.2k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>3 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å‚è€ƒï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/datawhalechina/leedl-tutorial/releases/tag/v1.2.4">æå®æ¯…æ·±åº¦å­¦ä¹ æ•™ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://datawhalechina.github.io/happy-llm/#/">Happy-LLM</a></li>
</ul>
<p>æ€»ç»“æ„å¦‚ä¸‹ï¼Œè¢«æ¡†ä½çš„éƒ¨åˆ†ä¸€èˆ¬éƒ½æœ‰Nä¸ª</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727221346536.png" alt="image-20250727221346536">
<figcaption aria-hidden="true">image-20250727221346536</figcaption>
</figure>
<h2 id="è‡ªæ³¨æ„åŠ›æœºåˆ¶">è‡ªæ³¨æ„åŠ›æœºåˆ¶</h2>
<p>è‡ªæ³¨æ„åŠ›æ¨¡å‹ä¼šâ€œåƒâ€æ•´ä¸ªåºåˆ—çš„æ•°æ®ï¼Œè¾“å…¥å‡ ä¸ªå‘é‡ï¼Œå®ƒå°±è¾“å‡ºå‡ ä¸ªå‘é‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727225641856.png" alt="image-20250727225641856" style="zoom:67%;"></p>
<p>å¯¹äºè¾“å…¥åºåˆ—ä¸­çš„æ¯ä¸ª
tokenï¼ˆå‘é‡ï¼‰ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—å‡ºä¸‰ä¸ªçŸ©é˜µï¼šï¼ˆXä¸ºè¾“å…¥çŸ©é˜µå³å¤šä¸ªå‘é‡çš„ç»„åˆï¼Œä¹˜ä»¥å¯¹åº”çš„çŸ©é˜µå¾—åˆ°
Qã€Kã€Vï¼‰</p>
<ul>
<li><strong>Query (Q)</strong>ï¼šæŸ¥è¯¢å‘é‡ï¼Œ<span class="math inline">\(Q
= XW^Q\)</span></li>
<li><strong>Key (K)</strong>ï¼šé”®å‘é‡ï¼Œ<span class="math inline">\(K =
XW^K\)</span></li>
<li><strong>Value (V)</strong>ï¼šå€¼å‘é‡ï¼Œ<span class="math inline">\(V =
XW^V\)</span></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727230428672.png" alt="image-20250727230428672" style="zoom:80%;"></p>
<p>è®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼ˆsoftmax åï¼‰ï¼š <span class="math display">\[
\text{Attention}(Q, K, V) =
\text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V
\]</span> <span class="math inline">\(d_k\)</span> æ˜¯ Key
å‘é‡çš„ç»´åº¦ï¼ˆç”¨äºç¼©æ”¾é¿å…æ¢¯åº¦è¿‡å¤§ï¼‰</p>
<blockquote>
<p><strong>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼š</p>
<p>Transformer å®é™…ä½¿ç”¨çš„æ˜¯ <strong>å¤šå¤´è‡ªæ³¨æ„åŠ›</strong>ï¼š</p>
<ul>
<li>å°† Qã€Kã€V æ‹†æˆå¤šä¸ªå­ç©ºé—´ï¼Œåˆ†åˆ«è®¡ç®—æ³¨æ„åŠ›ï¼›</li>
<li>ç„¶åå°†å¤šä¸ªâ€œå¤´â€çš„ç»“æœæ‹¼æ¥å†çº¿æ€§å˜æ¢ã€‚</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727230452594.png" alt="image-20250727230452594" style="zoom:80%;"></p>
</blockquote>
<h2 id="ç¼–ç å™¨">ç¼–ç å™¨</h2>
<p>ç¼–ç å™¨è¾“å…¥ä¸€æ’å‘é‡ï¼Œè¾“å‡ºå¦å¤–ä¸€æ’å‘é‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727220019098.png" alt="image-20250727220019098" style="zoom:50%;"></p>
<p>ç¼–ç å™¨å†…éƒ¨å¯ä»¥åˆ†ä¸ºå¤šä¸ªå—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727220057077.png" alt="image-20250727220057077" style="zoom:67%;"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æ¯ä¸ªå—çš„ç»†èŠ‚</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727221138994.png" alt="image-20250727221138994">
<figcaption aria-hidden="true">image-20250727221138994</figcaption>
</figure>
<p>è¿™é‡Œä½¿ç”¨å±‚å½’ä¸€åŒ–ï¼Œå› ä¸ºå±‚å½’ä¸€åŒ–ä¼šåœ¨æ¯ä¸ªæ ·æœ¬ä¸Šè®¡ç®—å…¶æ‰€æœ‰å±‚çš„å‡å€¼å’Œæ–¹å·®ï¼Œä»è€Œä½¿æ¯ä¸ªæ ·æœ¬çš„åˆ†å¸ƒè¾¾åˆ°ç¨³å®šã€‚</p>
<h2 id="è§£ç å™¨">è§£ç å™¨</h2>
<h3 id="è‡ªå›å½’è§£ç å™¨">è‡ªå›å½’è§£ç å™¨</h3>
<p>åœ¨ç”Ÿæˆåºåˆ—æ—¶ï¼Œæ¯ä¸€æ­¥ä»…åŸºäº<strong>å½“å‰åŠä¹‹å‰çš„token</strong>é¢„æµ‹ä¸‹ä¸€ä¸ªtokenï¼Œè¿™å°±è¦ç”¨åˆ°æ©è”½è‡ªæ³¨æ„åŠ›ï¼ˆmasked
self-attentionï¼‰ï¼Œæ©è”½è‡ªæ³¨æ„åŠ›å¯ä»¥é€šè¿‡ä¸€ä¸ªæ©ç ï¼ˆmaskï¼‰æ¥é˜»æ­¢æ¯ä¸ªä½ç½®é€‰æ‹©å…¶åé¢çš„è¾“å…¥ä¿¡æ¯ã€‚</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727221042825.png" alt="image-20250727221042825">
<figcaption aria-hidden="true">image-20250727221042825</figcaption>
</figure>
<h3 id="éè‡ªå›å½’è§£ç å™¨">éè‡ªå›å½’è§£ç å™¨</h3>
<p>æ˜¯ä¸€ç§å¹¶è¡Œç”Ÿæˆåºåˆ—çš„æ¨¡å‹ï¼Œä¸è‡ªå›å½’ï¼ˆARï¼‰è§£ç å™¨é€æ­¥ç”Ÿæˆçš„æ–¹å¼ä¸åŒï¼Œå®ƒä¸€æ¬¡æ€§è¾“å‡ºæ•´ä¸ªåºåˆ—ï¼Œæ˜¾è‘—æå‡äº†æ¨ç†é€Ÿåº¦ï¼Œä½†å¯èƒ½ç‰ºç‰²ç”Ÿæˆè´¨é‡ã€‚</p>
<p>ä¾‹å¦‚ï¼šç»™ç¼–ç å™¨ä¸€å † <code>&lt;BOS&gt;</code>
çš„è¯å…ƒã€‚å‡è®¾è¾“å‡ºçš„å¥å­çš„é•¿åº¦æœ‰ä¸Šé™ï¼Œç»å¯¹ä¸ä¼šè¶…è¿‡ 300 ä¸ªå­—ã€‚ç»™ç¼–ç å™¨ 300
ä¸ª <code>&lt;BOS&gt;</code>ï¼Œå°±ä¼šè¾“å‡º 300 ä¸ªå­—ï¼Œè¾“å‡º
<code>&lt;EOS&gt;</code> å³è¾¹çš„çš„è¾“å‡ºå°±å½“å®ƒæ²¡æœ‰è¾“å‡ºã€‚</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727221617793.png" alt="image-20250727221617793">
<figcaption aria-hidden="true">image-20250727221617793</figcaption>
</figure>
<h2 id="ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›">ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›</h2>
<p>ç¼–ç å™¨çš„æœ€ç»ˆè¾“å‡ºï¼ˆå³æœ€åä¸€å±‚çš„éšè—çŠ¶æ€ï¼‰ä¼šä½œä¸º<strong>Keyå’ŒValue</strong>è¾“å…¥åˆ°è§£ç å™¨çš„<strong>æ¯ä¸€å±‚</strong>çš„äº¤å‰æ³¨æ„åŠ›ï¼ˆCross-Attentionï¼‰æ¨¡å—ä¸­ã€‚</p>
<p><img src="https://raw.githubusercontent.com/datawhalechina/happy-llm/main/docs/images/2-figures/2-0.jpg" style="zoom: 67%;"></p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250727224644292.png" alt="image-20250727224644292" style="zoom:80%;"></p>
<h2 id="æµç¨‹æ€»ç»“">æµç¨‹æ€»ç»“</h2>
<ol type="1">
<li><p><strong>è¾“å…¥é¢„å¤„ç†</strong></p>
<ul>
<li><p><strong>Tokenization</strong>ï¼šæ–‡æœ¬ â†’ Token IDsï¼ˆå¦‚
<code>[I, love, NLP]</code> â†’
<code>[1045, 2293, 4263]</code>ï¼‰ã€‚</p></li>
<li><p><strong>Embedding</strong>ï¼šToken IDs â†’
è¯å‘é‡ï¼ˆ<code>d_model</code> ç»´ï¼Œå¦‚ 512 ç»´ï¼‰ã€‚</p></li>
<li><p><strong>Positional Encoding</strong>ï¼šåŠ å…¥ä½ç½®ä¿¡æ¯ â†’ æœ€ç»ˆè¾“å…¥å‘é‡
<code>X = WordEmbedding + PositionalEncoding</code>ã€‚</p>
<blockquote>
<h4 id="ä½ç½®ç¼–ç çš„åŒºåˆ«">ä½ç½®ç¼–ç çš„åŒºåˆ«</h4>
<ul>
<li><p><strong>Transformerï¼ˆåŸå§‹æ¨¡å‹ï¼‰</strong>ï¼š</p>
<ul>
<li><p>ä½¿ç”¨
<strong>å›ºå®šçš„æ•°å­¦å‡½æ•°</strong>ï¼ˆæ­£å¼¦å’Œä½™å¼¦å‡½æ•°ï¼‰ç”Ÿæˆä½ç½®ç¼–ç ï¼Œä¸è¾“å…¥åµŒå…¥ï¼ˆtoken
embeddingsï¼‰<strong>ç›¸åŠ </strong>ã€‚</p></li>
<li><p>å…¬å¼ï¼š <span class="math display">\[
PE_{(pos, 2i)} =
\sin\left(\frac{pos}{10000^{2i/d_{\text{model}}}}\right), \quad
PE_{(pos, 2i+1)} =
\cos\left(\frac{pos}{10000^{2i/d_{\text{model}}}}\right)
\]</span></p>
<p>å…¶ä¸­ pos æ˜¯ä½ç½®ï¼Œi æ˜¯ç»´åº¦ç´¢å¼•ï¼Œd<sub>model</sub>
æ˜¯æ¨¡å‹ç»´åº¦ã€‚</p></li>
<li><p>è¿™ç§ç¼–ç æ˜¯ç¡®å®šæ€§çš„ï¼Œæ— éœ€å­¦ä¹ ï¼Œèƒ½æ•æ‰ç»å¯¹ä½ç½®å’Œç›¸å¯¹ä½ç½®å…³ç³»ã€‚</p></li>
</ul></li>
<li><p><strong>BERT</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ <strong>å¯å­¦ä¹ çš„ä½ç½®åµŒå…¥ï¼ˆLearned Positional
Embeddingsï¼‰</strong>ï¼Œå³æ¯ä¸ªä½ç½®ï¼ˆå¦‚æœ€å¤§é•¿åº¦512ï¼‰å¯¹åº”ä¸€ä¸ªéšæœºåˆå§‹åŒ–çš„å‘é‡ï¼Œé€šè¿‡è®­ç»ƒæ›´æ–°ã€‚</li>
<li>ä½ç½®åµŒå…¥ä¸ token embeddings <strong>ç›¸åŠ </strong>ï¼Œç±»ä¼¼
Transformerï¼Œä½†åµŒå…¥å€¼æ˜¯æ¨¡å‹å­¦åˆ°çš„ï¼Œè€Œéé¢„è®¾çš„æ•°å­¦å‡½æ•°</li>
</ul></li>
</ul>
</blockquote></li>
</ul></li>
<li><p><strong>Encoder é˜¶æ®µï¼ˆN ä¸€èˆ¬æ˜¯ 6 å±‚ï¼‰</strong></p>
<ul>
<li>æ¯å±‚æ‰§è¡Œï¼š
<ul>
<li><strong>å¤šå¤´è‡ªæ³¨æ„åŠ›</strong>ï¼ˆè®¡ç®—å…¨å±€ä¾èµ–ï¼‰</li>
<li><strong>å‰é¦ˆç½‘ç»œ FFN</strong>ï¼ˆéçº¿æ€§å˜æ¢ï¼‰</li>
<li><strong>æ®‹å·®è¿æ¥ + LayerNorm</strong>ï¼ˆç¨³å®šè®­ç»ƒï¼‰</li>
</ul></li>
<li>è¾“å‡ºï¼šä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„ç¼–ç è¡¨ç¤º <code>Z</code>ï¼ˆä¾› Decoder ä½¿ç”¨ï¼‰ã€‚</li>
</ul></li>
<li><p><strong>Decoder é˜¶æ®µï¼ˆN ä¸€èˆ¬æ˜¯ 6 å±‚ï¼‰</strong></p>
<ul>
<li>æ¯å±‚æ‰§è¡Œï¼š
<ul>
<li><strong>æ©ç è‡ªæ³¨æ„åŠ›</strong>ï¼ˆé˜²æ­¢æœªæ¥ä¿¡æ¯æ³„æ¼ï¼‰</li>
<li><strong>æ®‹å·®è¿æ¥ + LayerNorm</strong></li>
<li><strong>Encoder-Decoder æ³¨æ„åŠ›</strong>ï¼ˆå…³æ³¨ <code>Z</code>ï¼‰</li>
<li><strong>æ®‹å·®è¿æ¥ + LayerNorm</strong></li>
<li><strong>å‰é¦ˆç½‘ç»œ FFN</strong></li>
<li><strong>æ®‹å·®è¿æ¥ + LayerNorm</strong></li>
</ul></li>
<li>è¾“å‡ºï¼šè§£ç åçš„éšè—çŠ¶æ€ <code>H</code>ã€‚</li>
</ul></li>
<li><p><strong>è¾“å‡ºç”Ÿæˆ</strong></p>
<ul>
<li><strong>çº¿æ€§å±‚</strong>ï¼šå°† <code>H</code> æŠ•å½±åˆ°è¯è¡¨å¤§å°ç»´åº¦ï¼ˆå¦‚
50,000 ç»´ï¼‰ã€‚</li>
<li><strong>Softmax</strong>ï¼šç”Ÿæˆæ¦‚ç‡åˆ†å¸ƒ â†’ é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„ Token
ä½œä¸ºè¾“å‡ºï¼ˆæˆ–é‡‡æ ·ï¼‰ã€‚</li>
</ul></li>
<li><p><strong>è‡ªå›å½’ï¼ˆAutoregressiveï¼‰</strong></p>
<ul>
<li>è‹¥ä¸ºç”Ÿæˆä»»åŠ¡ï¼ˆå¦‚
GPTï¼‰ï¼Œå°†å½“å‰è¾“å‡ºä½œä¸ºä¸‹ä¸€æ­¥è¾“å…¥ï¼Œå¾ªç¯ç›´è‡³ç»“æŸã€‚</li>
</ul></li>
</ol>
<h2 id="bertå’Œgpt">BERTå’ŒGPT</h2>
<ul>
<li><strong>BERT</strong>ï¼ˆBidirectional Encoder Representations from
Transformersï¼‰â€”â€”å¡«ç©º
<ul>
<li><strong>åŒå‘ç¼–ç å™¨</strong>ï¼šä½¿ç”¨Transformerçš„<strong>Encoder</strong>éƒ¨åˆ†ï¼Œèƒ½åŒæ—¶åˆ©ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆå·¦å³åŒå‘ä¸Šä¸‹æ–‡ï¼‰ã€‚</li>
<li>é€‚åˆç†è§£å‹ä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬åˆ†ç±»ã€å®ä½“è¯†åˆ«ã€é—®ç­”ï¼‰ã€‚</li>
</ul></li>
<li><strong>GPT</strong>ï¼ˆGenerative Pre-trained
Transformerï¼‰â€”â€”é¢„æµ‹ä¸‹ä¸€ä¸ªè¯
<ul>
<li><strong>å•å‘è§£ç å™¨</strong>ï¼šä½¿ç”¨Transformerçš„<strong>Decoder</strong>éƒ¨åˆ†ï¼ˆæ©ç è‡ªæ³¨æ„åŠ›ï¼‰ï¼Œæ²¡æœ‰äº¤å‰æ³¨æ„åŠ›ï¼ˆå› ä¸ºæ²¡æœ‰ç¼–ç å™¨çš„è¾“å‡ºä½œä¸ºè¾“å…¥ï¼‰ï¼Œä»…ä¾èµ–å·¦ä¾§ä¸Šä¸‹æ–‡ç”Ÿæˆæ–‡æœ¬ã€‚</li>
<li>é€‚åˆç”Ÿæˆå‹ä»»åŠ¡ï¼ˆå¦‚æ–‡æœ¬ç”Ÿæˆã€å¯¹è¯ã€ç»­å†™ï¼‰ã€‚</li>
</ul></li>
</ul>
<h2 id="post-norm-å’Œ-pre-norm">Post-Norm å’Œ Pre-Norm</h2>
<p>åœ¨ Transformer åŠå…¶å˜ä½“æ¨¡å‹ä¸­ï¼Œ<strong>Pre-Norm</strong> å’Œ
<strong>Post-Norm</strong> æ˜¯ä¸¤ç§ä¸åŒçš„å±‚å½’ä¸€åŒ–ï¼ˆLayer Normalization,
LayerNormï¼‰æ”¾ç½®æ–¹å¼ï¼Œç›´æ¥å½±å“æ¨¡å‹çš„è®­ç»ƒç¨³å®šæ€§ã€æ”¶æ•›é€Ÿåº¦å’Œæ€§èƒ½ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„è¯¦ç»†å¯¹æ¯”ï¼š</p>
<h3 id="post-normåŸå§‹-transformer-è®¾è®¡"><strong>1. Post-Normï¼ˆåŸå§‹
Transformer è®¾è®¡ï¼‰</strong></h3>
<ul>
<li><p><strong>ç»“æ„é¡ºåº</strong>ï¼š</p>
<p><code>æ®‹å·®è¿æ¥ â†’ LayerNorm</code></p>
<p>å³ï¼š<br>
<span class="math display">\[
\text{Output} = \text{LayerNorm}(x + \text{Sublayer}(x))
\]</span></p>
<ul>
<li>ä¾‹å¦‚ï¼šå¤šå¤´æ³¨æ„åŠ›æˆ–å‰é¦ˆç½‘ç»œï¼ˆFFNï¼‰çš„è¾“å‡ºå…ˆä¸è¾“å…¥æ®‹å·®è¿æ¥ï¼Œå†è¿›è¡Œå½’ä¸€åŒ–ã€‚</li>
</ul></li>
<li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åŸå§‹ Transformer</strong>ï¼ˆè®ºæ–‡ä¸­çš„ç¼–ç å™¨/è§£ç å™¨ï¼‰å’Œ
<strong>GLM</strong>ï¼ˆç”±æ™ºè°±å¼€å‘çš„ä¸»æµä¸­æ–‡ LLM ä¹‹ä¸€ï¼‰ä½¿ç”¨
Post-Normã€‚</li>
<li>è®­ç»ƒåˆæœŸå¯èƒ½ä¸ç¨³å®šï¼ˆæ¢¯åº¦æ–¹å·®å¤§ï¼‰ï¼Œéœ€è¦é…åˆ <strong>warm-up</strong>
å­¦ä¹ ç‡è°ƒåº¦ã€‚</li>
<li>æ›´æ·±çš„æ¨¡å‹å®¹æ˜“å› æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸è€Œéš¾ä»¥è®­ç»ƒã€‚</li>
<li>ç†è®ºä¸Šæœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ï¼ˆå› å½’ä¸€åŒ–åœ¨éçº¿æ€§å˜æ¢åï¼‰ï¼Œä½†å®é™…éœ€è¦ç²¾ç»†è°ƒå‚ã€‚</li>
</ul></li>
</ul>
<h3 id="pre-normä¸»æµå˜ä½“è®¾è®¡"><strong>2.
Pre-Normï¼ˆä¸»æµå˜ä½“è®¾è®¡ï¼‰</strong></h3>
<ul>
<li><p><strong>ç»“æ„é¡ºåº</strong>ï¼š</p>
<p><code>LayerNorm â†’ æ®‹å·®è¿æ¥</code></p>
<p>å³ï¼š<br>
<span class="math display">\[
\text{Output} = x + \text{Sublayer}(\text{LayerNorm}(x))
\]</span></p>
<ul>
<li>å…ˆå¯¹è¾“å…¥å½’ä¸€åŒ–ï¼Œå†é€šè¿‡å­å±‚ï¼ˆå¦‚æ³¨æ„åŠ›æˆ–
FFNï¼‰ï¼Œæœ€åä¸åŸå§‹è¾“å…¥æ®‹å·®è¿æ¥ã€‚</li>
</ul></li>
<li><p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>BERTã€GPT ç­‰ç°ä»£æ¨¡å‹æ™®éé‡‡ç”¨ Pre-Norm</strong>ã€‚</li>
<li>è®­ç»ƒæ›´ç¨³å®šï¼Œæ— éœ€ warm-up ä¹Ÿèƒ½å¿«é€Ÿæ”¶æ•›ã€‚</li>
<li>æ”¯æŒæ›´æ·±çš„ç½‘ç»œï¼ˆå¦‚ 100+ å±‚ï¼‰ï¼Œæ¢¯åº¦ä¼ æ’­æ›´é¡ºç•…ã€‚</li>
<li>ç‰ºç‰²å°‘é‡ç†è®ºè¡¨è¾¾èƒ½åŠ›ï¼Œæ¢å–å®é™…è®­ç»ƒçš„é²æ£’æ€§ã€‚</li>
</ul></li>
</ul>
<h3 id="æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”"><strong>3. æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”</strong></h3>
<table>
<colgroup>
<col style="width: 21%">
<col style="width: 42%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>ç‰¹æ€§</th>
<th>Post-Norm</th>
<th>Pre-Norm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>å½’ä¸€åŒ–ä½ç½®</strong></td>
<td>æ®‹å·®è¿æ¥å</td>
<td>æ®‹å·®è¿æ¥å‰ï¼ˆå­å±‚è¾“å…¥ï¼‰</td>
</tr>
<tr class="even">
<td><strong>è®­ç»ƒç¨³å®šæ€§</strong></td>
<td>ä¾èµ– warm-upï¼Œæ˜“ä¸ç¨³å®š</td>
<td>æ›´ç¨³å®šï¼Œé€‚åˆæ·±å±‚æ¨¡å‹</td>
</tr>
<tr class="odd">
<td><strong>æ¢¯åº¦ä¼ æ’­</strong></td>
<td>å¯èƒ½æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸ï¼ˆæ·±æ¨¡å‹ï¼‰</td>
<td>æ¢¯åº¦æ›´å¹³ç¼“ï¼Œæ˜“äºä¼˜åŒ–</td>
</tr>
<tr class="even">
<td><strong>è¡¨è¾¾èƒ½åŠ›</strong></td>
<td>ç†è®ºä¸Šæ›´å¼ºï¼ˆéçº¿æ€§åå½’ä¸€åŒ–ï¼‰</td>
<td>ç¨å¼±ï¼Œä½†å®é™…å·®è·å°</td>
</tr>
<tr class="odd">
<td><strong>å…¸å‹åº”ç”¨</strong></td>
<td>åŸå§‹ Transformer</td>
<td>BERTã€GPTã€T5 ç­‰ç°ä»£æ¨¡å‹</td>
</tr>
</tbody>
</table>
<h3 id="å…¶ä»–å˜ä½“ä¸æ”¹è¿›"><strong>5. å…¶ä»–å˜ä½“ä¸æ”¹è¿›</strong></h3>
<ul>
<li><strong>ReZero Norm</strong>ï¼šå°†æ®‹å·®è¿æ¥ä¹˜ä»¥å¯å­¦ä¹ çš„æ ‡é‡ï¼ˆåˆå§‹ä¸º
0ï¼‰ï¼Œé€æ­¥å¢åŠ éçº¿æ€§å¼ºåº¦ï¼Œç»“åˆä¸¤è€…ä¼˜ç‚¹ã€‚</li>
<li><strong>Sandwich Norm</strong>ï¼šåœ¨å­å±‚å‰åéƒ½åŠ å…¥ LayerNormï¼ˆå¦‚
<code>Norm â†’ Sublayer â†’ Norm â†’ æ®‹å·®</code>ï¼‰ï¼Œè¿›ä¸€æ­¥æå‡ç¨³å®šæ€§ã€‚</li>
<li><strong>DeepNorm</strong>ï¼ˆå¾®è½¯ï¼‰ï¼šåœ¨ Post-Norm
åŸºç¡€ä¸Šè°ƒæ•´æ®‹å·®æƒé‡ï¼Œç”¨äºææ·±æ¨¡å‹ï¼ˆå¦‚ 1000 å±‚ï¼‰ã€‚</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/07/26/Go%20%E8%AF%AD%E8%A8%80%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E4%B8%8E%E5%8C%85%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/07/26/Go%20%E8%AF%AD%E8%A8%80%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E4%B8%8E%E5%8C%85%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">Goè¯­è¨€é¡¹ç›®ç®¡ç†ä¸åŒ…ç®¡ç†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-07-26 00:00:00" itemprop="dateCreated datePublished" datetime="2025-07-26T00:00:00+08:00">2025-07-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-27 00:10:36" itemprop="dateModified" datetime="2025-07-27T00:10:36+08:00">2025-07-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Go/" itemprop="url" rel="index"><span itemprop="name">Go</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>2.2k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ¬æ–‡ç”± ChatGPT ç”Ÿæˆ</p>
<h2 id="å¼•è¨€"><strong>å¼•è¨€</strong></h2>
<p>Go è¯­è¨€ä»¥å…¶ç®€æ´çš„è¯­æ³•å’Œå¼ºå¤§çš„å·¥å…·é“¾è‘—ç§°ï¼Œä½†å…¶ç‹¬ç‰¹çš„é¡¹ç›®ç®¡ç†æœºåˆ¶ï¼ˆå¦‚
<code>module</code>ã€<code>package</code> å’Œ
<code>GOPATH</code>ï¼‰å¸¸è®©åˆå­¦è€…å›°æƒ‘ã€‚æœ¬æ–‡å°†ç³»ç»Ÿæ¢³ç† Go
çš„é¡¹ç›®ç»“æ„ã€åŒ…ç®¡ç†è§„åˆ™å’Œæœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ é«˜æ•ˆç»„ç»‡ä»£ç ã€‚</p>
<hr>
<h2 id="ä»-gopath-åˆ°-go-moduleæ¼”è¿›å²"><strong>1. ä» GOPATH åˆ° Go
Moduleï¼šæ¼”è¿›å²</strong></h2>
<h3 id="gopath-æ—¶ä»£å·²æ·˜æ±°"><strong>1.1 GOPATH
æ—¶ä»£ï¼ˆå·²æ·˜æ±°ï¼‰</strong></h3>
<ul>
<li><strong>ä½œç”¨</strong>ï¼šå…¨å±€å·¥ä½œåŒºï¼Œæ‰€æœ‰é¡¹ç›®å¿…é¡»æ”¾åœ¨
<code>$GOPATH/src</code> ä¸‹ã€‚</li>
<li><strong>é—®é¢˜</strong>ï¼š
<ul>
<li>ä¾èµ–å…¨å±€å…±äº«ï¼Œæ˜“å†²çª</li>
<li>é¡¹ç›®è·¯å¾„ä¸çµæ´»</li>
</ul></li>
<li><strong>ç›®å½•ç»“æ„</strong>ï¼š <figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GOPATH/</span><br><span class="line">â”œâ”€â”€ src/github.com/user/project  # é¡¹ç›®ä»£ç </span><br><span class="line">â”œâ”€â”€ pkg/                        # ç¼–è¯‘åçš„åº“</span><br><span class="line">â””â”€â”€ bin/                        # å¯æ‰§è¡Œæ–‡ä»¶</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="go-moduleç°ä»£æ ‡å‡†"><strong>1.2 Go
Moduleï¼ˆç°ä»£æ ‡å‡†ï¼‰</strong></h3>
<ul>
<li><strong>æ ¸å¿ƒæ–‡ä»¶</strong>ï¼š<code>go.mod</code>ï¼ˆå®šä¹‰æ¨¡å—è·¯å¾„ã€ä¾èµ–é¡¹ï¼‰ã€‚</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼š
<ul>
<li>é¡¹ç›®å¯æ”¾åœ¨ä»»æ„è·¯å¾„</li>
<li>ä¾èµ–ç‰ˆæœ¬é”å®šï¼ˆ<code>go.sum</code>ï¼‰</li>
<li>æ”¯æŒè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆå¦‚ <code>v1.2.3</code>ï¼‰</li>
</ul></li>
</ul>
<figure class="highlight go"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go.mod ç¤ºä¾‹</span></span><br><span class="line">module github.com/user/project  <span class="comment">// å…¨å±€å”¯ä¸€æ ‡è¯†</span></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.21</span>                        <span class="comment">// Go ç‰ˆæœ¬è¦æ±‚</span></span><br><span class="line">require (</span><br><span class="line">    github.com/gin-gonic/gin v1<span class="number">.9</span><span class="number">.1</span>  <span class="comment">// ä¾èµ–é¡¹ï¼Œä¿å­˜çš„ä½ç½®ï¼š%GOPATH%\pkg\mod\</span></span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="æ¨¡å—moduleä¸åŒ…packageçš„å…³ç³»"><strong>2.
æ¨¡å—ï¼ˆModuleï¼‰ä¸åŒ…ï¼ˆPackageï¼‰çš„å…³ç³»</strong></h2>
<h3 id="moduleé¡¹ç›®çš„é›†è£…ç®±"><strong>2.1
Moduleï¼šé¡¹ç›®çš„é›†è£…ç®±</strong></h3>
<ul>
<li><strong>ä¸€ä¸ªé¡¹ç›® = ä¸€ä¸ªæ¨¡å— = ä¸€ä¸ª <code>go.mod</code>
æ–‡ä»¶</strong></li>
<li><strong>æ¨¡å—è·¯å¾„</strong>éœ€å…¨å±€å”¯ä¸€ï¼ˆå¦‚ GitHub ä»“åº“åœ°å€ï¼‰ï¼š
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go mod init github.com/yourname/project</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="packageä»£ç çš„é€»è¾‘å•å…ƒ"><strong>2.2
Packageï¼šä»£ç çš„é€»è¾‘å•å…ƒ</strong></h3>
<ul>
<li><strong>è§„åˆ™</strong>ï¼š
<ul>
<li>åŒä¸€ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å¿…é¡»å±äº<strong>åŒä¸€ä¸ªåŒ…</strong></li>
<li>åŒ…åé€šå¸¸ä¸ç›®å½•åä¸€è‡´ï¼ˆéå¼ºåˆ¶ï¼‰</li>
<li>å¤§å†™å­—æ¯å¼€å¤´çš„æ ‡è¯†ç¬¦å¯è¢«å…¶ä»–åŒ…è®¿é—®</li>
</ul></li>
<li><strong>ç¤ºä¾‹</strong>ï¼š <figure class="highlight go"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pkg/utils/strings.go</span></span><br><span class="line"><span class="keyword">package</span> utils</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Trim</span><span class="params">(s <span class="type">string</span>)</span></span> <span class="type">string</span> {  <span class="comment">// å¯å¯¼å‡ºçš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">return</span> strings.TrimSpace(s)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<p>æ‰€ä»¥ä¸€ä¸ªé¡¹ç›®ç›¸å½“äºä¸€ä¸ª moduleï¼ŒåŒ…å«å¤šä¸ª package</p>
<hr>
<h2 id="å…³é”®ç›®å½•ç»“æ„è®¾è®¡"><strong>3. å…³é”®ç›®å½•ç»“æ„è®¾è®¡</strong></h2>
<h3 id="æ ‡å‡†å¸ƒå±€"><strong>3.1 æ ‡å‡†å¸ƒå±€</strong></h3>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">my-project/</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â”œâ”€â”€ go.sum</span><br><span class="line">â”œâ”€â”€ cmd/</span><br><span class="line">â”‚   â””â”€â”€ main.go</span><br><span class="line">â”œâ”€â”€ pkg/</span><br><span class="line">â”‚   â””â”€â”€ utils/</span><br><span class="line">â”‚       â””â”€â”€ math.go</span><br><span class="line">â””â”€â”€ internal/          # ç§æœ‰ä»£ç ï¼ˆä»…é™å½“å‰æ¨¡å—ä½¿ç”¨ï¼‰</span><br><span class="line">    â””â”€â”€ secret/</span><br><span class="line">        â””â”€â”€ secret.go</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ç‰¹æ®Šç›®å½•è¯´æ˜"><strong>3.2 ç‰¹æ®Šç›®å½•è¯´æ˜</strong></h3>
<table>
<thead>
<tr class="header">
<th>ç›®å½•</th>
<th>ç”¨é€”</th>
<th>å¯è§æ€§è§„åˆ™</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>cmd/</code></td>
<td>å­˜æ”¾ <code>main</code> åŒ…çš„å¯æ‰§è¡Œç¨‹åº</td>
<td>æ— é™åˆ¶</td>
</tr>
<tr class="even">
<td><code>internal/</code></td>
<td>å†…éƒ¨ç§æœ‰ä»£ç </td>
<td>ä»…çˆ¶æ¨¡å—å¯å¯¼å…¥</td>
</tr>
<tr class="odd">
<td><code>pkg/</code></td>
<td>å…¬å…±åº“ä»£ç </td>
<td>å¯è¢«å…¶ä»–æ¨¡å—å¯¼å…¥</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="åŒ…packageçš„è¿›é˜¶è§„åˆ™"><strong>4.
åŒ…ï¼ˆPackageï¼‰çš„è¿›é˜¶è§„åˆ™</strong></h2>
<h3 id="main-åŒ…çš„ç‰¹æ®Šæ€§"><strong>4.1 <code>main</code>
åŒ…çš„ç‰¹æ®Šæ€§</strong></h3>
<ul>
<li>åªæœ‰<code>main</code>åŒ…æ‰èƒ½åŒ…å« <code>func main()</code></li>
<li>ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š <figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go build -o app cmd/app/main.go</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="go-ä¸­-package-çš„è°ƒç”¨é€»è¾‘">4.2 Go ä¸­ <code>package</code>
çš„è°ƒç”¨é€»è¾‘</h3>
<p>åœ¨ Go ä¸­ï¼š</p>
<ul>
<li>æ¯ä¸ª <code>.go</code> æ–‡ä»¶éƒ½å±äºæŸä¸ª
<code>package</code>ï¼ˆåŒ…ï¼‰ã€‚</li>
<li>åŒ…åå†³å®šäº†æ–‡ä»¶ä¹‹é—´èƒ½å¦äº’ç›¸å¼•ç”¨ã€‚</li>
<li><strong>ä¸»ç¨‹åºï¼ˆå…¥å£ï¼‰é€šå¸¸åœ¨ <code>package main</code>
ä¸­</strong>ï¼Œå…¶ä»–åŠŸèƒ½æ¨¡å—åˆ™å¯ä»¥å®šä¹‰ä¸ºè‡ªå®šä¹‰åŒ…ã€‚</li>
<li>å¦‚æœä½ æƒ³åœ¨ <code>main.go</code> ä¸­è°ƒç”¨å…¶ä»–åŒ…çš„å‡½æ•°ï¼Œå¿…é¡»ï¼š
<ol type="1">
<li>åœ¨ç›®æ ‡æ–‡ä»¶ä¸­å°†å‡½æ•°å <strong>å¤§å†™</strong>ï¼ˆè¡¨ç¤ºå¯¼å‡º
Exportedï¼‰ï¼›</li>
<li>åœ¨ <code>main.go</code> ä¸­ä½¿ç”¨ <code>import</code> å¼•å…¥åŒ…ï¼›</li>
<li>ä¿è¯ä»£ç åœ¨æ¨¡å—ç»“æ„ä¸‹èƒ½æ‰¾åˆ°åŒ…è·¯å¾„ã€‚</li>
</ol></li>
</ul>
<hr>
<h4 id="ç¤ºä¾‹">ğŸ”¹ ç¤ºä¾‹</h4>
<h5 id="é¡¹ç›®ç»“æ„">ğŸ“ é¡¹ç›®ç»“æ„</h5>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myproject/</span><br><span class="line">â”œâ”€â”€ go.mod</span><br><span class="line">â”œâ”€â”€ main.go</span><br><span class="line">â””â”€â”€ utils/</span><br><span class="line">    â””â”€â”€ mathutil.go</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h5 id="go.mod">ğŸ“„ go.mod</h5>
<figure class="highlight go"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module example.com/myproject</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.21</span></span><br></pre></td></tr></tbody></table></figure>
<hr>
<h5 id="utilsmathutil.go">ğŸ“„ utils/mathutil.go</h5>
<figure class="highlight go"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> utils</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add æ˜¯å¯¼å‡ºçš„å‡½æ•°ï¼ˆé¦–å­—æ¯å¤§å†™ï¼‰ï¼Œå¯ä»¥è¢«å…¶ä»–åŒ…è°ƒç”¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Add</span><span class="params">(a, b <span class="type">int</span>)</span></span> <span class="type">int</span> {</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h5 id="main.go">ğŸ“„ main.go</h5>
<figure class="highlight go"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"example.com/myproject/utils"</span>  <span class="comment">// å¼•å…¥æœ¬æ¨¡å—ä¸‹çš„ utils åŒ…</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    sum := utils.Add(<span class="number">3</span>, <span class="number">5</span>)  <span class="comment">// è°ƒç”¨ utils åŒ…ä¸­çš„ Add å‡½æ•°</span></span><br><span class="line">    fmt.Println(<span class="string">"Sum:"</span>, sum)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h4 id="æ€»ç»“è°ƒç”¨è§„åˆ™">ğŸ”¹ æ€»ç»“è°ƒç”¨è§„åˆ™</h4>
<table>
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th>å…ƒç´ </th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>package xxx</code></td>
<td>å†³å®šè¯¥æ–‡ä»¶å±äºå“ªä¸ªåŒ…</td>
</tr>
<tr class="even">
<td><code>import</code></td>
<td>åœ¨å¦ä¸€ä¸ªæ–‡ä»¶ä¸­å¼•ç”¨è¯¥åŒ…ï¼Œä½¿ç”¨çš„æ˜¯
<code>module è·¯å¾„ + åŒ…ç›¸å¯¹è·¯å¾„</code></td>
</tr>
<tr class="odd">
<td>å¯¼å‡ºå‡½æ•°</td>
<td>è¢«è°ƒç”¨çš„å‡½æ•°å¿…é¡» <strong>é¦–å­—æ¯å¤§å†™</strong>ï¼Œå¦åˆ™æ˜¯ç§æœ‰çš„</td>
</tr>
<tr class="even">
<td>go.mod</td>
<td>å¿…é¡»æ­£ç¡®å£°æ˜ <code>module</code>ï¼Œæ‰èƒ½è®© <code>import</code>
è·¯å¾„ç”Ÿæ•ˆ</td>
</tr>
</tbody>
</table>
<h3 id="å¯è§æ€§æ§åˆ¶"><strong>4.3 å¯è§æ€§æ§åˆ¶</strong></h3>
<ul>
<li><strong>å¤§å†™å­—æ¯å¼€å¤´</strong>ï¼šå¯è¢«å…¶ä»–åŒ…è®¿é—®ï¼ˆå¦‚
<code>func Public()</code>ï¼‰ã€‚</li>
<li><strong>å°å†™å­—æ¯å¼€å¤´</strong>ï¼šä»…é™åŒ…å†…ä½¿ç”¨ï¼ˆå¦‚
<code>func private()</code>ï¼‰ã€‚</li>
</ul>
<h3 id="åˆå§‹åŒ–å‡½æ•°-init"><strong>4.4 åˆå§‹åŒ–å‡½æ•°
<code>init()</code></strong></h3>
<ul>
<li>æ¯ä¸ªåŒ…å¯å®šä¹‰å¤šä¸ª <code>init()</code>ï¼ŒæŒ‰ä¾èµ–é¡ºåºè‡ªåŠ¨æ‰§è¡Œï¼š
<figure class="highlight go"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> db</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="built_in">println</span>(<span class="string">"æ•°æ®åº“è¿æ¥åˆå§‹åŒ–"</span>)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h2 id="ä¾èµ–ç®¡ç†å®æˆ˜"><strong>5. ä¾èµ–ç®¡ç†å®æˆ˜</strong></h2>
<h3 id="æ·»åŠ ä¾èµ–"><strong>5.1 æ·»åŠ ä¾èµ–</strong></h3>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get github.com/gin-gonic/gin@v1.9.1  <span class="comment"># æŒ‡å®šç‰ˆæœ¬</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="å¸¸ç”¨å‘½ä»¤"><strong>5.2 å¸¸ç”¨å‘½ä»¤</strong></h3>
<table>
<thead>
<tr class="header">
<th>å‘½ä»¤</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>go mod init</code></td>
<td>åˆå§‹åŒ–æ¨¡å—</td>
</tr>
<tr class="even">
<td><code>go mod tidy</code></td>
<td>åŒæ­¥ä¾èµ–é¡¹</td>
</tr>
<tr class="odd">
<td><code>go list -m all</code></td>
<td>æŸ¥çœ‹æ‰€æœ‰ä¾èµ–</td>
</tr>
<tr class="even">
<td><code>go mod vendor</code></td>
<td>åˆ›å»ºæœ¬åœ°ä¾èµ–å‰¯æœ¬ï¼ˆç¦»çº¿æ„å»ºï¼‰</td>
</tr>
</tbody>
</table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/05/13/std_thread/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/05/13/std_thread/" class="post-title-link" itemprop="url">std::thread</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-05-13 00:00:00" itemprop="dateCreated datePublished" datetime="2025-05-13T00:00:00+08:00">2025-05-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-27 00:13:08" itemprop="dateModified" datetime="2025-07-27T00:13:08+08:00">2025-07-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CPP/" itemprop="url" rel="index"><span itemprop="name">CPP</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ä¸€åŸºæœ¬ä½¿ç”¨æ–¹æ³•">ä¸€ã€åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h2>
<h3 id="åˆ›å»ºçº¿ç¨‹">1. åˆ›å»ºçº¿ç¨‹</h3>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printMessage</span><span class="params">()</span> </span>{</span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Hello from thread!"</span> &lt;&lt; std::endl;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(printMessage)</span></span>; <span class="comment">// å¯åŠ¨çº¿ç¨‹</span></span><br><span class="line">    t.<span class="built_in">join</span>(); <span class="comment">// ç­‰å¾…çº¿ç¨‹ç»“æŸ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="å¸¦å‚æ•°çš„çº¿ç¨‹">2. å¸¦å‚æ•°çš„çº¿ç¨‹</h3>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">printSum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>{</span><br><span class="line">    std::cout &lt;&lt; a + b &lt;&lt; std::endl;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(printSum, <span class="number">3</span>, <span class="number">4</span>)</span></span>; <span class="comment">// ä¼ å€¼å‚æ•°</span></span><br><span class="line">    t.<span class="built_in">join</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ä½¿ç”¨-lambda-è¡¨è¾¾å¼">3. ä½¿ç”¨ Lambda è¡¨è¾¾å¼</h3>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::thread <span class="title">t</span><span class="params">([]() {</span></span></span><br><span class="line"><span class="params"><span class="function">    std::cout &lt;&lt; <span class="string">"Lambda thread"</span> &lt;&lt; std::endl;</span></span></span><br><span class="line"><span class="params"><span class="function">})</span></span>;</span><br><span class="line">t.<span class="built_in">join</span>();</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ä½¿ç”¨æˆå‘˜å‡½æ•°">4. ä½¿ç”¨æˆå‘˜å‡½æ•°</h3>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Worker</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">doWork</span><span class="params">(<span class="type">int</span> times)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; times; ++i)</span><br><span class="line">            std::cout &lt;&lt; <span class="string">"Working..."</span> &lt;&lt; std::endl;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    Worker w;</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(&amp;Worker::doWork, &amp;w, <span class="number">3</span>)</span></span>;</span><br><span class="line">    t.<span class="built_in">join</span>();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="äºŒçº¿ç¨‹æ§åˆ¶">äºŒã€çº¿ç¨‹æ§åˆ¶</h2>
<h3 id="detach">1. <code>detach()</code></h3>
<p><code>std::thread::detach()</code> çš„æ„æ€æ˜¯ï¼š</p>
<ul>
<li>è®©çº¿ç¨‹ <strong>åå°è¿è¡Œï¼ˆdaemon-likeï¼‰</strong></li>
<li>ä¸»çº¿ç¨‹ <strong>ä¸å†è·Ÿè¸ªè¿™ä¸ªçº¿ç¨‹</strong>ï¼Œä½ ä¸èƒ½å†
<code>join()</code> å®ƒï¼Œä¹Ÿæ— æ³•æ§åˆ¶å®ƒ</li>
<li>å®ƒä¼šåœ¨è‡ªå·±å·¥ä½œå®Œæˆåè‡ªåŠ¨ç»“æŸ</li>
</ul>
<h4 id="ä½†å¦‚æœ-main-æå‰é€€å‡º">ä½†å¦‚æœ <code>main()</code> æå‰é€€å‡ºï¼Ÿ</h4>
<p>ä¸€æ—¦ <code>main()</code>
è¿”å›ï¼Œç¨‹åºçš„æ‰€æœ‰èµ„æºéƒ½ä¼šè¢«é‡Šæ”¾ï¼Œ<strong>åŒ…æ‹¬æ‰€æœ‰çº¿ç¨‹</strong>ï¼ˆä¸ç®¡ä»–ä»¬å¹²å®Œäº†æ²¡æœ‰ï¼‰ï¼</p>
<ul>
<li>å³ä½¿ä½ å·²ç» <code>detach()</code>
äº†çº¿ç¨‹ï¼Œå®ƒä¹Ÿå¯èƒ½<strong>æ²¡æœ‰æ—¶é—´å®Œæˆä»»åŠ¡</strong>ï¼›</li>
<li>ç¨‹åºå°±ç›´æ¥é€€å‡ºäº†ï¼Œ<strong>çº¿ç¨‹è¢«å¼ºåˆ¶æ€æ­»</strong>ï¼Œ<strong>ä»»åŠ¡ä¸­æ–­</strong>ï¼›</li>
<li>æ‰€ä»¥ä½ å¯èƒ½çœ‹ä¸åˆ°å®Œæ•´è¾“å‡ºï¼Œæˆ–è€…æ–‡ä»¶æ²¡ä¸‹è½½å®Œã€‚</li>
</ul>
<h4 id="ç¤ºä¾‹">ç¤ºä¾‹</h4>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">myfunc</span><span class="params">()</span> </span>{</span><br><span class="line">    std::<span class="built_in">thread</span>([] {</span><br><span class="line">        <span class="built_in">download</span>(<span class="string">"file.zip"</span>); <span class="comment">// ä¸‹è½½éœ€è¦ 4 ç§’</span></span><br><span class="line">    }).<span class="built_in">detach</span>();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="built_in">myfunc</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// é©¬ä¸Šé€€å‡ºï¼åå°çº¿ç¨‹ç›´æ¥è¢«ç»ˆæ­¢</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">/* è¿è¡Œç»“æœï¼šå¯èƒ½åªæ‰“å°å‡º 1ï½2 è¡Œâ€œDownloading ...â€ï¼Œç”šè‡³ä»€ä¹ˆéƒ½ä¸æ‰“å°ã€‚*/</span></span><br></pre></td></tr></tbody></table></figure>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">myfunc</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">([] {</span></span></span><br><span class="line"><span class="params"><span class="function">        download(<span class="string">"file.zip"</span>);</span></span></span><br><span class="line"><span class="params"><span class="function">    })</span></span>;</span><br><span class="line">    t.<span class="built_in">join</span>(); <span class="comment">// ç­‰å®ƒå¹²å®Œ</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="join">2. <code>join()</code></h3>
<p><code>std::thread::join()</code>
çš„ä½œç”¨æ˜¯ï¼š<strong>é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°ç›®æ ‡çº¿ç¨‹æ‰§è¡Œå®Œæˆ</strong>ã€‚</p>
<ul>
<li>å½“ä½ è°ƒç”¨
<code>t.join();</code>ï¼Œå½“å‰çº¿ç¨‹ï¼ˆæ¯”å¦‚ä¸»çº¿ç¨‹ï¼‰ä¼š<strong>æš‚åœè¿è¡Œ</strong>ï¼›</li>
<li>ä¸€ç›´ç­‰åˆ° <code>t</code> æ‰€ä»£è¡¨çš„é‚£ä¸ªå­çº¿ç¨‹è·‘å®Œï¼›</li>
<li>ç„¶åç»§ç»­æ‰§è¡Œåé¢çš„è¯­å¥ã€‚</li>
</ul>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š</p>
<ol type="1">
<li><p>ä¸€ä¸ªçº¿ç¨‹åªèƒ½ <code>join()</code> ä¸€æ¬¡</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::thread <span class="title">t</span><span class="params">(work)</span></span>;</span><br><span class="line">t.<span class="built_in">join</span>();</span><br><span class="line">t.<span class="built_in">join</span>(); <span class="comment">// å†æ¬¡è°ƒç”¨ä¼šå´©æºƒï¼Œçº¿ç¨‹å·²ç»ç»“æŸ</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>çº¿ç¨‹æœªå¯åŠ¨ä¸èƒ½ <code>join()</code></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::thread t;  <span class="comment">// é»˜è®¤æ„é€ ï¼Œæœªç»‘å®šå‡½æ•°</span></span><br><span class="line">t.<span class="built_in">join</span>();       <span class="comment">// å´©æºƒï¼Œçº¿ç¨‹æœªå¯åŠ¨</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>é€šå¸¸åœ¨ <code>joinable()</code> åˆ¤æ–­åè°ƒç”¨</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (t.<span class="built_in">joinable</span>()) {</span><br><span class="line">    t.<span class="built_in">join</span>();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ˜¯ä¸€ç§<strong>è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯</strong>ï¼Œé¿å…è°ƒç”¨éæ³•
<code>join()</code>ã€‚</p></li>
</ol>
<hr>
<h2 id="ä¸‰å¸¸è§æ³¨æ„äº‹é¡¹">ä¸‰ã€å¸¸è§æ³¨æ„äº‹é¡¹</h2>
<ol type="1">
<li><p><strong>ä¸è¦å¿˜è®°è°ƒç”¨ <code>join()</code> æˆ–
<code>detach()</code></strong>ï¼Œå¦åˆ™ç¨‹åºä¼šå´©æºƒã€‚</p></li>
<li><p><strong>ä¼ é€’å¼•ç”¨å‚æ•°æ—¶è¦ä½¿ç”¨ <code>std::ref</code></strong>ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span>&amp; x)</span> </span>{ x++; }</span><br><span class="line"><span class="function">std::thread <span class="title">t</span><span class="params">(update, std::ref(myInt))</span></span>;</span><br></pre></td></tr></tbody></table></figure></li>
<li><p><strong>é¿å…ä½¿ç”¨å±€éƒ¨å˜é‡ä¼ ç»™çº¿ç¨‹ï¼ˆå¯èƒ½æ‚¬ç©ºï¼‰</strong>ã€‚</p></li>
<li><p><strong>å¤šçº¿ç¨‹å…±äº«èµ„æºè¦æ³¨æ„åŠ é”</strong>ï¼Œä½¿ç”¨
<code>std::mutex</code> ç­‰åŒæ­¥åŸè¯­ã€‚</p></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/03/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/03/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">Linuxç½‘ç»œç¼–ç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-04-03 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š13:38:57" itemprop="dateCreated datePublished" datetime="2025-04-03T00:00:00+08:00">2025-04-03</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CPP/" itemprop="url" rel="index"><span itemprop="name">CPP</span></a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">ç½‘ç»œç¼–ç¨‹</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>18k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>16 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ç½‘ç»œç¼–ç¨‹åŸºç¡€api">ç½‘ç»œç¼–ç¨‹åŸºç¡€API</h2>
<p><strong>è¡¥å……çŸ¥è¯†</strong></p>
<ul>
<li>ä¸»æœºå­—èŠ‚åºï¼šä¸€èˆ¬ä¸º<strong>å°ç«¯åº</strong>ï¼ˆä½ä½æ”¾åœ¨è¾ƒå°çš„åœ°å€å¤„ï¼Œé«˜ä½æ”¾åœ¨è¾ƒå¤§çš„åœ°å€å¤„ï¼‰</li>
<li>ç½‘ç»œå­—èŠ‚åºï¼šä¸€èˆ¬ä¸º<strong>å¤§ç«¯åº</strong></li>
</ul>
<p>ç¤ºä¾‹ï¼š0x01234567ï¼Œå…¶ä¸­ 0x01 æ˜¯æœ€é«˜ä½æœ‰æ•ˆå­—èŠ‚ï¼Œ0x67
æ˜¯æœ€ä½ä½æœ‰æ•ˆå­—èŠ‚</p>
<h3 id="å¥—æ¥å­—åœ°å€">å¥—æ¥å­—åœ°å€</h3>
<p>å¥—æ¥å­—åœ°å€ï¼ˆ<strong>Socket Address</strong>ï¼‰æ˜¯ <strong>IP
åœ°å€å’Œç«¯å£å·çš„ç»„åˆ</strong>ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ç½‘ç»œä¸Šçš„ä¸€ä¸ªè¿›ç¨‹ã€‚</p>
<ol type="1">
<li><p><code>struct sockaddr</code></p>
<p><code>sockaddr</code>
æ˜¯ä¸€ä¸ª<strong>é€šç”¨çš„åœ°å€ç»“æ„ä½“</strong>ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">sockaddr</span> {</span><br><span class="line">    <span class="type">sa_family_t</span> sa_family;  <span class="comment">// åœ°å€æ—ï¼ˆAF_INET, AF_INET6ç­‰ï¼‰</span></span><br><span class="line">    <span class="type">char</span> sa_data[<span class="number">14</span>];       <span class="comment">// åœ°å€æ•°æ®ï¼ˆå…·ä½“çš„åœ°å€ä¿¡æ¯ï¼‰</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æˆå‘˜è§£æ</strong>ï¼š</p>
<ul>
<li><code>sa_family_t sa_family</code>ï¼šåœ°å€æ—ï¼ˆä¾‹å¦‚
<code>AF_INET</code> è¡¨ç¤º IPv4ï¼Œ<code>AF_INET6</code> è¡¨ç¤º IPv6ï¼‰ã€‚</li>
<li><code>char sa_data[14]</code>ï¼šå­˜å‚¨å…·ä½“çš„åœ°å€æ•°æ®ï¼ˆIP åœ°å€ +
ç«¯å£ï¼‰ã€‚</li>
</ul>
<p><strong>âš ï¸ <code>sockaddr</code>
æœ¬èº«ä¸ä¼šç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯ç”±æ›´å…·ä½“çš„ç»“æ„ä½“ï¼ˆå¦‚ <code>sockaddr_in</code> å’Œ
<code>sockaddr_in6</code>ï¼‰è¿›è¡Œæ‰©å±•ã€‚</strong></p></li>
<li><p><code>sockaddr_in</code>ï¼ˆIPv4 åœ°å€ï¼‰</p>
<p><code>sockaddr_in</code> ç»“æ„ä½“æ˜¯ <code>sockaddr</code>
çš„<strong>ä¸“é—¨ç‰ˆæœ¬</strong>ï¼Œç”¨äº<strong>IPv4 åœ°å€</strong>ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span>  <span class="comment">// sockaddr_in å®šä¹‰åœ¨è¿™ä¸ªå¤´æ–‡ä»¶ä¸­</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> {</span><br><span class="line">    <span class="type">sa_family_t</span> sin_family;   <span class="comment">// åœ°å€æ—ï¼ˆå¿…é¡»æ˜¯ AF_INETï¼‰</span></span><br><span class="line">    <span class="type">in_port_t</span> sin_port;       <span class="comment">// ç«¯å£å·ï¼ˆç½‘ç»œå­—èŠ‚åºï¼‰</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">in_addr</span> sin_addr;  <span class="comment">// IPv4 åœ°å€</span></span><br><span class="line">    <span class="type">char</span> sin_zero[<span class="number">8</span>];         <span class="comment">// å¤‡ç”¨å­—æ®µï¼ˆå¡«å……ç”¨ï¼Œä¸€èˆ¬ä¸ç”¨ï¼‰</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>è¿™é‡Œçš„<code>struct in_addrc</code>çš„è¯¦ç»†ä»£ç å®šä¹‰åœ¨<code>&lt;netinet/in.h&gt;</code>æ–‡ä»¶å¤´ä¸­ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">in_addr</span> {</span><br><span class="line">    <span class="type">uint32_t</span> s_addr;  <span class="comment">// 32 ä½ IPv4 åœ°å€ï¼ˆç½‘ç»œå­—èŠ‚åºï¼‰</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<p><strong>ç¤ºä¾‹ä»£ç ï¼ˆIPv4 åœ°å€è½¬æ¢ï¼‰ï¼š</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span>  <span class="comment">// åŒ…å« inet_pton å’Œ inet_ntoa</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> addr;</span><br><span class="line">    addr.sin_family = AF_INET;</span><br><span class="line">    addr.sin_port = <span class="built_in">htons</span>(<span class="number">8080</span>);  <span class="comment">// ç«¯å£å·è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åº</span></span><br><span class="line">    <span class="built_in">inet_pton</span>(AF_INET, <span class="string">"192.168.1.1"</span>, &amp;addr.sin_addr);  <span class="comment">// å°†IPå­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ ¼å¼</span></span><br><span class="line">    <span class="comment">// ç¬¬ä¸‰ä¸ªå‚æ•° &amp;addr.sin_addr è¡¨ç¤ºè½¬æ¢åçš„äºŒè¿›åˆ¶ IP åœ°å€çš„å­˜å‚¨ä½ç½®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å°è½¬æ¢åçš„ä¿¡æ¯</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"IP: "</span> &lt;&lt; <span class="built_in">inet_ntoa</span>(addr.sin_addr) &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Port: "</span> &lt;&lt; <span class="built_in">ntohs</span>(addr.sin_port) &lt;&lt; std::endl;  <span class="comment">// ç«¯å£è½¬æ¢å›ä¸»æœºå­—èŠ‚åº</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‡½æ•°è§£æ</strong>ï¼š</p>
<ul>
<li><code>htons(port)</code>ï¼šå°†ä¸»æœºå­—èŠ‚åºçš„<strong>ç«¯å£å·</strong>è½¬æ¢ä¸º<strong>ç½‘ç»œå­—èŠ‚åº</strong>ã€‚</li>
<li><code>ntohs(port)</code>ï¼šå°†ç½‘ç»œå­—èŠ‚åºçš„<strong>ç«¯å£å·</strong>è½¬æ¢å›<strong>ä¸»æœºå­—èŠ‚åº</strong>ã€‚</li>
<li><code>inet_pton(AF_INET, "192.168.1.1", &amp;addr.sin_addr)</code>ï¼šå°†
IPv4 å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ ¼å¼ã€‚ä¸ºäº†åç»­çš„ socket æ“ä½œï¼ˆä¾‹å¦‚
<code>connect</code> æˆ– <code>bind</code>ï¼‰èƒ½å¤Ÿä½¿ç”¨æ­£ç¡®çš„äºŒè¿›åˆ¶æ ¼å¼çš„ IP
åœ°å€ã€‚</li>
<li><code>inet_ntoa(addr.sin_addr)</code>ï¼šå°†äºŒè¿›åˆ¶ <strong>IP
åœ°å€</strong>è½¬æ¢ä¸ºå¯è¯»çš„å­—ç¬¦ä¸²ã€‚</li>
</ul></li>
<li><p><code>sockaddr_in6</code>ï¼ˆIPv6 åœ°å€ï¼‰</p>
<p>IPv6 åœ°å€ä½¿ç”¨ <code>sockaddr_in6</code> ç»“æ„ä½“ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">sockaddr_in6</span> {</span><br><span class="line">    <span class="type">sa_family_t</span> sin6_family;     <span class="comment">// åœ°å€æ—ï¼ˆå¿…é¡»æ˜¯ AF_INET6ï¼‰</span></span><br><span class="line">    <span class="type">in_port_t</span> sin6_port;         <span class="comment">// ç«¯å£å·ï¼ˆç½‘ç»œå­—èŠ‚åºï¼‰</span></span><br><span class="line">    <span class="type">uint32_t</span> sin6_flowinfo;      <span class="comment">// IPv6 æµé‡æ§åˆ¶ä¿¡æ¯ï¼ˆä¸€èˆ¬è®¾ä¸º 0ï¼‰</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">in6_addr</span> sin6_addr;   <span class="comment">// IPv6 åœ°å€</span></span><br><span class="line">    <span class="type">uint32_t</span> sin6_scope_id;      <span class="comment">// ä½œç”¨åŸŸ IDï¼ˆç”¨äºæœ¬åœ°è¿æ¥ï¼‰</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ç¤ºä¾‹ä»£ç ï¼ˆIPv6 åœ°å€è½¬æ¢ï¼‰ï¼š</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in6</span> addr6;</span><br><span class="line">    addr6.sin6_family = AF_INET6;</span><br><span class="line">    addr6.sin6_port = <span class="built_in">htons</span>(<span class="number">9090</span>);  <span class="comment">// ç«¯å£å·</span></span><br><span class="line">    <span class="built_in">inet_pton</span>(AF_INET6, <span class="string">"::1"</span>, &amp;addr6.sin6_addr);  <span class="comment">// å°† IPv6 åœ°å€è½¬æ¢ä¸ºäºŒè¿›åˆ¶</span></span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> ip_str[INET6_ADDRSTRLEN];</span><br><span class="line">    <span class="built_in">inet_ntop</span>(AF_INET6, &amp;addr6.sin6_addr, ip_str, <span class="built_in">sizeof</span>(ip_str));  <span class="comment">// è½¬æ¢å›å¯è¯»å­—ç¬¦ä¸²</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"IPv6: "</span> &lt;&lt; ip_str &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Port: "</span> &lt;&lt; <span class="built_in">ntohs</span>(addr6.sin6_port) &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>IPv6 ç›¸å…³å‡½æ•°</strong>ï¼š</p>
<ul>
<li><code>inet_pton(AF_INET6, "::1", &amp;addr6.sin6_addr)</code>ï¼šå°†
IPv6 åœ°å€å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ ¼å¼ã€‚</li>
<li><code>inet_ntop(AF_INET6, &amp;addr6.sin6_addr, ip_str, sizeof(ip_str))</code>ï¼šå°†
IPv6 äºŒè¿›åˆ¶åœ°å€è½¬æ¢å›å­—ç¬¦ä¸²ã€‚</li>
</ul></li>
</ol>
<h3 id="åˆ›å»ºå¥—æ¥å­—">åˆ›å»ºå¥—æ¥å­—</h3>
<p>socketç³»ç»Ÿè°ƒâ½¤æˆåŠŸæ—¶è¿”å›â¼€ä¸ªsocketâ½‚ä»¶æè¿°ç¬¦ï¼Œå¤±è´¥åˆ™è¿”å›-1</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span>ï¼œsys/socket.hï¼</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">socket</span><span class="params">(<span class="type">int</span> domain,<span class="type">int</span> type,<span class="type">int</span> protocol)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‚æ•°è§£æï¼š</strong></p>
<ul>
<li><code>domain</code>ï¼ˆåè®®æ—ï¼‰ï¼š<code>AF_INET</code>ï¼ˆIPv4ï¼‰ã€<code>AF_INET6</code>ï¼ˆIPv6ï¼‰ã€<code>AF_UNIX</code>ï¼ˆæœ¬åœ°é€šä¿¡ï¼‰</li>
<li><code>type</code>ï¼ˆå¥—æ¥å­—ç±»å‹ï¼‰ï¼š<code>SOCK_STREAM</code>ï¼ˆæµæœåŠ¡ï¼ŒTCPï¼‰ã€<code>SOCK_DGRAM</code>ï¼ˆæ•°æ®æŠ¥æœåŠ¡ï¼ŒUDPï¼‰</li>
<li><code>protocol</code>ï¼ˆåè®®ï¼‰ï¼š<code>0</code>ï¼ˆé»˜è®¤ï¼‰ï¼Œ<code>IPPROTO_TCP</code>ï¼ˆTCPï¼‰ï¼Œ<code>IPPROTO_UDP</code>ï¼ˆUDPï¼‰</li>
</ul>
<h3 id="ç»‘å®šå¥—æ¥å­—">ç»‘å®šå¥—æ¥å­—</h3>
<p><code>bind</code>å‡½æ•°<strong>å°†å¥—æ¥å­—ï¼ˆsocketï¼‰ä¸æœ¬åœ° IP
åœ°å€å’Œç«¯å£å·ç»‘å®š</strong>ï¼Œå³ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªå…³é”®å­—ï¼Œè¿™æ ·å®¢æˆ·ç«¯å¯ä»¥è¿æ¥åˆ°è¯¥åœ°å€ã€‚æˆåŠŸæ—¶è¿”å›0ï¼Œå¤±è´¥åˆ™è¿”å›-1</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">bind</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‚æ•°è§£æï¼š</strong></p>
<ul>
<li><code>sockfd</code>ï¼š<strong>è¦ç»‘å®šçš„ socket æ–‡ä»¶æè¿°ç¬¦</strong>ï¼ˆç”±
<code>socket()</code> åˆ›å»ºï¼‰</li>
<li><code>addr</code>ï¼š<strong>è¦ç»‘å®šçš„æœ¬åœ°åœ°å€ï¼ˆIP +
ç«¯å£ï¼‰</strong>ï¼Œéœ€è¦è½¬æ¢ä¸º <code>sockaddr*</code>
ç±»å‹ï¼ˆé»˜è®¤å¥—æ¥å­—åœ°å€ç±»å‹ï¼‰</li>
<li><code>addrlen</code>ï¼š<strong>åœ°å€ç»“æ„ä½“çš„å¤§å°</strong>ï¼ˆé€šå¸¸ç”¨
<code>sizeof(struct sockaddr_in)</code>ï¼‰</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="type">int</span> sockfd = <span class="built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="number">0</span>);  <span class="comment">// åˆ›å»º TCP å¥—æ¥å­—</span></span><br><span class="line">    <span class="keyword">if</span> (sockfd == <span class="number">-1</span>) {</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">"socket"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sockaddr_in</span> addr {};</span><br><span class="line">    addr.sin_family = AF_INET;  <span class="comment">// ä½¿ç”¨ IPv4</span></span><br><span class="line">    addr.sin_addr.s_addr = INADDR_ANY;  <span class="comment">// ç»‘å®šåˆ°æœ¬æœºæ‰€æœ‰ IP</span></span><br><span class="line">    addr.sin_port = <span class="built_in">htons</span>(<span class="number">8080</span>);  <span class="comment">// ç»‘å®šç«¯å£ 8080</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">// ç»‘å®š</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">bind</span>(sockfd, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="built_in">sizeof</span>(addr)) == <span class="number">-1</span>) {</span><br><span class="line">        <span class="built_in">perror</span>(<span class="string">"bind failed"</span>);</span><br><span class="line">        <span class="built_in">close</span>(sockfd);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Socket bound to port 8080"</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="built_in">close</span>(sockfd);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ç›‘å¬å¥—æ¥å­—">ç›‘å¬å¥—æ¥å­—</h3>
<p><code>listen</code>å‡½æ•°åˆ›å»ºâ¼€ä¸ªç›‘å¬é˜Ÿåˆ—ä»¥å­˜æ”¾å¾…å¤„ç†çš„å®¢æˆ·è¿æ¥ã€‚æˆåŠŸæ—¶è¿”å›0ï¼Œå¤±è´¥åˆ™è¿”å›-1ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">listen</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">int</span> backlog)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‚æ•°è§£æï¼š</strong></p>
<ul>
<li><code>sockfd</code>ï¼šsocket æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šå¸¸æ˜¯é€šè¿‡
<code>socket()</code> åˆ›å»ºå¹¶å·²ç»‘å®šåœ°å€å’Œç«¯å£çš„ socket</li>
<li><code>backlog</code>ï¼šè¿æ¥é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ã€‚
<ul>
<li>å½“å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å°è¯•è¿æ¥æœåŠ¡å™¨æ—¶ï¼Œæœªå¤„ç†çš„è¿æ¥è¯·æ±‚ä¼šè¢«æ”¾å…¥é˜Ÿåˆ—ä¸­ã€‚</li>
<li><code>backlog</code>
æŒ‡å®šäº†é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ã€‚å¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œæ–°çš„è¿æ¥è¯·æ±‚ä¼šè¢«æ‹’ç»ã€‚</li>
</ul></li>
</ul>
<blockquote>
<p>ç›‘å¬é˜Ÿåˆ—ä¸­<strong><code>ESTABLISHED</code> çŠ¶æ€</strong> çš„è¿æ¥è¡¨ç¤º
<strong>ä¸‰æ¬¡æ¡æ‰‹æˆåŠŸ</strong>ï¼Œè¿æ¥å·²å»ºç«‹ï¼Œå¯ä»¥é€šä¿¡ã€‚ä½†æ­¤æ—¶è¿æ¥è¿˜åœ¨
<strong>ç›‘å¬é˜Ÿåˆ—</strong> ä¸­ï¼ŒæœåŠ¡å™¨ç«¯è¿˜
<strong>ä¸èƒ½ç›´æ¥è¯»å†™æ•°æ®</strong>ï¼Œéœ€è¦é€šè¿‡ <code>accept()</code>
å–å‡ºè¿æ¥ã€‚</p>
</blockquote>
<h3 id="æ¥å—è¿æ¥">æ¥å—è¿æ¥</h3>
<p><code>accept</code>å‡½æ•°ä»<code>listen</code>ç›‘å¬é˜Ÿåˆ—ä¸­æ¥å—â¼€ä¸ªè¿æ¥ã€‚æˆåŠŸè¿”å›æ–°çš„<strong>å·²è¿æ¥å¥—æ¥å­—æè¿°ç¬¦</strong>ï¼Œç”¨äºä¸å®¢æˆ·ç«¯é€šä¿¡ï¼›å¤±è´¥è¿”å›<code>-1</code>ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">accept</span><span class="params">(<span class="type">int</span> sockfd, <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> *addrlen)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‚æ•°è§£æï¼š</strong></p>
<ul>
<li><code>sockfd</code>ï¼šsocketæ–‡ä»¶æè¿°ç¬¦ï¼ˆè¿™é‡Œæ˜¯è¢«ç›‘å¬çš„socketï¼‰</li>
<li><code>addr</code>ï¼šæŒ‡å‘å­˜å‚¨å®¢æˆ·ç«¯åœ°å€ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œé€šå¸¸ä¸º
<code>sockaddr_in</code> æˆ– <code>sockaddr_in6</code></li>
<li><code>addrlen</code>ï¼šæŒ‡å‘åœ°å€é•¿åº¦çš„æŒ‡é’ˆï¼Œè°ƒç”¨å‰åº”è®¾ç½®ä¸º
<code>addr</code> çš„é•¿åº¦ï¼Œè°ƒç”¨åä¼šè¢«ä¿®æ”¹ä¸ºå®é™…åœ°å€é•¿åº¦ã€‚</li>
</ul>
<h3 id="å‘èµ·è¿æ¥">å‘èµ·è¿æ¥</h3>
<p><code>connect</code>å‡½æ•°â½¤æ¥ä¸»åŠ¨ä¸æœåŠ¡å™¨å»ºâ½´è¿æ¥ã€‚æˆåŠŸè¿”å›<code>0</code>ï¼Œå¤±è´¥è¿”å›<code>-1</code>ã€‚â¼€æ—¦æˆåŠŸå»ºâ½´è¿æ¥ï¼Œsockfdå°±å”¯â¼€åœ°æ ‡è¯†äº†è¿™ä¸ªè¿æ¥ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥é€šè¿‡è¯»å†™<code>sockfd</code>æ¥ä¸æœåŠ¡å™¨é€šä¿¡ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">connect</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="type">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‚æ•°è§£æï¼š</strong></p>
<ul>
<li><code>sockfd</code>ï¼šæ–‡ä»¶æè¿°ç¬¦</li>
<li><code>addr</code>ï¼š<strong>æœåŠ¡å™¨åœ°å€</strong>ä¿¡æ¯ï¼ŒåŒ…æ‹¬ IP
å’Œç«¯å£ã€‚</li>
<li><code>addrlen</code>ï¼š<code>addr</code>çš„å¤§å°</li>
</ul>
<blockquote>
<p><strong><code>connect</code> æ˜¯å®¢æˆ·ç«¯ä¸»åŠ¨å»ºç«‹è¿æ¥</strong></p>
<p><strong><code>accept</code>æ˜¯æœåŠ¡å™¨è¢«åŠ¨æ¥å—è¿æ¥</strong></p>
</blockquote>
<h3 id="å…³é—­è¿æ¥">å…³é—­è¿æ¥</h3>
<h4 id="close">close</h4>
<p>å…³é—­<code>sockfd</code>å¯¹åº”çš„socketè¿æ¥ã€‚æˆåŠŸè¿”å›<code>0</code>ï¼Œå¤±è´¥è¿”å›<code>-1</code>ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">close</span><span class="params">(<span class="type">int</span> sockfd)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å¼•ç”¨è®¡æ•°æœºåˆ¶</strong>ï¼š</p>
<ul>
<li>å†…æ ¸ç»´æŠ¤<strong>æ–‡ä»¶æè¿°ç¬¦çš„å¼•ç”¨è®¡æ•°</strong>ã€‚</li>
<li>è°ƒç”¨ <code>close()</code> æ—¶ï¼Œå¼•ç”¨è®¡æ•° <strong>å‡ 1</strong>ã€‚</li>
<li>å½“å¼•ç”¨è®¡æ•°ä¸º 0ï¼Œæ‰çœŸæ­£å…³é—­è¿æ¥</li>
</ul>
<h4 id="shutdown">shutdown</h4>
<p>å¦‚æœâ½†è®ºå¦‚ä½•éƒ½è¦â½´å³ç»ˆâ½Œè¿æ¥ï¼ˆâ½½ä¸æ˜¯å°†socketçš„å¼•â½¤è®¡æ•°å‡1ï¼‰ï¼Œå¯ä»¥ä½¿â½¤çš„<code>shutdown</code>ç³»ç»Ÿè°ƒâ½¤ã€‚æˆåŠŸæ—¶è¿”å›<code>0</code>ï¼Œå¤±è´¥åˆ™è¿”å›<code>-1</code>ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shutdown</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">int</span> how)</span></span>;</span><br><span class="line"><span class="comment">/* how å‚æ•°è¡¨ç¤ºå…³é—­æ–¹å¼ï¼šSHUT_RDã€SHUT_WRã€SHUT_RDWR */</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>shutdown</code>èƒ½å¤Ÿåˆ†åˆ«å…³é—­socketä¸Šçš„è¯»æˆ–å†™ï¼Œæˆ–è€…éƒ½å…³é—­ã€‚â½½<code>close</code>åœ¨å…³é—­è¿æ¥æ—¶åªèƒ½å°†socketä¸Šçš„è¯»å’Œå†™åŒæ—¶å…³é—­ã€‚</p>
<h3 id="æ•°æ®è¯»å†™">æ•°æ®è¯»å†™</h3>
<p>å¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œ<code>read</code>å’Œ<code>write</code>åŒæ ·é€‚ç”¨äºsocket</p>
<h4 id="tcpæ•°æ®è¯»å†™">TCPæ•°æ®è¯»å†™</h4>
<ol type="1">
<li><p><code>send()</code></p>
<p><strong>å‘é€æ•°æ®</strong>åˆ°å·²è¿æ¥çš„ <strong>TCP
å¥—æ¥å­—</strong>ä¸­ã€‚æˆåŠŸåˆ™è¿”å›<strong>å®é™…å‘é€çš„å­—èŠ‚æ•°</strong>ï¼Œå¤±è´¥åˆ™è¿”å›
<code>-1</code> ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">send</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> len, <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>sockfd</code>ï¼šå·²è¿æ¥çš„å¥—æ¥å­—æè¿°ç¬¦</li>
<li><code>buf</code>ï¼šæŒ‡å‘<strong>å¾…å‘é€æ•°æ®</strong>çš„ç¼“å†²åŒº</li>
<li><code>len</code>ï¼šå¸¦å‘é€æ•°æ®çš„é•¿åº¦</li>
<li><code>flags</code>ï¼šæ§åˆ¶å‘é€è¡Œä¸ºï¼ˆä¸€èˆ¬ä¸º0ï¼‰
<ul>
<li><code>0</code>ï¼šæ ‡å‡†é˜»å¡å‘é€</li>
<li><code>MSG_DONTWAIT</code>ï¼š<strong>éé˜»å¡å‘é€</strong>ï¼Œè‹¥ç¼“å†²åŒºæ»¡ï¼Œåˆ™ç«‹å³è¿”å›</li>
<li><code>MSG_NOSIGNAL</code>ï¼š<strong>ä¸è§¦å‘ SIGPIPE
ä¿¡å·</strong>ï¼Œåœ¨å¯¹ç«¯å…³é—­æ—¶è¿”å›é”™è¯¯</li>
</ul></li>
</ul></li>
<li><p><code>recv()</code></p>
<p><strong>ä» TCP
å¥—æ¥å­—æ¥æ”¶æ•°æ®</strong>å¹¶å­˜å…¥ç¼“å†²åŒºã€‚æˆåŠŸåˆ™è¿”å›<strong>æ¥æ”¶åˆ°çš„å­—èŠ‚æ•°</strong>ï¼ˆ<code>0</code>ï¼šè¡¨ç¤º
<strong>å¯¹æ–¹å…³é—­è¿æ¥</strong>ï¼Œå³å‘é€äº† <code>FIN</code>
åŒ…ï¼‰ï¼Œå¤±è´¥åˆ™è¿”å›<code>-1</code>ã€‚å¯èƒ½è¦å¤šæ¬¡è°ƒâ½¤<code>recv</code></p>
<p><strong>å¤±è´¥</strong>ï¼šè¿”å› <code>-1</code></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">recv</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">void</span> *buf, <span class="type">size_t</span> len, <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>sockfd</code>ï¼šå·²è¿æ¥çš„å¥—æ¥å­—æè¿°ç¬¦</li>
<li><code>buf</code>ï¼šæŒ‡å‘<strong>å­˜æ”¾æ¥æ”¶æ•°æ®</strong>çš„ç¼“å†²åŒº</li>
<li><code>len</code>ï¼šç¼“å†²åŒºå¤§å°</li>
<li><code>flags</code>ï¼šæ§åˆ¶å‘é€è¡Œä¸ºï¼ˆä¸€èˆ¬ä¸º0ï¼‰
<ul>
<li><code>0</code>ï¼šæ ‡å‡†é˜»å¡æ¥æ”¶</li>
<li><code>MSG_DONTWAIT</code>ï¼š<strong>éé˜»å¡æ¥æ”¶</strong>ï¼Œè‹¥æ— æ•°æ®åˆ™ç«‹å³è¿”å›</li>
<li><code>MSG_PEEK</code>ï¼š<strong>çª¥è§†æ¨¡å¼</strong>ï¼Œè¯»å–æ•°æ®ä½†ä¸åˆ é™¤ç¼“å†²åŒºä¸­çš„å†…å®¹</li>
</ul></li>
</ul></li>
</ol>
<h4 id="udpæ•°æ®æŠ¥è¯»å†™">UDPæ•°æ®æŠ¥è¯»å†™</h4>
<ol type="1">
<li><p><code>sendto()</code></p>
<p>å‘é€ UDP
æ•°æ®æŠ¥åˆ°æŒ‡å®šçš„ç›®æ ‡åœ°å€ã€‚æˆåŠŸåˆ™è¿”å›<strong>å®é™…å‘é€çš„å­—èŠ‚æ•°</strong>ï¼Œå¤±è´¥åˆ™è¿”å›
<code>-1</code>ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">sendto</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> len, <span class="type">int</span> flags, </span></span></span><br><span class="line"><span class="params"><span class="function">               <span class="type">const</span> <span class="keyword">struct</span> sockaddr *dest_addr, <span class="type">socklen_t</span> addrlen)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>sockfd</code>ï¼š å¥—æ¥å­—æè¿°ç¬¦</li>
<li><code>buf</code>ï¼šæŒ‡å‘ <strong>å¾…å‘é€æ•°æ®</strong> çš„ç¼“å†²åŒº</li>
<li><code>len</code>ï¼šå¾…å‘é€æ•°æ®é•¿åº¦</li>
<li><code>flags</code>ï¼šæ§åˆ¶å‘é€è¡Œä¸ºï¼ˆä¸€èˆ¬ä¸º0ï¼‰</li>
<li><code>dest_addr</code>ï¼ˆç»“æ„ä½“ï¼‰ï¼šç›®æ ‡åœ°å€ï¼Œé€šå¸¸ä¸º
<code>sockaddr_in</code> æˆ– <code>sockaddr_in6</code></li>
<li><code>addrlen</code>ï¼šç›®æ ‡åœ°å€ç»“æ„ä½“çš„å¤§å°</li>
</ul></li>
<li><p><code>recvfrom()</code></p>
<p>æ¥æ”¶ UDP
æ•°æ®æŠ¥å¹¶ä¿å­˜åˆ°ç¼“å†²åŒºä¸­ã€‚æˆåŠŸåˆ™è¿”å›<strong>å®é™…æ¥æ”¶çš„å­—èŠ‚æ•°</strong>ï¼Œå¤±è´¥åˆ™è¿”å›
<code>-1</code>ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">recvfrom</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">void</span> *buf, <span class="type">size_t</span> len, <span class="type">int</span> flags, </span></span></span><br><span class="line"><span class="params"><span class="function">                 <span class="keyword">struct</span> sockaddr *src_addr, <span class="type">socklen_t</span> *addrlen)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>sockfd</code>ï¼šå¥—æ¥å­—æè¿°ç¬¦</li>
<li><code>buf</code>ï¼šæŒ‡å‘<strong>å­˜æ”¾æ¥æ”¶æ•°æ®</strong>çš„ç¼“å†²åŒº</li>
<li><code>len</code>ï¼šç¼“å†²åŒºå¤§å°</li>
<li><code>flags</code>ï¼šæ§åˆ¶å‘é€è¡Œä¸ºï¼ˆä¸€èˆ¬ä¸º0ï¼‰</li>
<li><code>src_addr</code>ï¼šå­˜æ”¾å‘é€åœ°å€çš„ç»“æ„ä½“æŒ‡é’ˆ</li>
<li><code>addrlen</code>ï¼šå‘é€æ–¹åœ°å€ç»“æ„ä½“çš„å¤§å°</li>
</ul></li>
</ol>
<h4 id="é€šç”¨æ•°æ®è¯»å†™">é€šç”¨æ•°æ®è¯»å†™</h4>
<p>ä¸ä»…èƒ½â½¤äºTCPæµæ•°æ®ï¼Œä¹Ÿèƒ½â½¤äºUDPæ•°æ®æŠ¥</p>
<ol type="1">
<li><p><code>sendmsg</code></p>
<p>æˆåŠŸåˆ™è¿”å›å‘é€çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">sendmsg</span><span class="params">(<span class="type">int</span> sockfd, <span class="type">const</span> <span class="keyword">struct</span> msghdr *msg, <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>sockfd</code>ï¼šå¥—æ¥å­—æè¿°ç¬¦ã€‚</li>
<li><code>msg</code>ï¼šæŒ‡å‘ <strong><code>msghdr</code>
ç»“æ„ä½“</strong>ï¼ŒåŒ…å«è¦å‘é€çš„æ•°æ®ã€ç›®æ ‡åœ°å€ã€æ§åˆ¶ä¿¡æ¯ã€‚</li>
<li><code>flags</code>ï¼šå‘é€æ ‡å¿—ï¼Œå¦‚
<code>MSG_DONTWAIT</code>ã€<code>MSG_EOR</code>ã€‚</li>
</ul></li>
<li><p><code>recvmsg</code></p>
<p>æˆåŠŸåˆ™è¿”å›æ¥æ”¶çš„å­—èŠ‚æ•°ï¼Œå¤±è´¥è¿”å› <code>-1</code></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">recvmsg</span><span class="params">(<span class="type">int</span> sockfd, <span class="keyword">struct</span> msghdr *msg, <span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<blockquote>
<p><code>msghdr</code>ç»“æ„ä½“è¯¦è§£</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">msghdr</span> {</span><br><span class="line">    <span class="type">void</span>         *msg_name;       <span class="comment">// åœ°å€ä¿¡æ¯ (UDPï¼šç›®æ ‡åœ°å€ / æºåœ°å€ï¼›å¯¹äºâ¾¯å‘è¿æ¥çš„TCPåè®®ï¼Œè¯¥æˆå‘˜æ²¡æœ‰æ„ä¹‰)</span></span><br><span class="line">    <span class="type">socklen_t</span>     msg_namelen;    <span class="comment">// åœ°å€é•¿åº¦</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">iovec</span> *msg_iov;        <span class="comment">// æ•°æ®ç¼“å†²åŒºæ•°ç»„</span></span><br><span class="line">    <span class="type">size_t</span>        msg_iovlen;     <span class="comment">// æ•°æ®ç¼“å†²åŒºä¸ªæ•°</span></span><br><span class="line">    <span class="type">void</span>         *msg_control;    <span class="comment">// æ§åˆ¶ä¿¡æ¯ç¼“å†²åŒº</span></span><br><span class="line">    <span class="type">size_t</span>        msg_controllen; <span class="comment">// æ§åˆ¶ä¿¡æ¯é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span>           msg_flags;      <span class="comment">// æ¶ˆæ¯æ ‡å¿—</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<h4 id="æœåŠ¡ç«¯-tcp">æœåŠ¡ç«¯ (TCP)</h4>
<ol type="1">
<li><strong><code>socket()</code></strong>ï¼šåˆ›å»ºå¥—æ¥å­—</li>
<li><strong><code>bind()</code></strong>ï¼šç»‘å®š IP åœ°å€å’Œç«¯å£å·</li>
<li><strong><code>listen()</code></strong>ï¼šç›‘å¬å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚</li>
<li><strong><code>accept()</code></strong>ï¼šæ¥å—å®¢æˆ·ç«¯è¿æ¥</li>
<li><strong><code>send()</code> /
<code>recv()</code></strong>ï¼šè¯»å†™æ•°æ®</li>
<li><strong><code>close()</code></strong>ï¼šå…³é—­å¥—æ¥å­—</li>
</ol>
<h4 id="å®¢æˆ·ç«¯-tcp">å®¢æˆ·ç«¯ (TCP)</h4>
<ol type="1">
<li><strong><code>socket()</code></strong>ï¼šåˆ›å»ºå¥—æ¥å­—</li>
<li><strong><code>connect()</code></strong>ï¼šè¿æ¥æœåŠ¡å™¨</li>
<li><strong><code>send()</code> /
<code>recv()</code></strong>ï¼šè¯»å†™æ•°æ®</li>
<li><strong><code>close()</code></strong>ï¼šå…³é—­å¥—æ¥å­—</li>
</ol>
<blockquote>
<p><strong>å®¢æˆ·ç«¯</strong> ä¸è°ƒç”¨ <code>bind()</code> æ˜¯ä¸ºäº†
<strong>ç®€åŒ–ç¼–ç¨‹</strong> å’Œ
<strong>æ–¹ä¾¿æ“ä½œç³»ç»Ÿè‡ªåŠ¨åˆ†é…ç«¯å£</strong>ã€‚</p>
<p><strong>æœåŠ¡ç«¯</strong> å¿…é¡»è°ƒç”¨ <code>bind()</code> æ¥
<strong>æŒ‡å®šç›‘å¬çš„ IP åœ°å€å’Œç«¯å£å·</strong>ï¼Œä»¥ä¾¿
<strong>å®¢æˆ·ç«¯èƒ½å¤Ÿè¿æ¥</strong>ã€‚</p>
</blockquote>
<h2 id="é«˜çº§ioå‡½æ•°">é«˜çº§I/Oå‡½æ•°</h2>
<p><code>pipe</code>ã€<code>dup</code>ã€<code>readv</code>ã€<code>sendfile</code>ã€<code>mmap</code>ã€<code>tee</code>ã€<code>fcntl</code></p>
<p><code>splice</code>ï¼šç”¨äºåœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´ç§»åŠ¨æ•°æ®ï¼Œè€Œæ— éœ€å°†æ•°æ®ä»å†…æ ¸ç©ºé—´å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ï¼Œ<strong>ç›´æ¥åœ¨å†…æ ¸ç©ºé—´</strong>ä¸­å®Œæˆæ•°æ®çš„ä¼ è¾“ã€‚ã€‚å®ƒé€šå¸¸ç”¨äºé«˜æ•ˆåœ°å°†æ•°æ®ä»ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆä¾‹å¦‚ç®¡é“ã€socket
æˆ–æ–‡ä»¶ï¼‰ä¼ è¾“åˆ°å¦ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚æ ¸å¿ƒåŸç†æ˜¯å®ƒåˆ©ç”¨äº† Linux
å†…æ ¸çš„<strong>é›¶æ‹·è´ï¼ˆZero-Copyï¼‰æŠ€æœ¯</strong></p>
<h2 id="linuxæœåŠ¡å™¨ç¨‹åºè§„èŒƒ">LinuxæœåŠ¡å™¨ç¨‹åºè§„èŒƒ</h2>
<p><strong>AF_UNIX Socket ç±»å‹</strong></p>
<ul>
<li><strong>AF_UNIX</strong> æ˜¯ä¸€ç§æœ¬åœ°è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰çš„ Socket
ç±»å‹ï¼Œä¹Ÿç§°ä¸º <strong>Unix Domain Socket (UDS)</strong>ã€‚</li>
<li>å®ƒç”¨äº <strong>åŒä¸€å°æœºå™¨</strong>
ä¸Šä¸åŒè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œä¸æ¶‰åŠç½‘ç»œä¼ è¾“ã€‚</li>
<li>é€šä¿¡æ•°æ®ä¸ä¼šç»è¿‡ç½‘ç»œåè®®æ ˆï¼Œå› æ­¤
<strong>æ•ˆç‡é«˜ã€å»¶è¿Ÿä½ã€å¼€é”€å°</strong>ã€‚</li>
</ul>
<h3 id="æ—¥å¿—">æ—¥å¿—</h3>
<ul>
<li><p><code>rsyslog</code> æ˜¯ Linux
ç³»ç»Ÿä¸­åŠŸèƒ½å¼ºå¤§çš„æ—¥å¿—ç®¡ç†å·¥å…·ï¼Œå…·æœ‰é«˜æ€§èƒ½ã€æ¨¡å—åŒ–ã€æ”¯æŒå¤šç§åè®®å’Œæ ¼å¼åŒ–è¾“å‡ºçš„ç‰¹ç‚¹ã€‚</p></li>
<li><p><strong>rsyslogd å®ˆæŠ¤è¿›ç¨‹</strong> åœ¨æ¥æ”¶åˆ°
<strong>ç”¨æˆ·è¿›ç¨‹</strong> æˆ– <strong>å†…æ ¸</strong>
è¾“å…¥çš„æ—¥å¿—åï¼Œä¼šæŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­çš„è§„åˆ™ï¼Œå°†å®ƒä»¬è¾“å‡ºåˆ°ç‰¹å®šçš„
<strong>æ—¥å¿—æ–‡ä»¶</strong> ä¸­ã€‚</p></li>
</ul>
<p>ä¸‹é¢æ˜¯<strong>æ—¥å¿—å¤„ç†æµç¨‹</strong></p>
<ol type="1">
<li><p><strong>æ—¥å¿—æ”¶é›†</strong>ï¼š</p>
<ul>
<li><p><strong>ç”¨æˆ·è¿›ç¨‹æ—¥å¿—</strong>ï¼šé€šè¿‡è°ƒç”¨ <code>syslog()</code>
å‡½æ•°ï¼Œå°†æ—¥å¿—å†™å…¥ <code>/dev/log</code>ï¼ˆAF_UNIX Socketï¼‰ã€‚</p>
<blockquote>
<ul>
<li><p><strong><code>syslog()</code></strong> æ˜¯ C
è¯­è¨€æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äº
<strong>å‘ç³»ç»Ÿæ—¥å¿—å‘é€æ¶ˆæ¯</strong>ã€‚</p></li>
<li><p>æ—¥å¿—é€šè¿‡ <strong>AF_UNIX Socket</strong> å‘é€åˆ°
<code>/dev/log</code> æ–‡ä»¶ï¼Œç”± <code>rsyslogd</code>
æˆ–å…¶ä»–ç³»ç»Ÿæ—¥å¿—å®ˆæŠ¤è¿›ç¨‹æ”¶é›†ã€å¤„ç†å¹¶å†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚</p></li>
<li><p>å…¸å‹ç”¨é€”ï¼šè®°å½•ç¨‹åºè¿è¡ŒçŠ¶æ€ã€é”™è¯¯ä¿¡æ¯ã€å®‰å…¨äº‹ä»¶ç­‰ï¼Œä¾¿äºè°ƒè¯•å’Œç»´æŠ¤</p></li>
</ul>
</blockquote></li>
<li><p><strong>å†…æ ¸æ—¥å¿—</strong>ï¼šé€šè¿‡ <code>klog</code>
æ¨¡å—ä»å†…æ ¸ä¸­æ”¶é›†æ—¥å¿—ï¼Œä¾‹å¦‚å¯åŠ¨ã€ç¡¬ä»¶ã€ä¸­æ–­ç­‰ä¿¡æ¯ã€‚</p></li>
</ul></li>
<li><p><strong>rsyslogd è·å–æ—¥å¿—</strong>ï¼š</p>
<ul>
<li><code>rsyslogd</code> å®ˆæŠ¤è¿›ç¨‹ç›‘å¬ <code>/dev/log</code> å’Œ
<code>/proc/kmsg</code>ï¼ˆå†…æ ¸æ—¥å¿—ï¼‰ï¼Œè·å–æ—¥å¿—æ•°æ®ã€‚</li>
</ul></li>
<li><p><strong>æ—¥å¿—è¿‡æ»¤ä¸åˆ†ç±»</strong>ï¼š</p>
<ul>
<li>æ ¹æ®é…ç½®æ–‡ä»¶ï¼ˆå¦‚ <code>/etc/rsyslog.conf</code> å’Œ
<code>/etc/rsyslog.d/*.conf</code>ï¼‰ä¸­çš„è§„åˆ™è¿›è¡Œè¿‡æ»¤å’Œåˆ†ç±»ã€‚</li>
<li>è§„åˆ™ç”± Facilityï¼ˆæ—¥å¿—æ¥æºï¼‰ å’Œ Levelï¼ˆæ—¥å¿—çº§åˆ«ï¼‰ ç»„æˆ</li>
</ul></li>
<li><p><strong>æ—¥å¿—è¾“å‡ºä¸å­˜å‚¨</strong>ï¼š</p>
<ul>
<li>æ—¥å¿—è¢«å†™å…¥åˆ°æŒ‡å®šçš„æ—¥å¿—æ–‡ä»¶ï¼Œå¦‚ï¼š
<ul>
<li><code>/var/log/messages</code>ï¼šç³»ç»Ÿé€šç”¨æ—¥å¿—</li>
<li><code>/var/log/secure</code>ï¼šè®¤è¯å’Œå®‰å…¨ç›¸å…³æ—¥å¿—</li>
<li><code>/var/log/maillog</code>ï¼šé‚®ä»¶æ—¥å¿—</li>
<li><code>/var/log/cron</code>ï¼šå®šæ—¶ä»»åŠ¡æ—¥å¿—</li>
<li><code>/var/log/kern.log</code>ï¼šå†…æ ¸æ—¥å¿—</li>
</ul></li>
<li>æˆ–è€…è½¬å‘è‡³ <strong>è¿œç¨‹æ—¥å¿—æœåŠ¡å™¨</strong> æˆ–
<strong>æ•°æ®åº“</strong> è¿›è¡Œé›†ä¸­å­˜å‚¨å’Œåˆ†æã€‚</li>
</ul></li>
</ol>
<h3 id="ç”¨æˆ·ä¿¡æ¯">ç”¨æˆ·ä¿¡æ¯</h3>
<p>EGID/EUID
å­˜åœ¨çš„â½¬çš„æ˜¯â½…ä¾¿èµ„æºè®¿é—®ï¼Œç»™è¿â¾â½¬æ ‡ç¨‹åºçš„(ç»„)â½¤æˆ·æä¾›æœ‰æ•ˆ(ç»„)ç”¨æˆ·çš„æƒé™ã€‚</p>
<blockquote>
<p>ç¤ºä¾‹ï¼š</p>
<ul>
<li><p><strong><code>su</code> ç¨‹åº</strong> åœ¨
<strong>æ™®é€šç”¨æˆ·å¯åŠ¨æ—¶</strong>ï¼Œ<strong>EUID ä¸´æ—¶å˜ä¸º
<code>root</code></strong>ï¼Œä»è€Œæ‹¥æœ‰ <code>root</code> æƒé™ã€‚</p></li>
<li><p>ç”±äº SUID ä½ï¼ˆå³set-user-id æ ‡å¿—ï¼‰è¢«è®¾ç½®ï¼Œåˆ™ <strong>EUID å˜ä¸º
root</strong>ï¼Œè¿›ç¨‹å¯ä»¥ <strong>è®¿é—®å’Œä¿®æ”¹ <code>/etc/passwd</code>
æ–‡ä»¶</strong>ï¼Œå¹¶æ‰§è¡Œåˆ‡æ¢ç”¨æˆ·çš„æ“ä½œã€‚</p></li>
</ul>
</blockquote>
<ol type="1">
<li><p>è·å–ç”¨æˆ·ä¿¡æ¯</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">uid_t</span> <span class="title">getuid</span><span class="params">(<span class="type">void</span>)</span></span>;   <span class="comment">// è·å– çœŸå®ç”¨æˆ· ID (UID)</span></span><br><span class="line"><span class="function"><span class="type">uid_t</span> <span class="title">geteuid</span><span class="params">(<span class="type">void</span>)</span></span>;  <span class="comment">// è·å– æœ‰æ•ˆç”¨æˆ· ID (EUID)</span></span><br><span class="line"><span class="function"><span class="type">gid_t</span> <span class="title">getgid</span><span class="params">(<span class="type">void</span>)</span></span>;   <span class="comment">// è·å– çœŸå®ç»„ ID (GID)</span></span><br><span class="line"><span class="function"><span class="type">gid_t</span> <span class="title">getegid</span><span class="params">(<span class="type">void</span>)</span></span>;  <span class="comment">// è·å– æœ‰æ•ˆç»„ ID (EGID)</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>è®¾ç½®ç”¨æˆ·ä¿¡æ¯</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">setuid</span><span class="params">(<span class="type">uid_t</span> uid)</span></span>;       <span class="comment">// è®¾ç½® çœŸå®ç”¨æˆ· ID å’Œ æœ‰æ•ˆç”¨æˆ· ID</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">seteuid</span><span class="params">(<span class="type">uid_t</span> euid)</span></span>;     <span class="comment">// è®¾ç½® æœ‰æ•ˆç”¨æˆ· ID</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">setgid</span><span class="params">(<span class="type">gid_t</span> gid)</span></span>;       <span class="comment">// è®¾ç½® çœŸå®ç»„ ID å’Œ æœ‰æ•ˆç»„ ID</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">setegid</span><span class="params">(<span class="type">gid_t</span> egid)</span></span>;     <span class="comment">// è®¾ç½® æœ‰æ•ˆç»„ ID</span></span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h3 id="è¿›ç¨‹é—´å…³ç³»">è¿›ç¨‹é—´å…³ç³»</h3>
<h4 id="è¿›ç¨‹ç»„">è¿›ç¨‹ç»„</h4>
<ul>
<li>æ¯ä¸ªè¿›ç¨‹ç»„éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ <strong>è¿›ç¨‹ç»„ ID
(PGID)</strong>ï¼Œç”¨äºæ ‡è¯†è¯¥ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹ã€‚</li>
<li><strong>PGIDï¼ˆProcess Group
IDï¼‰</strong>ï¼šè¿›ç¨‹ç»„çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç­‰äºè¯¥ç»„<strong>é¦–é¢†è¿›ç¨‹ï¼ˆLeader
Processï¼‰</strong> çš„ PIDï¼ˆè¿›ç¨‹ IDï¼‰ã€‚</li>
<li><strong>é¦–é¢†è¿›ç¨‹</strong>ï¼šæœ€å…ˆåˆ›å»ºè¿›ç¨‹ç»„çš„è¿›ç¨‹ï¼ŒPGID ç­‰äºå®ƒçš„
PIDã€‚å¦‚æœé¦–é¢†è¿›ç¨‹é€€å‡ºï¼Œè¿›ç¨‹ç»„ä¸ä¼šæ¶ˆå¤±ï¼Œä½†å…¶ä»–è¿›ç¨‹çš„ PGID
ä¸å˜ã€‚è¿›ç¨‹ç»„å°†â¼€ç›´å­˜åœ¨ï¼Œç›´åˆ°å…¶ä¸­<strong>æ‰€æœ‰è¿›ç¨‹</strong>éƒ½é€€å‡ºï¼Œæˆ–è€…åŠ â¼Šåˆ°å…¶ä»–è¿›ç¨‹ç»„ã€‚</li>
</ul>
<h4 id="ä¼šè¯">ä¼šè¯</h4>
<ul>
<li><p>ä¸€ç»„ç›¸å…³çš„è¿›ç¨‹ç»„ç»„æˆä¸€ä¸ªä¼šè¯ï¼Œæ¯ä¸ªä¼šè¯æœ‰ä¸€ä¸ªå”¯ä¸€çš„
<strong>SIDï¼ˆSession IDï¼‰</strong>ã€‚</p></li>
<li><p><strong>Session ID
(SID)</strong>ï¼šä¼šè¯çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç­‰äºä¼šè¯é¦–é¢†è¿›ç¨‹ï¼ˆSession Leaderï¼‰çš„
PIDã€‚</p></li>
<li><p><strong>ä¼šè¯é¦–é¢†è¿›ç¨‹</strong>ï¼šåˆ›å»ºä¼šè¯çš„è¿›ç¨‹ï¼ŒSID ç­‰äºå®ƒçš„
PIDã€‚è¿™ä¸ªè¿›ç¨‹å¯ä»¥æˆä¸º<strong>å®ˆæŠ¤è¿›ç¨‹</strong>ã€‚</p>
<blockquote>
<p><strong>è°ƒç”¨è¿›ç¨‹ä¸èƒ½æ˜¯å½“å‰è¿›ç¨‹ç»„çš„ç»„é•¿</strong>ï¼Œå¦åˆ™ä¼šè¿”å›é”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li>å¦‚æœç»„é•¿è¿›ç¨‹è°ƒç”¨ <code>setsid()</code>ï¼Œé‚£ä¹ˆå®ƒçš„ <strong>PGID
(Process Group ID)</strong> å’Œ <strong>PID (Process ID)</strong>
ç›¸åŒï¼Œè€Œ <code>setsid()</code>
è¦æ±‚è°ƒç”¨è¿›ç¨‹æˆä¸º<strong>æ–°è¿›ç¨‹ç»„çš„ç»„é•¿</strong>ï¼Œå³ <strong>PGID =
PID</strong>ã€‚å¦‚æœå®ƒæœ¬èº«å·²ç»æ˜¯ç»„é•¿ï¼Œå°±æ— æ³•æ”¹å˜ PGIDï¼Œå› æ­¤è¢«ç¦æ­¢ã€‚</li>
</ul>
</blockquote></li>
</ul>
<h4 id="pså‘½ä»¤"><code>ps</code>å‘½ä»¤</h4>
<p>ç”¨äº<strong>æŸ¥çœ‹ç³»ç»Ÿä¸­æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</strong>ã€‚å®ƒå¯ä»¥æ˜¾ç¤ºè¿›ç¨‹çš„
PIDã€PPIDã€PGIDã€SIDã€TTYã€çŠ¶æ€ã€å†…å­˜å ç”¨ç­‰è¯¦ç»†ä¿¡æ¯ã€‚</p>
<ol type="1">
<li><p>æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„å±‚çº§å…³ç³»</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef --forest</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>æŸ¥çœ‹ä¼šè¯ã€è¿›ç¨‹ç»„å’Œ PID çš„å…³ç³»</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -eo pid,ppid,pgid,sid,tty,stat,comm</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>æŸ¥çœ‹å½“å‰ Shell ä¼šè¯ä¸­çš„æ‰€æœ‰è¿›ç¨‹</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -o pid,ppid,pgid,sid,tty,stat,comm</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>æŸ¥çœ‹å‰åå°ä½œä¸šåŠè¿›ç¨‹</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -o pid,tty,stat,comm</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>æŸ¥çœ‹æŸä¸ªç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -u username</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h3 id="ç³»ç»Ÿèµ„æºé™åˆ¶">ç³»ç»Ÿèµ„æºé™åˆ¶</h3>
<ul>
<li><strong><code>getrlimit(int resource, struct rlimit \*rlim)</code></strong>ï¼šè·å–æŒ‡å®šèµ„æºçš„<strong>è½¯é™åˆ¶</strong>å’Œ<strong>ç¡¬é™åˆ¶</strong>ã€‚</li>
<li><strong><code>setrlimit(int resource, const struct rlimit \*rlim)</code></strong>ï¼šè®¾ç½®æŒ‡å®šèµ„æºçš„<strong>è½¯é™åˆ¶</strong>å’Œ<strong>ç¡¬é™åˆ¶</strong>ã€‚</li>
</ul>
<h3 id="æ”¹å˜ç›®å½•">æ”¹å˜ç›®å½•</h3>
<ol type="1">
<li><p>è·å–<strong>å½“å‰å·¥ä½œç›®å½•</strong>çš„<strong>ç»å¯¹è·¯å¾„</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">char</span> *<span class="title">getcwd</span><span class="params">(<span class="type">char</span> *buf, <span class="type">size_t</span> size)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>buf</code>ï¼šç”¨äºå­˜å‚¨è·¯å¾„çš„ç¼“å†²åŒºã€‚</li>
<li><code>size</code>ï¼šç¼“å†²åŒºå¤§å°ã€‚</li>
<li>è¿”å›å€¼ï¼šæˆåŠŸè¿”å› <code>buf</code>ï¼›å¤±è´¥è¿”å›
<code>NULL</code>ï¼Œå¹¶è®¾ç½® <code>errno</code></li>
</ul></li>
<li><p>åˆ‡æ¢ç›®å½•</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">chdir</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *path)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>path</code>ï¼šç›®æ ‡ç›®å½•çš„è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ï¼‰ã€‚</li>
<li>è¿”å›å€¼ï¼šæˆåŠŸè¿”å› <code>0</code>ï¼›å¤±è´¥è¿”å› <code>-1</code>ï¼Œå¹¶è®¾ç½®
<code>errno</code></li>
</ul></li>
</ol>
<h3 id="æœåŠ¡å™¨ç¨‹åºåå°åŒ–">æœåŠ¡å™¨ç¨‹åºåå°åŒ–</h3>
<ol type="1">
<li><strong>åˆ›å»ºå­è¿›ç¨‹</strong> å¹¶é€€å‡ºçˆ¶è¿›ç¨‹ï¼Œé˜²æ­¢ç»§ç»­å ç”¨
<strong>ç»ˆç«¯</strong>ã€‚</li>
<li><strong>è°ƒç”¨ <code>setsid()</code></strong>ï¼š
<ul>
<li>åˆ›å»ºæ–°ä¼šè¯ (<code>session</code>)ï¼Œå¹¶æˆä¸ºä¼šè¯é¦–è¿›ç¨‹ã€‚</li>
<li>æˆä¸ºæ–°è¿›ç¨‹ç»„çš„<strong>ç»„é•¿</strong>ã€‚</li>
<li><strong>è„±ç¦»</strong> æ§åˆ¶ç»ˆç«¯ã€‚</li>
</ul></li>
<li><strong>é‡è®¾æ–‡ä»¶æƒé™æ©ç </strong>ï¼š
<ul>
<li>ä½¿ç”¨ <code>umask(0)</code> ç¡®ä¿å­è¿›ç¨‹å¯ä»¥åˆ›å»ºä»»ä½•æƒé™çš„æ–‡ä»¶ã€‚</li>
</ul></li>
<li><strong>æ›´æ”¹å·¥ä½œç›®å½•</strong>ï¼š
<ul>
<li>é€šå¸¸åˆ‡æ¢åˆ°æ ¹ç›®å½•ï¼š<code>chdir("/")</code>ï¼Œé˜²æ­¢
<strong>å ç”¨æ–‡ä»¶ç³»ç»Ÿ</strong>ã€‚</li>
</ul></li>
<li><strong>å…³é—­æ–‡ä»¶æè¿°ç¬¦</strong>ï¼š
<ul>
<li>å…³é—­ <strong>stdin, stdout, stderr</strong>
(<code>0, 1, 2</code>)ï¼Œé˜²æ­¢<strong>å ç”¨ç»ˆç«¯èµ„æº</strong>ã€‚</li>
</ul></li>
<li><strong>é‡å®šå‘æ–‡ä»¶æè¿°ç¬¦</strong>ï¼š
<ul>
<li>é‡å®šå‘ <code>stdin, stdout, stderr</code> åˆ°
<strong><code>/dev/null</code></strong> æˆ–
<strong>æ—¥å¿—æ–‡ä»¶</strong>ã€‚</li>
</ul></li>
</ol>
<h2 id="ioæ¨¡å‹">I/Oæ¨¡å‹</h2>
<p>å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯<strong>I/Oå¤ç”¨</strong></p>
<h3 id="é˜»å¡io">é˜»å¡I/O</h3>
<p>è¿›ç¨‹å‘èµ· I/O
è¯·æ±‚åï¼Œçº¿ç¨‹ä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å¥½å¹¶è¢«å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ï¼ŒI/O
æ“ä½œæ‰å®Œæˆã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol type="1">
<li>è¿›ç¨‹è°ƒç”¨ <code>read()</code>ï¼Œå¦‚æœæ•°æ®æœªå‡†å¤‡å¥½ï¼Œè¿›ç¨‹è¿›å…¥
<strong>é˜»å¡çŠ¶æ€</strong>ã€‚</li>
<li>å†…æ ¸ç­‰å¾…æ•°æ®å‡†å¤‡å¥½ï¼Œå¹¶ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´ã€‚</li>
<li><code>read()</code> è¿”å›ï¼Œè¿›ç¨‹ç»§ç»­æ‰§è¡Œã€‚</li>
</ol>
<h3 id="éé˜»å¡io">éé˜»å¡I/O</h3>
<p>è¿›ç¨‹å‘èµ·I/Oè¯·æ±‚åï¼Œä¸ç®¡æ•°æ®æ˜¯å¦å‡†å¤‡å¥½éƒ½ä¼šç›´æ¥è¿”å›ã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol type="1">
<li>è¿›ç¨‹è°ƒç”¨ <code>read()</code>ï¼š
<ul>
<li><strong>å¦‚æœæ•°æ®å·²å‡†å¤‡å¥½</strong>ï¼Œ<code>read()</code>
ç«‹å³è¿”å›æ•°æ®ã€‚</li>
<li><strong>å¦‚æœæ•°æ®æœªå‡†å¤‡å¥½</strong>ï¼Œ<code>read()</code> ç«‹å³è¿”å›
<code>-1</code>ï¼Œå¹¶è®¾ç½® <code>errno = EAGAIN</code>ï¼ˆä¸ä¼šé˜»å¡ï¼‰ã€‚</li>
</ul></li>
<li>è¿›ç¨‹é€šå¸¸ä¼š<strong>è½®è¯¢</strong>ï¼ˆä¸æ–­è°ƒç”¨
<code>read()</code>ï¼‰ç›´åˆ°æ•°æ®å¯ç”¨ã€‚</li>
</ol>
<h3 id="ä¿¡å·é©±åŠ¨io">ä¿¡å·é©±åŠ¨I/O</h3>
<p>è®©å†…æ ¸åœ¨ I/O äº‹ä»¶å‘ç”Ÿæ—¶å‘é€ä¿¡å· (<code>SIGIO</code>)
é€šçŸ¥è¿›ç¨‹ï¼Œè¿›ç¨‹åœ¨ä¿¡å·å¤„ç†ç¨‹åºä¸­æ‰§è¡Œ I/O æ“ä½œã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol type="1">
<li>è¿›ç¨‹è°ƒç”¨ <code>fcntl()</code> å¯ç”¨ <code>O_ASYNC</code>
æ ‡å¿—ï¼Œè®©å†…æ ¸åœ¨ I/O äº‹ä»¶å‘ç”Ÿæ—¶å‘é€ <code>SIGIO</code> ä¿¡å·ã€‚</li>
<li>è¿›ç¨‹ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œä¸é˜»å¡ã€‚</li>
<li>å½“æ•°æ®å¯ç”¨æ—¶ï¼Œå†…æ ¸å‘é€ <code>SIGIO</code> ä¿¡å·ã€‚</li>
<li>ä¿¡å·å¤„ç†å‡½æ•°è°ƒç”¨ <code>read()</code> è¯»å–æ•°æ®ã€‚</li>
</ol>
<h3 id="å¼‚æ­¥io">å¼‚æ­¥I/O</h3>
<p>è¿›ç¨‹å‘èµ· I/O è¯·æ±‚å<strong>ä¸ä¼šé˜»å¡</strong>ï¼Œå†…æ ¸åœ¨ I/O
æ“ä½œå®Œæˆåé€šçŸ¥è¿›ç¨‹ã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol type="1">
<li>è¿›ç¨‹è°ƒç”¨ <code>aio_read()</code> è®©å†…æ ¸æ‰§è¡Œ I/O æ“ä½œã€‚</li>
<li>è¿›ç¨‹ç«‹å³ç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œä¸é˜»å¡ã€‚</li>
<li>å†…æ ¸å®Œæˆ I/O åï¼Œä¸»åŠ¨é€šçŸ¥è¿›ç¨‹ï¼ˆå¦‚å›è°ƒå‡½æ•°æˆ– <code>SIGEV</code>
æœºåˆ¶ï¼‰ã€‚</li>
<li>è¿›ç¨‹è·å–æ•°æ®ï¼ŒI/O æ“ä½œå®Œæˆã€‚</li>
</ol>
<blockquote>
<p>å¼‚æ­¥I/Oä¸ä¿¡å·é©±åŠ¨I/Oçš„åŒºåˆ«</p>
<p><strong>ä¿¡å·é©±åŠ¨ I/O (<code>SIGIO</code>)</strong>ï¼š</p>
<ul>
<li>åªæ˜¯<strong>æå‰é€šçŸ¥</strong>è¿›ç¨‹ â€œæ•°æ®å¯è¯»â€ï¼Œä½†è¿›ç¨‹ä»éœ€
<code>read()</code> è·å–æ•°æ®ã€‚</li>
<li>é€‚ç”¨äº<strong>é«˜å¹¶å‘ç½‘ç»œ I/O</strong>ï¼ˆä½†ç°ä»£é«˜æ€§èƒ½æœåŠ¡å™¨ä¸€èˆ¬ç”¨
<code>epoll</code>ï¼‰ã€‚</li>
</ul>
<p><strong>å¼‚æ­¥ I/O (AIO)</strong>ï¼š</p>
<ul>
<li><strong>çœŸæ­£çš„å¼‚æ­¥</strong>ï¼Œå†…æ ¸å®Œæˆ I/O åæ•°æ®å·²å°±ç»ªï¼Œæ— éœ€
<code>read()</code>ã€‚</li>
<li>é€‚ç”¨äº<strong>é«˜ååæ–‡ä»¶ I/O</strong>ï¼Œå¦‚æ•°æ®åº“ã€å­˜å‚¨ç³»ç»Ÿ
(<code>io_uring</code> é€‚ç”¨äºç½‘ç»œå’Œæ–‡ä»¶)ã€‚</li>
</ul>
</blockquote>
<h3 id="ioå¤ç”¨">I/Oå¤ç”¨</h3>
<p>é€šè¿‡ <code>select()</code>ã€<code>poll()</code> æˆ–
<code>epoll()</code> è®©ä¸€ä¸ªçº¿ç¨‹åŒæ—¶ç›‘è§†å¤šä¸ª I/O äº‹ä»¶ï¼Œæé«˜å¹¶å‘èƒ½åŠ›ã€‚</p>
<p><strong>æµç¨‹</strong>ï¼š</p>
<ol type="1">
<li>è¿›ç¨‹è°ƒç”¨
<code>select()</code>/<code>poll()</code>/<code>epoll_wait()</code>ï¼Œç­‰å¾…å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€å˜åŒ–ã€‚</li>
<li>å¦‚æœæŸä¸ªæè¿°ç¬¦å‡†å¤‡å¥½ï¼Œè¿›ç¨‹å†å»æ‰§è¡Œ <code>read()</code>ã€‚</li>
<li><code>read()</code>
ä»ç„¶æ˜¯é˜»å¡çš„ï¼Œä½†å› ä¸ºä¹‹å‰å·²ç»ç¡®è®¤äº†æ•°æ®å¯è¯»ï¼Œé˜»å¡æ—¶é—´å¾ˆçŸ­ã€‚</li>
</ol>
<h4 id="select">select</h4>
<p><code>select()</code> å‡½æ•°æ˜¯ä¸€ç§ <strong>I/O å¤šè·¯å¤ç”¨</strong>
æŠ€æœ¯ï¼Œå®ƒå¯ä»¥ <strong>åŒæ—¶ç›‘å¬å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ (File Descriptor,
FD)</strong> çš„çŠ¶æ€ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/select.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">select</span><span class="params">(<span class="type">int</span> nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, <span class="keyword">struct</span> timeval *timeout)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<table>
<colgroup>
<col style="width: 15%">
<col style="width: 84%">
</colgroup>
<thead>
<tr class="header">
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>nfds</code></td>
<td>ç›‘å¬çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦çš„å€¼åŠ  1ï¼ˆä»… Linux éœ€è¦ï¼ŒWindows
å¿½ç•¥æ­¤å‚æ•°ï¼‰ã€‚</td>
</tr>
<tr class="even">
<td><code>readfds</code></td>
<td>ç›‘å¬å¯è¯»äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼ˆå¯ä¸º <code>NULL</code>ï¼‰ã€‚</td>
</tr>
<tr class="odd">
<td><code>writefds</code></td>
<td>ç›‘å¬å¯å†™äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼ˆå¯ä¸º <code>NULL</code>ï¼‰ã€‚</td>
</tr>
<tr class="even">
<td><code>exceptfds</code></td>
<td>ç›‘å¬å¼‚å¸¸äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼ˆå¯ä¸º <code>NULL</code>ï¼‰ã€‚</td>
</tr>
<tr class="odd">
<td><code>timeout</code></td>
<td>è®¾å®šè¶…æ—¶æ—¶é—´ï¼Œå¯ä¸º <code>NULL</code>ï¼ˆè¡¨ç¤ºæ— é™ç­‰å¾…ï¼‰ã€‚</td>
</tr>
</tbody>
</table>
<p>selectæˆåŠŸæ—¶è¿”å›å°±ç»ªï¼ˆå¯è¯»ã€å¯å†™å’Œå¼‚å¸¸ï¼‰â½‚ä»¶æè¿°ç¬¦çš„æ€»æ•°ã€‚å¦‚æœåœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰ä»»ä½•â½‚ä»¶æè¿°ç¬¦å°±ç»ªï¼Œselectå°†è¿”å›0ã€‚selectå¤±è´¥æ—¶è¿”å›-1ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>select</code>ç›‘å¬çš„æ–‡ä»¶æ“ä½œç¬¦å¯èƒ½å‡ºç°çš„çŠ¶æ€ï¼šï¼ˆ<code>FD_ISSET</code>ç”¨äºåˆ¤æ–­çŠ¶æ€æ˜¯å¦å˜åŒ–å³æ˜¯å¦å°±ç»ªï¼Œä¾‹å¦‚<code>FD_ISSET(fd, &amp;readfds)</code>
ç”¨äºæ£€æŸ¥æŸä¸ªæ–‡ä»¶æè¿°ç¬¦ (<code>fd</code>) æ˜¯å¦<strong>åœ¨
<code>readfds</code> é›†åˆä¸­è¢«æ ‡è®°ä¸ºå¯è¯»</strong>ã€‚ï¼‰</p>
<table>
<colgroup>
<col style="width: 25%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">ç›‘å¬ç±»å‹</th>
<th style="text-align: center;">è§¦å‘æ¡ä»¶</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>å¯è¯»
<code>readfds</code></strong></td>
<td style="text-align: center;">1. <code>socket</code> æœ‰æ•°æ®å¯è¯»
<br>2. <code>accept()</code> æœ‰æ–°è¿æ¥ <br>3. <code>read()</code>
è¿”å› 0ï¼ˆå¯¹ç«¯å…³é—­ï¼‰ <br>4. ç»ˆç«¯ã€ç®¡é“ã€æ–‡ä»¶å¯è¯»</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>å¯å†™
<code>writefds</code></strong></td>
<td style="text-align: center;">1. <code>socket</code> å‘é€ç¼“å†²åŒºå¯ç”¨
<br>2. <code>connect()</code> éé˜»å¡æ¨¡å¼å®Œæˆ <br>3.
<code>write()</code> ä¸ä¼šé˜»å¡</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>å¼‚å¸¸
<code>exceptfds</code></strong></td>
<td style="text-align: center;">1. <code>connect()</code> å¤±è´¥ <br>2.
<code>MSG_OOB</code> <strong>å¸¦å¤–æ•°æ®</strong> <br>3. TCP è¿æ¥å¤ä½
(RST)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><code>fd_set</code>ï¼š<strong>æ–‡ä»¶æè¿°ç¬¦ï¼ˆfile
descriptorï¼‰é›†åˆ</strong>ï¼Œåªèƒ½å­˜ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FD_ZERO</span><span class="params">(fd_set *set)</span></span>;    <span class="comment">// æ¸…ç©ºé›†åˆ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FD_SET</span><span class="params">(<span class="type">int</span> fd, fd_set *set)</span></span>;  <span class="comment">// æ·»åŠ æ–‡ä»¶æè¿°ç¬¦</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FD_CLR</span><span class="params">(<span class="type">int</span> fd, fd_set *set)</span></span>;  <span class="comment">// ä»é›†åˆä¸­ç§»é™¤æ–‡ä»¶æè¿°ç¬¦</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">FD_ISSET</span><span class="params">(<span class="type">int</span> fd, fd_set *set)</span></span>; <span class="comment">// æ£€æŸ¥æ–‡ä»¶æè¿°ç¬¦æ˜¯å¦å‡†å¤‡å°±ç»ª</span></span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<p>ä¸¤ç§åº”ç”¨ï¼š</p>
<p><strong><code>select()</code> + éé˜»å¡
I/Oï¼ˆçº¯äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼‰</strong>ï¼š</p>
<ul>
<li>é€‚ç”¨äº <strong>é«˜å¹¶å‘ã€è½»é‡çº§è¿æ¥</strong> çš„åœºæ™¯ï¼Œå¦‚
<strong>èŠå¤©å®¤ã€HTTP ä»£ç†æœåŠ¡å™¨</strong>ã€‚</li>
<li>æ— éœ€å¤šè¿›ç¨‹æˆ–å¤šçº¿ç¨‹ï¼Œ<strong>å•çº¿ç¨‹å³å¯ç®¡ç†å’Œå¤„ç†å¤šä¸ªè¿æ¥</strong>ã€‚</li>
</ul>
<p><strong><code>select()</code> +
<code>fork()</code>ï¼ˆæ··åˆæ¨¡å‹ï¼‰</strong>ï¼š</p>
<ul>
<li>é€‚ç”¨äº <strong>ä¸­å°è§„æ¨¡å¹¶å‘</strong> ä¸”
<strong>æ¯ä¸ªè¿æ¥éœ€è¦è¾ƒé‡ä¸šåŠ¡å¤„ç†</strong> çš„åœºæ™¯ï¼Œå¦‚
<strong>æ–‡ä»¶ä¸Šä¼ ã€æ•°æ®è®¡ç®—</strong>ã€‚</li>
<li>é€šè¿‡ <strong>å­è¿›ç¨‹é¿å…é˜»å¡ä¸»è¿›ç¨‹</strong>ï¼Œç®€åŒ–äº† <strong>I/O
æ“ä½œçš„ç¼–ç¨‹æ¨¡å‹</strong>ã€‚</li>
</ul>
<h4 id="poll">poll</h4>
<p><code>poll()</code> æ˜¯ <code>select()</code> çš„æ”¹è¿›ç‰ˆï¼Œ<strong>å»é™¤äº†
1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰çš„é™åˆ¶</strong>ï¼Œä½†ä»ç„¶éœ€è¦éå†æ•´ä¸ª fd
åˆ—è¡¨ã€‚pollç³»ç»Ÿè°ƒâ½¤çš„è¿”å›å€¼çš„å«ä¹‰ä¸selectç›¸åŒã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;poll.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">poll</span><span class="params">(<span class="keyword">struct</span> pollfd *fds, <span class="type">nfds_t</span> nfds, <span class="type">int</span> timeout)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pollfd ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">pollfd</span> {</span><br><span class="line">    <span class="type">int</span> fd;         <span class="comment">// ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦</span></span><br><span class="line">    <span class="type">short</span> events;   <span class="comment">// ç›‘å¬çš„äº‹ä»¶ï¼ˆPOLLIN-å¯è¯», POLLOUT-å¯å†™, POLLERR-é”™è¯¯ï¼‰</span></span><br><span class="line">    <span class="type">short</span> revents;  <span class="comment">// è§¦å‘çš„äº‹ä»¶ï¼ˆç”±å†…æ ¸å¡«å……ï¼‰</span></span><br><span class="line">};</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°ï¼š</p>
<ul>
<li><code>fds</code>: <code>pollfd</code>
ç»“æ„ä½“æ•°ç»„ï¼Œå­˜æ”¾è¦ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦åŠå…¶äº‹ä»¶ã€‚</li>
<li><code>nfds</code>: <code>fds</code> æ•°ç»„çš„å¤§å°ã€‚</li>
<li><code>timeout</code>: è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œ<code>-1</code>
è¡¨ç¤ºæ— é™ç­‰å¾…ï¼Œ<code>0</code> è¡¨ç¤ºç«‹å³è¿”å›ã€‚</li>
</ul>
<h4 id="epoll">epoll</h4>
<p><code>epoll</code> æ˜¯ Linux ç‰¹æœ‰çš„ <strong>é«˜æ•ˆ I/O å¤ç”¨</strong>
æœºåˆ¶ï¼Œé€‚ç”¨äº <strong>é«˜å¹¶å‘åœºæ™¯ï¼ˆå¦‚ 1 ä¸‡ä¸ª socketï¼‰</strong>ã€‚</p>
<p><strong>(1) <code>epoll_create()</code>
åˆ›å»ºå†…æ ¸äº‹ä»¶è¡¨ï¼ˆepollå®ä¾‹ï¼‰</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/epoll.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">epoll_create</span><span class="params">(<span class="type">int</span> flags)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>åˆ›å»ºå†…æ ¸äº‹ä»¶è¡¨</strong>ï¼Œè¿”å› <code>epfd</code>ï¼ˆå¤±è´¥è¿”å›
<code>-1</code>ï¼‰ã€‚</li>
</ul>
<p><strong>(2) <code>epoll_ctl()</code> æ·»åŠ /åˆ é™¤/ä¿®æ”¹ fdï¼ˆå³ç®¡ç†
fdï¼‰</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">epoll_ctl</span><span class="params">(<span class="type">int</span> epfd, <span class="type">int</span> op, <span class="type">int</span> fd, <span class="keyword">struct</span> epoll_event *event)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// epoll_event ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">epoll_event</span> {</span><br><span class="line">    <span class="type">uint32_t</span> events;  <span class="comment">// ç›‘å¬çš„äº‹ä»¶ï¼ˆEPOLLIN, EPOLLOUT ç­‰ï¼Œè¿˜åŒ…æ‹¬EPOLLET-è¾¹ç¼˜è§¦å‘æ¨¡å¼ï¼‰</span></span><br><span class="line">    <span class="type">epoll_data_t</span> data; <span class="comment">// ç”¨æˆ·æ•°æ®ï¼ˆé€šå¸¸å­˜ fdï¼‰</span></span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>epfd</code>: <code>epoll_create()</code> è¿”å›çš„ epoll
å¥æŸ„ã€‚</li>
<li><code>op</code>: æ“ä½œç±»å‹ï¼š
<ul>
<li><code>EPOLL_CTL_ADD</code>ï¼šæ·»åŠ  <code>fd</code>ã€‚</li>
<li><code>EPOLL_CTL_MOD</code>ï¼šä¿®æ”¹ <code>fd</code> ç›‘å¬çš„äº‹ä»¶ã€‚</li>
<li><code>EPOLL_CTL_DEL</code>ï¼šåˆ é™¤ <code>fd</code>ã€‚</li>
</ul></li>
<li><code>fd</code>: éœ€è¦ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆsocketï¼‰ã€‚</li>
<li><code>event</code>: ç›‘å¬çš„äº‹ä»¶ã€‚</li>
</ul>
<p><strong>(3) <code>epoll_wait()</code> è·å–å‘ç”Ÿäº‹ä»¶çš„ fd</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">epoll_wait</span><span class="params">(<span class="type">int</span> epfd, <span class="keyword">struct</span> epoll_event *events, <span class="type">int</span> maxevents, <span class="type">int</span> timeout)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>epfd</code>: <code>epoll_create()</code> è¿”å›çš„ epoll
å¥æŸ„ã€‚</li>
<li><code>events</code>: ç”¨äºå­˜å‚¨è§¦å‘äº‹ä»¶çš„ <code>epoll_event</code>
æ•°ç»„ã€‚</li>
<li><code>maxevents</code>: <code>events</code> æ•°ç»„çš„å¤§å°ï¼ˆå»ºè®®è®¾ç½®ä¸º
<code>10</code>~<code>1000</code>ï¼‰ã€‚</li>
<li><code>timeout</code>: è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œ<code>-1</code>
è¡¨ç¤ºæ— é™ç­‰å¾…ï¼Œ<code>0</code> è¡¨ç¤ºç«‹å³è¿”å›ã€‚</li>
</ul>
<p><strong>(4) LTï¼ˆæ°´å¹³è§¦å‘ï¼‰å’ŒETï¼ˆè¾¹ç¼˜è§¦å‘ï¼‰æ¨¡å¼</strong></p>
<p>LTï¼šåªè¦æ•°æ®æœªè¢«è¯»å–ï¼Œ<code>epoll_wait()</code>
<strong>ä¸€ç›´è¿”å›</strong> å¯è¯»äº‹ä»¶ã€‚</p>
<p>ETï¼š<strong>åªåœ¨çŠ¶æ€å˜åŒ–æ—¶é€šçŸ¥ä¸€æ¬¡</strong>ï¼Œå¦‚æœä¸ç«‹å³å¤„ç†ï¼Œ<code>epoll_wait()</code>
<strong>ä¸ä¼šå†æ¬¡é€šçŸ¥</strong>ã€‚</p>
<ol type="1">
<li><strong>LTï¼ˆLevel Triggeredï¼Œæ°´å¹³è§¦å‘ï¼‰æ¨¡å¼</strong></li>
</ol>
<ul>
<li><strong>è¡Œä¸º</strong>ï¼š
<ul>
<li>åªè¦æ–‡ä»¶æè¿°ç¬¦å¤„äºå°±ç»ªçŠ¶æ€ï¼ˆå³æœ‰æ•°æ®å¯è¯»æˆ–å¯å†™ï¼‰ï¼Œepoll
å°±ä¼šæŒç»­é€šçŸ¥åº”ç”¨ç¨‹åºã€‚</li>
<li>å¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰å¤„ç†å®Œæ‰€æœ‰æ•°æ®ï¼Œepoll ä¼šåœ¨ä¸‹ä¸€æ¬¡è°ƒç”¨ epoll_wait
æ—¶å†æ¬¡é€šçŸ¥ã€‚</li>
</ul></li>
<li>ç‰¹ç‚¹:
<ul>
<li>ç®€å•æ˜“ç”¨: é€‚åˆåˆå­¦è€…æˆ–ç®€å•çš„åº”ç”¨åœºæ™¯ã€‚</li>
<li>å®¹é”™æ€§å¼º:
å³ä½¿åº”ç”¨ç¨‹åºæ²¡æœ‰ä¸€æ¬¡æ€§å¤„ç†å®Œæ‰€æœ‰æ•°æ®ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±äº‹ä»¶ã€‚</li>
<li>å¯èƒ½æ•ˆç‡è¾ƒä½: å¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰åŠæ—¶å¤„ç†æ•°æ®ï¼Œepoll
ä¼šé¢‘ç¹é€šçŸ¥ï¼Œå¯¼è‡´ä¸å¿…è¦çš„å¼€é”€ã€‚</li>
</ul></li>
<li>é€‚ç”¨åœºæ™¯:
<ul>
<li>éœ€è¦å…¼å®¹æ€§å¼ºçš„åœºæ™¯ï¼ˆå¦‚ä¼ ç»Ÿçš„ select æˆ– poll è¿ç§»åˆ° epollï¼‰ã€‚</li>
<li>å¯¹æ€§èƒ½è¦æ±‚ä¸é«˜çš„åœºæ™¯ã€‚</li>
</ul></li>
</ul>
<ol start="2" type="1">
<li><strong>ETï¼ˆEdge Triggeredï¼Œè¾¹ç¼˜è§¦å‘ï¼‰æ¨¡å¼</strong></li>
</ol>
<ul>
<li><strong>è¡Œä¸º</strong>:
<ul>
<li>åªæœ‰å½“æ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¦‚ä»æ— æ•°æ®å˜ä¸ºæœ‰æ•°æ®ï¼‰ï¼Œepoll
æ‰ä¼šé€šçŸ¥åº”ç”¨ç¨‹åºã€‚</li>
<li>å¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰å¤„ç†å®Œæ‰€æœ‰æ•°æ®ï¼Œepoll
ä¸ä¼šå†æ¬¡é€šçŸ¥ï¼Œé™¤éæ–‡ä»¶æè¿°ç¬¦çš„çŠ¶æ€å†æ¬¡å‘ç”Ÿå˜åŒ–ã€‚</li>
</ul></li>
<li>ç‰¹ç‚¹:
<ul>
<li>é«˜æ•ˆ: å‡å°‘äº†ä¸å¿…è¦çš„é€šçŸ¥ï¼Œé€‚åˆé«˜æ€§èƒ½åœºæ™¯ã€‚</li>
<li>éœ€è¦ä¸€æ¬¡æ€§å¤„ç†å®Œæ•°æ®:
åº”ç”¨ç¨‹åºå¿…é¡»ç¡®ä¿åœ¨ä¸€æ¬¡äº‹ä»¶é€šçŸ¥ä¸­å¤„ç†å®Œæ‰€æœ‰æ•°æ®ï¼Œå¦åˆ™å¯èƒ½ä¼šä¸¢å¤±åç»­äº‹ä»¶ã€‚</li>
<li>å¤æ‚æ€§è¾ƒé«˜: éœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œé€šå¸¸ä¸éé˜»å¡ I/O ç»“åˆä½¿ç”¨ã€‚</li>
</ul></li>
<li>é€‚ç”¨åœºæ™¯:
<ul>
<li>é«˜æ€§èƒ½æœåŠ¡å™¨ï¼ˆå¦‚ Web æœåŠ¡å™¨ã€æ¸¸æˆæœåŠ¡å™¨ï¼‰ã€‚</li>
<li>éœ€è¦å¤„ç†å¤§é‡å¹¶å‘è¿æ¥çš„åœºæ™¯ã€‚</li>
</ul></li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">event.events = EPOLLIN; <span class="comment">// LT æ¨¡å¼</span></span><br><span class="line"><span class="comment">// event.events = EPOLLIN | EPOLLET; // ET æ¨¡å¼</span></span><br><span class="line"><span class="built_in">epoll_ctl</span>(epfd, EPOLL_CTL_ADD, socket_fd, &amp;event);</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p><code>EPOLLONESHOT</code> æ˜¯ <code>epoll</code>
ç›‘å¬äº‹ä»¶çš„ä¸€ä¸ª<strong>ç‰¹æ®Šæ ‡å¿—</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼š</p>
<ul>
<li><strong>äº‹ä»¶è§¦å‘ä¸€æ¬¡åï¼Œè‡ªåŠ¨ä» <code>epoll</code>
ç›‘å¬åˆ—è¡¨ä¸­ç§»é™¤</strong>ã€‚</li>
<li><strong>é€‚ç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒ</strong>ï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶å¤„ç†åŒä¸€ä¸ª
<code>fd</code>ã€‚</li>
</ul>
</blockquote>
<blockquote>
<p><strong>å†…æ ¸äº‹ä»¶è¡¨ï¼ˆKernel Event Tableï¼‰</strong> æ˜¯
<strong><code>epoll</code></strong>
æœºåˆ¶çš„<strong>æ ¸å¿ƒæ•°æ®ç»“æ„</strong>ï¼Œç”¨äº<strong>å­˜å‚¨å’Œç®¡ç†éœ€è¦ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰åŠå…¶äº‹ä»¶</strong>ã€‚å®ƒç”±
Linux å†…æ ¸ç»´æŠ¤ï¼Œæä¾›äº†é«˜æ•ˆçš„äº‹ä»¶é€šçŸ¥æœºåˆ¶ã€‚</p>
<ol type="1">
<li><p>ä¸ºä»€ä¹ˆéœ€è¦å†…æ ¸äº‹ä»¶è¡¨ï¼Ÿ</p>
<p>åœ¨ <code>select()</code> å’Œ <code>poll()</code>
æœºåˆ¶ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹<strong>æ¯æ¬¡è°ƒç”¨</strong>éƒ½è¦<strong>ä¼ é€’æ‰€æœ‰ç›‘å¬çš„
fd</strong>ï¼Œå¯¼è‡´<strong>å¤§é‡æ•°æ®æ‹·è´å’Œéå†</strong>ï¼Œå½±å“æ€§èƒ½ã€‚</p>
<p><strong><code>epoll</code> çš„æ”¹è¿›ï¼š</strong></p>
<ol type="1">
<li><p><strong>fd åªéœ€æ³¨å†Œä¸€æ¬¡</strong>ï¼Œå­˜å…¥
<strong>å†…æ ¸äº‹ä»¶è¡¨</strong>ï¼Œåç»­å†…æ ¸è‡ªåŠ¨ç®¡ç†ã€‚</p></li>
<li><p><strong>é¿å…æ— æ•ˆ fd éå†</strong>ï¼Œåªè¿”å›<strong>å‘ç”Ÿäº‹ä»¶çš„
fd</strong>ï¼Œæé«˜æ•ˆç‡ï¼ˆ<code>O(1)</code>ï¼‰ã€‚</p></li>
</ol></li>
<li><p>å†…æ ¸äº‹ä»¶è¡¨çš„ç»„æˆ</p>
<p>å†…æ ¸äº‹ä»¶è¡¨å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª<strong>çº¢é»‘æ ‘ + å°±ç»ªåˆ—è¡¨</strong>ï¼š</p>
<ol type="1">
<li><strong>ç›‘å¬ fd çš„çº¢é»‘æ ‘</strong></li>
</ol>
<ul>
<li>ä½œç”¨ï¼šå­˜å‚¨ <strong>æ‰€æœ‰å·²æ³¨å†Œçš„ fd</strong>ï¼Œæ”¯æŒé«˜æ•ˆçš„
<strong>å¢/åˆ /æ”¹</strong>ã€‚</li>
<li>ç”± <code>epoll_ctl()</code> è¿›è¡Œç®¡ç†ã€‚</li>
</ul>
<ol start="2" type="1">
<li><strong>äº‹ä»¶å°±ç»ªåˆ—è¡¨</strong></li>
</ol>
<ul>
<li>ä½œç”¨ï¼šå­˜å‚¨ <strong>å‘ç”Ÿäº‹ä»¶çš„ fd</strong>ã€‚</li>
<li><code>epoll_wait()</code> åªè¿”å›<strong>å°±ç»ªåˆ—è¡¨ä¸­çš„
fd</strong>ï¼Œé¿å…æ— æ•ˆéå†ï¼Œæé«˜æ€§èƒ½</li>
</ul></li>
</ol>
</blockquote>
<h2 id="ä¸¤ç§äº‹ä»¶å¤„ç†æ¨¡å¼">ä¸¤ç§äº‹ä»¶å¤„ç†æ¨¡å¼</h2>
<h3 id="reactoræ¨¡å¼">Reactoræ¨¡å¼</h3>
<p>ä½¿â½¤<strong>åŒæ­¥I/Oæ¨¡å‹</strong>å®ç°ã€‚å…¶ä¸»è¦ç‰¹ç‚¹æ˜¯<strong>ç”±ä¸€ä¸ªæˆ–å¤šä¸ª
I/O å¤šè·¯å¤ç”¨å™¨ï¼ˆå¦‚
<code>select</code>ã€<code>poll</code>ã€<code>epoll</code>ï¼‰ç›‘å¬äº‹ä»¶</strong>ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œé€šçŸ¥ç›¸åº”çš„äº‹ä»¶å¤„ç†å™¨è¿›è¡Œå¤„ç†ã€‚</p>
<ul>
<li><strong>ä¸»çº¿ç¨‹</strong> ç›‘å¬ I/O äº‹ä»¶ï¼Œåˆ†å‘ä»»åŠ¡ã€‚</li>
<li><strong>å·¥ä½œçº¿ç¨‹</strong> å¤„ç† I/O å’Œä¸šåŠ¡é€»è¾‘ï¼Œé€šå¸¸ä½¿ç”¨çº¿ç¨‹æ± ã€‚</li>
<li>é€‚ç”¨äº <strong>é«˜å¹¶å‘çŸ­ I/O æ“ä½œ</strong>ï¼Œå¦‚ <code>epoll</code>
æœåŠ¡å™¨ï¼ˆNginxã€Redisï¼‰ã€‚</li>
</ul>
<h3 id="proactoræ¨¡å¼">Proactoræ¨¡å¼</h3>
<p>ä½¿â½¤<strong>å¼‚æ­¥I/Oæ¨¡å‹</strong>å®ç°ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯<strong>ç”±æ“ä½œç³»ç»Ÿå†…æ ¸å®Œæˆ
I/O
æ“ä½œåå†é€šçŸ¥åº”ç”¨ç¨‹åº</strong>ï¼Œå³äº‹ä»¶çš„å¤„ç†ç”±å†…æ ¸è´Ÿè´£ï¼Œè€Œä¸æ˜¯åº”ç”¨ç¨‹åºä¸»åŠ¨å»æ£€æŸ¥äº‹ä»¶çŠ¶æ€ã€‚</p>
<ul>
<li><strong>ä¸»çº¿ç¨‹</strong> æäº¤å¼‚æ­¥ I/Oï¼Œç­‰å¾…æ“ä½œç³»ç»Ÿé€šçŸ¥å®Œæˆã€‚</li>
<li><strong>æ“ä½œç³»ç»Ÿ</strong> è´Ÿè´£å®é™… I/O è¯»å–å’Œå†™å…¥ã€‚</li>
<li><strong>å·¥ä½œçº¿ç¨‹</strong> åªå¤„ç†å®Œæˆçš„ I/O æ•°æ®ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚</li>
<li>é€‚ç”¨äº <strong>é•¿æ—¶é—´å¼‚æ­¥ I/O æ“ä½œ</strong>ï¼Œå¦‚ Windows IOCPã€‚</li>
</ul>
<h2 id="ä¸¤ç§å¹¶å‘æ¨¡å¼">ä¸¤ç§å¹¶å‘æ¨¡å¼</h2>
<h3 id="åŠåŒæ­¥åŠå¼‚æ­¥">åŠåŒæ­¥/åŠå¼‚æ­¥</h3>
<ol type="1">
<li><p>ä¸‹é¢è¿™ç§ä¹Ÿå«<strong>åŠåŒæ­¥/åŠååº”å †</strong>æ¨¡å¼</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250222231946543.png" alt="image-20250222231946543">
<figcaption aria-hidden="true">image-20250222231946543</figcaption>
</figure>
<p>ä¸Šå›¾ä¸­çš„å¼‚æ­¥çº¿ç¨‹åªæœ‰â¼€ä¸ªï¼Œç”±ä¸»çº¿ç¨‹æ¥å……å½“ï¼Œå·¥ä½œçº¿ç¨‹éƒ½æ˜¯åŒæ­¥çº¿ç¨‹</p></li>
<li><p>ä¸‹é¢æ˜¯â¾¼æ•ˆçš„<strong>åŠåŒæ­¥/åŠå¼‚æ­¥</strong>æ¨¡å¼</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250222232510227.png" alt="image-20250222232510227">
<figcaption aria-hidden="true">image-20250222232510227</figcaption>
</figure>
<p>æ³¨æ„è¿™é‡Œçš„ä¸»çº¿ç¨‹åªç®¡ç†<strong>ç›‘å¬socket</strong>ï¼Œè€Œ<strong>è¿æ¥socket</strong>äº¤ç»™å·¥ä½œçº¿ç¨‹ç®¡ç†ã€‚åœ¨è¿™ç§â¾¼æ•ˆçš„åŠåŒæ­¥/åŠå¼‚æ­¥æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½â¼¯ä½œåœ¨å¼‚æ­¥æ¨¡å¼ã€‚æ‰€ä»¥å®ƒå¹¶â¾®ä¸¥æ ¼æ„ä¹‰ä¸Šçš„åŠåŒæ­¥/åŠå¼‚æ­¥æ¨¡å¼ã€‚</p></li>
</ol>
<h3 id="é¢†å¯¼è€…è¿½éšè€…æ¨¡å¼">é¢†å¯¼è€…/è¿½éšè€…æ¨¡å¼</h3>
<ul>
<li>å¤šä¸ªâ¼¯ä½œçº¿ç¨‹è½®æµè·å¾—äº‹ä»¶æºé›†åˆï¼Œè½®æµç›‘å¬ã€åˆ†å‘å¹¶å¤„ç†äº‹ä»¶</li>
<li>åœ¨ä»»æ„æ—¶é—´ç‚¹ï¼Œç¨‹åºéƒ½ä»…æœ‰â¼€ä¸ªé¢†å¯¼è€…çº¿ç¨‹ï¼Œå®ƒè´Ÿè´£ç›‘å¬I/Oäº‹ä»¶ã€‚</li>
<li>å…¶ä»–çº¿ç¨‹åˆ™éƒ½æ˜¯è¿½éšè€…ï¼Œå®ƒä»¬ä¼‘çœ åœ¨çº¿ç¨‹æ± ä¸­ç­‰å¾…æˆä¸ºæ–°çš„é¢†å¯¼è€…</li>
<li>å½“å‰çš„é¢†å¯¼è€…å¦‚æœæ£€æµ‹åˆ°I/Oäº‹ä»¶ï¼Œâ¾¸å…ˆè¦ä»çº¿ç¨‹æ± ä¸­æ¨é€‰å‡ºæ–°çš„é¢†å¯¼è€…çº¿ç¨‹ï¼Œç„¶å(å½“å‰é¢†å¯¼è€…)å¤„ç†I/Oäº‹ä»¶ï¼Œæ–°é¢†å¯¼è€…ç­‰å¾…æ–°çš„I/Oäº‹ä»¶</li>
</ul>
<h2 id="libevent-æ¡†æ¶">Libevent æ¡†æ¶</h2>
<p><code>libevent</code> çš„æ ¸å¿ƒæ¦‚å¿µå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç†è§£ï¼š</p>
<ul>
<li><strong>äº‹ä»¶å¤„ç†å™¨</strong>ï¼šäº‹ä»¶å¤„ç†å™¨è´Ÿè´£å¤„ç†ç‰¹å®šç±»å‹çš„äº‹ä»¶ï¼Œå®ƒä»¬å®šä¹‰äº†äº‹ä»¶çš„æºï¼ˆå¦‚æ–‡ä»¶æè¿°ç¬¦ã€ä¿¡å·ç­‰ï¼‰å’Œè§¦å‘æ¡ä»¶ï¼ˆå¦‚å¯è¯»ã€å¯å†™ã€ä¿¡å·åˆ°æ¥ã€å®šæ—¶å™¨åˆ°æœŸç­‰ï¼‰ã€‚æ¯ä¸ªäº‹ä»¶å¤„ç†å™¨éƒ½ç»‘å®šäº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå›è°ƒå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚</li>
<li><strong>äº‹ä»¶å¤šè·¯åˆ†å‘å™¨</strong>ï¼šäº‹ä»¶åˆ†å‘å™¨è´Ÿè´£ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„ I/O
å¤šè·¯å¤ç”¨æœºåˆ¶æ¥ç›‘å¬äº‹ä»¶æºçš„çŠ¶æ€ï¼Œå¹¶è§¦å‘ç›¸åº”çš„å›è°ƒã€‚å®ƒç®¡ç†å’Œè°ƒåº¦æ‰€æœ‰äº‹ä»¶çš„æ‰§è¡Œã€‚</li>
<li><strong>äº‹ä»¶é˜Ÿåˆ—</strong>ï¼šäº‹ä»¶é˜Ÿåˆ—æ˜¯ <code>libevent</code>
ç”¨æ¥å­˜å‚¨å’Œè°ƒåº¦äº‹ä»¶çš„ç»“æ„ï¼Œå®ƒä¿è¯äº†äº‹ä»¶æŒ‰ç…§æ­£ç¡®çš„é¡ºåºï¼ˆä¼˜å…ˆçº§ã€æ—¶é—´é¡ºåºç­‰ï¼‰è¿›è¡Œè°ƒåº¦ã€‚äº‹ä»¶é˜Ÿåˆ—ä¹Ÿè´Ÿè´£ç®¡ç†
I/Oã€å®šæ—¶å™¨ã€ä¿¡å·ç­‰ç±»å‹çš„äº‹ä»¶ï¼Œå¹¶å°†å®ƒä»¬ä¼ é€’ç»™äº‹ä»¶åˆ†å‘å™¨è¿›è¡Œæ‰§è¡Œã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒç»“æ„</strong></p>
<ul>
<li><code>event_base</code>ï¼šäº‹ä»¶åˆ†å‘å™¨ï¼Œç®¡ç†æ‰€æœ‰äº‹ä»¶ã€‚</li>
<li><code>event</code>ï¼šäº‹ä»¶å¤„ç†å™¨ï¼Œè¡¨ç¤ºå…·ä½“çš„
I/Oã€ä¿¡å·ã€å®šæ—¶å™¨äº‹ä»¶ã€‚</li>
</ul>
<p><strong>ä¸»è¦æµç¨‹</strong></p>
<ol type="1">
<li><p><strong>åˆ›å»ºäº‹ä»¶å¾ªç¯</strong> â†’
<code>event_base_new()</code></p></li>
<li><p><strong>åˆ›å»ºäº‹ä»¶</strong> â†’ <code>event_new()</code></p></li>
<li><p><strong>æ³¨å†Œäº‹ä»¶</strong> â†’ <code>event_add()</code></p>
<blockquote>
<p><code>event_add()</code>
åªæ˜¯å°†äº‹ä»¶æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯ä¸­ï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚å®ƒå‘Šè¯‰
<code>libevent</code> è¿™ä¸ªäº‹ä»¶ï¼ˆä¾‹å¦‚ I/O
äº‹ä»¶ã€ä¿¡å·äº‹ä»¶ï¼‰åº”å½“è¢«ç›‘å¬å’Œè°ƒåº¦ï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰
<strong>ç›´æ¥å»ºç«‹äº‹ä»¶æºä¸äº‹ä»¶å¤„ç†å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»</strong>ã€‚å¯¹äºä¿¡å·äº‹ä»¶ï¼ˆä¾‹å¦‚
<code>SIGINT</code>ï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦é€šè¿‡å†…éƒ¨çš„æ˜ å°„å‡½æ•°æ¥å°†ä¿¡å·ï¼ˆå¦‚
<code>SIGINT</code>ï¼‰ä¸å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨è¿›è¡Œå…³è”ã€‚å…·ä½“è€Œè¨€ï¼Œ<code>evmap_signal_add()</code>
å°±æ˜¯ç”¨æ¥å¤„ç†è¿™ç§ä¿¡å·ä¸äº‹ä»¶å¤„ç†å™¨çš„æ˜ å°„å…³ç³»ã€‚</p>
</blockquote></li>
<li><p><strong>å¯åŠ¨äº‹ä»¶å¾ªç¯</strong> â†’
<code>event_base_dispatch()</code></p></li>
<li><p><strong>è§¦å‘äº‹ä»¶å¹¶æ‰§è¡Œå›è°ƒ</strong></p></li>
<li><p><strong>é‡Šæ”¾èµ„æº</strong> â†’ <code>event_free()</code> /
<code>event_base_free()</code></p></li>
</ol>
<p><strong>äº‹ä»¶å¤„ç†æœºåˆ¶</strong></p>
<ul>
<li><strong>I/O äº‹ä»¶</strong>ï¼šç›‘å¬æ–‡ä»¶æè¿°ç¬¦çš„å¯è¯»/å¯å†™çŠ¶æ€ã€‚</li>
<li><strong>ä¿¡å·äº‹ä»¶</strong>ï¼šç›‘å¬ç³»ç»Ÿä¿¡å·ï¼ˆå¦‚
<code>SIGINT</code>ï¼‰ã€‚</li>
<li><strong>å®šæ—¶å™¨äº‹ä»¶</strong>ï¼šåœ¨æŒ‡å®šæ—¶é—´åè§¦å‘å›è°ƒã€‚</li>
</ul>
<h2 id="å¤šè¿›ç¨‹ç¼–ç¨‹">å¤šè¿›ç¨‹ç¼–ç¨‹</h2>
<h3 id="execä¸fork">execä¸fork</h3>
<ol type="1">
<li><p><code>fork</code> ä¹‹åçš„å†…å­˜çŠ¶æ€</p>
<p>å½“ä½ è°ƒç”¨ <code>fork</code>
æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼ˆå­è¿›ç¨‹ï¼‰ï¼Œå­è¿›ç¨‹æ˜¯çˆ¶è¿›ç¨‹çš„å‰¯æœ¬ã€‚è¿™æ„å‘³ç€ï¼š</p>
<ul>
<li>å­è¿›ç¨‹ä¼šå¤åˆ¶çˆ¶è¿›ç¨‹çš„ä»£ç æ®µã€æ•°æ®æ®µã€å †æ ˆã€æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚</li>
<li><strong>åœ¨ <code>fork</code>
çš„ç¬é—´ï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹çš„å†…å­˜å†…å®¹æ˜¯å®Œå…¨ç›¸åŒçš„</strong>ã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œç°ä»£æ“ä½œç³»ç»Ÿä½¿ç”¨äº†ä¸€ç§ç§°ä¸º <strong>å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Write,
COWï¼‰</strong> çš„æŠ€æœ¯æ¥ä¼˜åŒ– <code>fork</code> çš„æ€§èƒ½ï¼š</p>
<ul>
<li><strong>å†™æ—¶å¤åˆ¶çš„å«ä¹‰</strong>ï¼š<code>fork</code>
ä¹‹åï¼Œçˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å…±äº«åŒä¸€å—ç‰©ç†å†…å­˜ï¼Œç›´åˆ°å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹å°è¯•ä¿®æ”¹å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šä¸ºä¿®æ”¹çš„è¿›ç¨‹å¤åˆ¶ä¸€ä»½æ–°çš„å†…å­˜é¡µã€‚</li>
<li>è¿™ç§æœºåˆ¶é¿å…äº†ä¸å¿…è¦çš„å†…å­˜å¤åˆ¶ï¼Œæé«˜äº†æ€§èƒ½ã€‚</li>
</ul></li>
<li><p><code>exec</code> çš„ä½œç”¨</p>
<p><code>exec</code> çš„ä½œç”¨æ˜¯
<strong>æ›¿æ¢å½“å‰è¿›ç¨‹çš„æ˜ åƒ</strong>ã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li><code>exec</code>
ä¼šå°†å½“å‰è¿›ç¨‹çš„ä»£ç æ®µã€æ•°æ®æ®µã€å †æ ˆç­‰å…¨éƒ¨æ›¿æ¢ä¸ºæ–°ç¨‹åºçš„å†…å®¹ã€‚</li>
<li>è°ƒç”¨ <code>exec</code>
åï¼Œå½“å‰è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¼šè¢«æ–°ç¨‹åºçš„å†…å®¹è¦†ç›–ã€‚</li>
</ul></li>
<li><p>ç»“åˆ <code>fork</code> å’Œ <code>exec</code> çš„å·¥ä½œæµç¨‹</p>
<p>å½“ä½ åœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨ <code>exec</code> æ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹äº‹æƒ…ï¼š</p>
<ol type="1">
<li><strong>å­è¿›ç¨‹çš„å†…å­˜è¢«æ›¿æ¢</strong>ï¼š</li>
</ol>
<ul>
<li><code>exec</code>
ä¼šåŠ è½½æ–°ç¨‹åºçš„ä»£ç å’Œæ•°æ®åˆ°å­è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­ã€‚</li>
<li>ç”±äºå†™æ—¶å¤åˆ¶çš„æœºåˆ¶ï¼Œå­è¿›ç¨‹çš„å†…å­˜ä¿®æ”¹ä¸ä¼šå½±å“çˆ¶è¿›ç¨‹ã€‚</li>
</ul>
<ol start="2" type="1">
<li><strong>çˆ¶è¿›ç¨‹ä¸å—å½±å“</strong>ï¼š</li>
</ol>
<ul>
<li>çˆ¶è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¿æŒä¸å˜ï¼Œç»§ç»­æ‰§è¡ŒåŸæ¥çš„ä»£ç ã€‚</li>
</ul>
<ol start="3" type="1">
<li><strong>å­è¿›ç¨‹æ‰§è¡Œæ–°ç¨‹åº</strong>ï¼š</li>
</ol>
<ul>
<li>å­è¿›ç¨‹ä»æ–°ç¨‹åºçš„å…¥å£ç‚¹ï¼ˆé€šå¸¸æ˜¯ <code>main</code>
å‡½æ•°ï¼‰å¼€å§‹æ‰§è¡Œã€‚</li>
</ul></li>
</ol>
<h2 id="å¤šçº¿ç¨‹ç¼–ç¨‹">å¤šçº¿ç¨‹ç¼–ç¨‹</h2>
<h3 id="äº’æ–¥é”">1. äº’æ–¥é”</h3>
<p>äº’æ–¥é”ï¼ˆ<code>pthread_mutex_t</code>ï¼‰æ˜¯ä¸€ç§ç”¨äº
<strong>ä¿æŠ¤å…±äº«èµ„æº</strong>
çš„åŒæ­¥æœºåˆ¶ï¼Œå®ƒç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚å¤šä¸ªçº¿ç¨‹å¦‚æœè¦è®¿é—®åŒä¸€èµ„æºï¼Œå¿…é¡»å…ˆè·å–è¯¥äº’æ–¥é”ï¼Œè·å–é”æˆåŠŸåæ‰èƒ½è®¿é—®èµ„æºï¼Œè®¿é—®å®Œæ¯•åé‡Šæ”¾é”ã€‚</p>
<ul>
<li><strong>ä¸»è¦ä½œç”¨</strong>ï¼šä¿æŠ¤å…±äº«èµ„æºï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼šåŠ é”åï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•åŠ é”ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾ã€‚</li>
<li><strong>ç¤ºä¾‹ç”¨æ³•</strong>ï¼šä¿è¯çº¿ç¨‹å®‰å…¨åœ°è®¿é—®å…¨å±€å˜é‡ã€å…±äº«æ•°æ®ç»“æ„ç­‰ã€‚</li>
</ul>
<h3 id="ä¿¡å·é‡">2. ä¿¡å·é‡</h3>
<p>ä¿¡å·é‡ï¼ˆ<code>sem_t</code>ï¼‰æ˜¯ä¸€ç§è®¡æ•°æœºåˆ¶ï¼Œç”¨äºæ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ã€‚ä¿¡å·é‡é€šå¸¸ç”¨äºæ§åˆ¶å¹¶å‘çš„çº¿ç¨‹æ•°ï¼Œæˆ–è€…ç”¨äºçº¿ç¨‹é—´çš„åŒæ­¥ã€‚å½“ä¿¡å·é‡çš„å€¼å¤§äº
0 æ—¶ï¼Œè¡¨ç¤ºå¯ä»¥ç»§ç»­æ‰§è¡Œï¼Œçº¿ç¨‹ä¼šæ‰§è¡Œ
<code>sem_wait</code>ï¼ˆç­‰å¾…ï¼‰ç›´åˆ°ä¿¡å·é‡å¤§äº 0ï¼Œç„¶å
<code>sem_post</code>ï¼ˆé‡Šæ”¾ï¼‰ä¿¡å·é‡ã€‚</p>
<ul>
<li><strong>ä¸»è¦ä½œç”¨</strong>ï¼šæ§åˆ¶å¯¹å…±äº«èµ„æºçš„è®¿é—®æ•°é‡æˆ–çº¿ç¨‹é—´çš„åŒæ­¥ã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼šä¿¡å·é‡çš„å€¼å¯ä»¥å¢åŠ æˆ–å‡å°‘ï¼Œé€šå¸¸ç”¨äºå®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ã€æ§åˆ¶çº¿ç¨‹æ± å¤§å°ç­‰ã€‚</li>
<li><strong>ç¤ºä¾‹ç”¨æ³•</strong>ï¼šæ§åˆ¶çº¿ç¨‹æ± ä¸­åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°ï¼Œæˆ–è€…åè°ƒç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„åŒæ­¥ã€‚</li>
</ul>
<h3 id="æ¡ä»¶å˜é‡">3. æ¡ä»¶å˜é‡</h3>
<p>æ¡ä»¶å˜é‡ï¼ˆ<code>pthread_cond_t</code>ï¼‰æ˜¯ç”¨äº
<strong>çº¿ç¨‹é—´åè°ƒ</strong>
çš„åŒæ­¥æœºåˆ¶ï¼Œå…è®¸çº¿ç¨‹åœ¨æŸä¸ªæ¡ä»¶æ»¡è¶³æ—¶è¢«å”¤é†’ã€‚å®ƒé€šå¸¸ä¸äº’æ–¥é”é…åˆä½¿ç”¨ã€‚å½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå®ƒä¼šåœ¨æ¡ä»¶å˜é‡ä¸Šç­‰å¾…ï¼Œå¹¶é‡Šæ”¾äº’æ–¥é”ã€‚ä¸€æ—¦æ¡ä»¶æ»¡è¶³ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°±ä¼šé€šè¿‡æ¡ä»¶å˜é‡é€šçŸ¥ï¼ˆ<code>signal</code>
æˆ– <code>broadcast</code>ï¼‰å…¶ä»–çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</p>
<ul>
<li><strong>ä¸»è¦ä½œç”¨</strong>ï¼šçº¿ç¨‹é—´çš„åè°ƒä¸åŒæ­¥ï¼Œå¸¸ç”¨äºâ€œç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³â€åç»§ç»­æ‰§è¡Œã€‚</li>
<li><strong>è¡Œä¸º</strong>ï¼šçº¿ç¨‹ç­‰å¾…æ¡ä»¶å˜é‡æ—¶ä¼šé‡Šæ”¾äº’æ–¥é”ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³æ—¶è¢«é€šçŸ¥ã€‚</li>
<li><strong>ç¤ºä¾‹ç”¨æ³•</strong>ï¼šçº¿ç¨‹ç­‰å¾…æŸä¸ªèµ„æºå‡†å¤‡å¥½ï¼Œæˆ–è€…ç­‰å¾…æŸä¸ªçŠ¶æ€å˜æ›´ï¼Œä¾‹å¦‚ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ä¸­çš„æ¡ä»¶ç­‰å¾…ã€‚</li>
</ul>
<blockquote>
<p><code>pthread_cond_wait(&amp;cond, &amp;mutex)</code>ï¼š</p>
<ul>
<li>è¯¥å‡½æ•°ä¼šä½¿å½“å‰çº¿ç¨‹è¿›å…¥
<strong>é˜»å¡çŠ¶æ€</strong>ï¼Œå¹¶ä¸”<strong>è‡ªåŠ¨é‡Šæ”¾</strong>ä¼ å…¥çš„
<code>mutex</code>ï¼Œç›´åˆ°æ»¡è¶³æ¡ä»¶å¹¶ä¸” <code>pthread_cond_signal()</code>
æˆ– <code>pthread_cond_broadcast()</code>
è¢«è°ƒç”¨æ—¶ï¼Œæ‰ä¼šå”¤é†’è¯¥çº¿ç¨‹å¹¶é‡æ–°è·å–é”ã€‚</li>
</ul>
<p><code>pthread_cond_signal()</code>ï¼š</p>
<ul>
<li>è¯¥å‡½æ•° <strong>ä¸ä¼š</strong> é‡Šæ”¾ <code>mutex</code>ã€‚å®ƒçš„ä½œç”¨æ˜¯é€šçŸ¥
<strong>è‡³å°‘ä¸€ä¸ª</strong> ç­‰å¾…è¯¥æ¡ä»¶å˜é‡çš„çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚</li>
</ul>
</blockquote>
<h2 id="çº¿ç¨‹æ± ">çº¿ç¨‹æ± </h2>
<h3 id="pthread_create"><code>pthread_create()</code></h3>
<p>çˆ¶çº¿ç¨‹è°ƒç”¨ <code>pthread_create()</code>
æ¥åˆ›å»ºå­çº¿ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œçˆ¶çº¿ç¨‹æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆé€šå¸¸ç§°ä¸ºçº¿ç¨‹å‡½æ•°ï¼‰ï¼Œè¯¥å›è°ƒå‡½æ•°å®šä¹‰äº†å­çº¿ç¨‹çš„è¡Œä¸ºã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">pthread_create</span><span class="params">(<span class="type">pthread_t</span> *thread, <span class="type">const</span> <span class="type">pthread_attr_t</span> *attr, <span class="type">void</span> *(*start_routine)(<span class="type">void</span> *), <span class="type">void</span> *arg)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°ï¼š</p>
<ul>
<li><code>thread</code>:
çº¿ç¨‹æ ‡è¯†ç¬¦çš„æŒ‡é’ˆï¼Œå‡½æ•°æˆåŠŸåä¼šå¡«å……è¯¥å€¼ï¼Œè¡¨ç¤ºæ–°åˆ›å»ºçš„å­çº¿ç¨‹ã€‚</li>
<li><code>attr</code>: ç”¨äºçº¿ç¨‹å±æ€§çš„ç»“æ„ä½“ï¼Œé€šå¸¸å¯ä»¥ä¸º
<code>NULL</code>ï¼Œè¡¨ç¤ºä½¿ç”¨é»˜è®¤å±æ€§ã€‚</li>
<li><code>start_routine</code>: å­çº¿ç¨‹æ‰§è¡Œçš„å‡½æ•°ï¼ˆçº¿ç¨‹å‡½æ•°ï¼‰ã€‚</li>
<li><code>arg</code>: ä¼ é€’ç»™å­çº¿ç¨‹å‡½æ•°çš„å‚æ•°ã€‚</li>
</ul>
<h3 id="pthread_detach"><code>pthread_detach</code></h3>
<p><code>pthread_detach</code> æ˜¯ POSIX
çº¿ç¨‹åº“ï¼ˆ<code>pthread</code>ï¼‰ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äº<strong>åˆ†ç¦»çº¿ç¨‹</strong>ï¼Œä½¿å…¶åœ¨ç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾èµ„æºï¼Œè€Œä¸éœ€è¦
<code>pthread_join()</code> è¿›è¡Œå›æ”¶ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">pthread_detach</span><span class="params">(<span class="type">pthread_t</span> thread)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°ï¼š</p>
<ul>
<li><code>thread</code>ï¼šè¦åˆ†ç¦»çš„çº¿ç¨‹ IDï¼ˆ<code>pthread_t</code>
ç±»å‹ï¼‰ã€‚</li>
</ul>
<p>è¿”å›å€¼</p>
<ul>
<li><strong>æˆåŠŸ</strong>ï¼šè¿”å› <code>0</code>ã€‚</li>
<li>å¤±è´¥ï¼šè¿”å›é”™è¯¯ç ï¼ˆä¾‹å¦‚ EINVALæˆ– ESRCHï¼‰ã€‚
<ul>
<li><code>EINVAL</code>ï¼ˆInvalid
Argumentï¼‰ï¼šçº¿ç¨‹å·²ç»æ˜¯<strong>åˆ†ç¦»çŠ¶æ€</strong>ã€‚</li>
<li><code>ESRCH</code>ï¼ˆNo Such Processï¼‰ï¼šçº¿ç¨‹ ID
æ— æ•ˆï¼Œçº¿ç¨‹ä¸å­˜åœ¨ã€‚</li>
</ul></li>
</ul>
<blockquote>
<table>
<colgroup>
<col style="width: 16%">
<col style="width: 37%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th><strong>å‡½æ•°</strong></th>
<th><strong>ä½œç”¨</strong></th>
<th><strong>å›æ”¶èµ„æº</strong></th>
<th><strong>ä¸»çº¿ç¨‹ç­‰å¾…</strong></th>
<th><strong>é€‚ç”¨åœºæ™¯</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>pthread_detach</code></td>
<td>è®©çº¿ç¨‹<strong>è‡ªåŠ¨é‡Šæ”¾</strong>ï¼Œæ— éœ€ <code>join</code></td>
<td>âœ… æ˜¯</td>
<td>âŒ å¦</td>
<td>é•¿æœŸè¿è¡Œçš„å·¥ä½œçº¿ç¨‹</td>
</tr>
<tr class="even">
<td><code>pthread_join</code></td>
<td><strong>é˜»å¡</strong>ç­‰å¾…çº¿ç¨‹æ‰§è¡Œå®Œï¼Œå¹¶è·å–è¿”å›å€¼</td>
<td>âœ… æ˜¯</td>
<td>âœ… æ˜¯</td>
<td>éœ€è¦è·å–çº¿ç¨‹ç»“æœ</td>
</tr>
</tbody>
</table>
</blockquote>
<h2 id="å•ä¾‹æ¨¡å¼">å•ä¾‹æ¨¡å¼</h2>
<blockquote>
<ol type="1">
<li><p><strong>æ„é€ å‡½æ•°å¿…é¡»ç§æœ‰åŒ–</strong>ï¼ˆå¦åˆ™ä¸æ˜¯å•ä¾‹ï¼‰</p></li>
<li><p>ææ„å‡½æ•°æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š</p>
<ul>
<li>éœ€è¦é˜²æ­¢å¤–éƒ¨åˆ é™¤ â†’ ç§æœ‰åŒ– + è‡ªå®šä¹‰é”€æ¯é€»è¾‘ï¼ˆå¦‚ atexitï¼‰
<ul>
<li>ç¦æ­¢ç”¨æˆ·ç›´æ¥é”€æ¯å¯¹è±¡ï¼Œé€šå¸¸ç”¨äºå•ä¾‹æ¨¡å¼æˆ–å¯¹è±¡æ± ã€‚</li>
<li>æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œåªèƒ½é€šè¿‡ç‰¹å®šçš„æˆå‘˜å‡½æ•°é”€æ¯å¯¹è±¡ã€‚</li>
</ul></li>
<li>ä½¿ç”¨ Meyer's Singletonï¼ˆå±€éƒ¨é™æ€å˜é‡ï¼‰â†’ å¯å…¬å¼€ææ„</li>
</ul></li>
</ol>
</blockquote>
<h3 id="æ‡’æ±‰æ¨¡å¼">æ‡’æ±‰æ¨¡å¼</h3>
<p>å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶åˆ›å»º</p>
<ul>
<li>åœ¨ C++11
åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå±€éƒ¨é™æ€å˜é‡çš„åˆå§‹åŒ–æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥ç®€åŒ–å•ä¾‹æ¨¡å¼çš„å®ç°</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">single</span> {</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">single</span>() {}</span><br><span class="line">    ~<span class="built_in">single</span>() {}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> single&amp; <span class="title">getinstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="type">static</span> single instance;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="é¥¿æ±‰æ¨¡å¼">é¥¿æ±‰æ¨¡å¼</h3>
<p>å®ä¾‹åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»º</p>
<ul>
<li>åˆ©ç”¨å±€éƒ¨é™æ€å˜é‡çš„ç‰¹æ€§å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼ã€‚</li>
<li>C++11 åŠä»¥ä¸Šç‰ˆæœ¬ä¿è¯å±€éƒ¨é™æ€å˜é‡çš„åˆå§‹åŒ–æ˜¯çº¿ç¨‹å®‰å…¨çš„</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">static</span> Singleton* <span class="title">getInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">Singleton</span>() {}  <span class="comment">// ç§æœ‰æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">Singleton</span>(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;  <span class="comment">// ç¦æ­¢æ‹·è´æ„é€ </span></span><br><span class="line">    Singleton&amp; <span class="keyword">operator</span>=(<span class="type">const</span> Singleton&amp;) = <span class="keyword">delete</span>;  <span class="comment">// ç¦æ­¢èµ‹å€¼æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">    <span class="type">static</span> Singleton* instance;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">Singleton* Singleton::instance = <span class="keyword">new</span> <span class="built_in">Singleton</span>();  <span class="comment">// é™æ€æˆå‘˜åˆå§‹åŒ–</span></span><br></pre></td></tr></tbody></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/24/VSCode%20%E5%8A%A0%E8%BD%BD%20.vscode%20%E8%A7%84%E5%88%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/24/VSCode%20%E5%8A%A0%E8%BD%BD%20.vscode%20%E8%A7%84%E5%88%99/" class="post-title-link" itemprop="url">VSCodeåŠ è½½`.vscode`çš„è§„åˆ™</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-03-24 23:22:06" itemprop="dateCreated datePublished" datetime="2025-03-24T23:22:06+08:00">2025-03-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-05-15 21:23:48" itemprop="dateModified" datetime="2025-05-15T21:23:48+08:00">2025-05-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/VSCode/" itemprop="url" rel="index"><span itemprop="name">VSCode</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>622</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä¸‹é¢æ˜¯æˆ‘çš„æ–‡ä»¶ç»“æ„</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">D:\CodeFile\</span><br><span class="line">â”‚â”€â”€ .vscode\                 â† çˆ¶ç›®å½• `.vscode`</span><br><span class="line">â”‚   â”œâ”€â”€ settings.json        (å½±å“æ•´ä¸ª `CodeFile` åŠæ‰€æœ‰å­ç›®å½•)</span><br><span class="line">â”‚   â”œâ”€â”€ tasks.json           (VSCode ä»»åŠ¡ç³»ç»Ÿä¼šä½¿ç”¨è¿™ä¸ª)</span><br><span class="line">â”‚   â”œâ”€â”€ launch.json          (VSCode è°ƒè¯•å™¨ä¼šä½¿ç”¨è¿™ä¸ª)</span><br><span class="line">â”‚</span><br><span class="line">â”œâ”€â”€ CPP\</span><br><span class="line">â”‚   â”œâ”€â”€ .vscode\             â† å­ç›®å½• `.vscode`ï¼ˆé»˜è®¤ä¸ä¼šç”Ÿæ•ˆï¼‰</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ settings.json    (ä¸ä¼šç”Ÿæ•ˆï¼Œé™¤é VSCode ç›´æ¥æ‰“å¼€ `CPP` ç›®å½•)</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ tasks.json       (ä¸ä¼šç”Ÿæ•ˆ)</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ launch.json      (ä¸ä¼šç”Ÿæ•ˆ)</span><br><span class="line">â”‚   â”œâ”€â”€ test.cpp</span><br><span class="line">â”‚   â””â”€â”€ ...</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>VSCode çš„ <code>settings.json</code> æ˜¯
<strong>åŸºäºå½“å‰æ‰“å¼€çš„â€œå·¥ä½œåŒºâ€</strong> æ¥ç”Ÿæ•ˆçš„ï¼š</p>
<ul>
<li><strong>å¦‚æœä½ æ‰“å¼€ <code>CodeFile</code> ç›®å½•</strong>ï¼š
<ul>
<li><code>CodeFile/.vscode/settings.json</code> ç”Ÿæ•ˆï¼ˆå½±å“
<code>CodeFile</code> ä¸‹æ‰€æœ‰å­æ–‡ä»¶å¤¹ï¼ŒåŒ…æ‹¬ <code>CPP</code>ï¼‰ã€‚</li>
<li>ä½ çš„ <code>"cpp"</code> è¿è¡Œé…ç½®ä¼šä½œç”¨äºæ•´ä¸ª <code>CodeFile</code>
ç›®å½•ã€‚</li>
<li><strong><code>$workspaceFolder</code> å˜ä¸º
<code>d:\CodeFile\</code></strong>ï¼ŒCode Runner è§£æ <code>$dir</code>
æ—¶å¯èƒ½ä¼šæœ‰è·¯å¾„é—®é¢˜ã€‚</li>
</ul></li>
<li><strong>å¦‚æœä½ åªæ‰“å¼€ <code>CPP</code> ç›®å½•</strong>ï¼š
<ul>
<li><code>CodeFile/.vscode/settings.json</code> ä¸ä¼šç”Ÿæ•ˆï¼ˆå› ä¸º
<code>.vscode</code> åœ¨ <code>CodeFile</code> ç›®å½•ä¸‹ï¼‰ã€‚</li>
<li>éœ€è¦ <code>CPP</code> ç›®å½•ä¸‹ä¹Ÿæœ‰ä¸€ä¸ª
<code>.vscode/settings.json</code> æ‰èƒ½å½±å“ <code>CPP</code> ç›®å½•ã€‚</li>
</ul></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/02/04/CS106L/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/02/04/CS106L/" class="post-title-link" itemprop="url">CS106L-24Autumn</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-02-04 00:00:00" itemprop="dateCreated datePublished" datetime="2025-02-04T00:00:00+08:00">2025-02-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-26 23:51:41" itemprop="dateModified" datetime="2025-07-26T23:51:41+08:00">2025-07-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CPP/" itemprop="url" rel="index"><span itemprop="name">CPP</span></a>
                </span>
                  ï¼Œ
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS106L/" itemprop="url" rel="index"><span itemprop="name">CS106L</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>20k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>19 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>è¯¾ç¨‹å®˜ç½‘ï¼šhttp://web.stanford.edu/class/cs106l/</p>
<p>Assignmentä»£ç ï¼šhttps://github.com/cs106l/cs106l-assignments/tree/main</p>
<h2 id="stdpair">std::pair</h2>
<p>æ˜¯ä¸€ç§ç±»æ¨¡æ¿ï¼Œå®ƒå°†<strong>ä¸¤ä¸ª</strong>å¼‚è´¨å¯¹è±¡ä½œä¸ºä¸€ä¸ªå•å…ƒå­˜å‚¨ï¼Œç”±å¤´æ–‡ä»¶<code>#include &lt;utility&gt;</code>å®šä¹‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åŸç†</span></span><br><span class="line"><span class="keyword">template</span>&lt;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">T1</span>,</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">T2</span></span><br><span class="line">&gt; <span class="keyword">struct</span> <span class="title class_">pair</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹</span></span><br><span class="line">std::pair&lt;std::string, <span class="type">int</span>&gt; dozen {<span class="string">"eggs"</span>, <span class="number">12</span>};</span><br></pre></td></tr></tbody></table></figure>
<h2 id="using">using</h2>
<p><code>using</code>å…³é”®å­—å¯ä»¥å®šä¹‰åˆ«åï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Zeros æ˜¯ std::pair&lt;double, double&gt; çš„ç®€åŒ–åç§°</span></span><br><span class="line"><span class="keyword">using</span> Zeros = std::pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt;; </span><br><span class="line"></span><br><span class="line"><span class="comment">// Solution æ˜¯ std::pair&lt;bool, Zeros&gt; çš„ç®€åŒ–åç§°</span></span><br><span class="line"><span class="keyword">using</span> Solution = std::pair&lt;<span class="type">bool</span>, Zeros&gt;;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="auto">auto</h2>
<p><code>auto</code>å…³é”®å­—è®©ç¼–è¯‘å™¨æ¨æ–­å˜é‡çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœªç®€åŒ–</span></span><br><span class="line">std::pair&lt;<span class="type">bool</span>, std::pair&lt;<span class="type">double</span>, <span class="type">double</span>&gt;&gt; result = <span class="built_in">solveQuadratic</span>(a, b, c);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨autoå…³é”®å­—</span></span><br><span class="line"><span class="keyword">auto</span> result = <span class="built_in">solveQuadratic</span>(a, b, c);</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ç»Ÿä¸€åˆå§‹åŒ–c11">ç»Ÿä¸€åˆå§‹åŒ–ï¼ˆC++11ï¼‰</h2>
<p>ä½¿ç”¨<code>=</code>æˆ–è€…<code>()</code>è¿›è¡Œåˆå§‹åŒ–ä¼šé»˜è®¤è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> numOne = <span class="number">12.0</span>; <span class="comment">// numOneæ˜¯12</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">numTwo</span><span class="params">(<span class="number">12.0</span>)</span></span>; <span class="comment">// numTwoä¹Ÿæ˜¯12</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>ç»Ÿä¸€åˆå§‹åŒ–</strong>ï¼ˆ<strong>Uniform
Initialization</strong>ï¼‰æ˜¯ C++11 å¼•å…¥çš„ä¸€ç§æ–°çš„åˆå§‹åŒ–è¯­æ³•ï¼Œæ—¨åœ¨æä¾›ä¸€ç§
<strong>ç»Ÿä¸€ä¸”æ›´å®‰å…¨</strong> çš„æ–¹å¼æ¥åˆå§‹åŒ–å˜é‡å’Œå¯¹è±¡ã€‚å®ƒé€šè¿‡
<strong>å¤§æ‹¬å· <code>{}</code></strong> å®ç°åˆå§‹åŒ–ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> numOne{<span class="number">12.0</span>}; <span class="comment">// ç¼–è¯‘æ—¶æŠ¥é”™ï¼Œä¸å…è®¸ç±»å‹ç¼©å°è½¬æ¢ï¼ˆdouble-&gt;intï¼‰</span></span><br><span class="line"><span class="type">float</span> numTwo{<span class="number">12.0</span>}; <span class="comment">// æ­£ç¡®</span></span><br></pre></td></tr></tbody></table></figure>
<p>é™¤äº†åŸºæœ¬ç±»å‹ï¼Œç»Ÿä¸€åˆå§‹åŒ–è¿˜å¯ç”¨äº<code>vector</code>ã€<code>map</code>ç­‰ä¸åŒå®¹å™¨</p>
<h2 id="ç»“æ„åŒ–ç»‘å®šc17">ç»“æ„åŒ–ç»‘å®šï¼ˆC++17ï¼‰</h2>
<p>ç»“æ„åŒ–ç»‘å®šæ˜¯C++17å¼•å…¥çš„ä¸€ç§æ–°ç‰¹æ€§ï¼Œç”¨äºå°†<strong>å…ƒç»„ï¼ˆ<code>std::tuple</code>ï¼‰</strong>ã€<strong>ç»“æ„ä½“</strong>æˆ–ç±»ä¼¼çš„å¯è§£æ„å¯¹è±¡åˆ†è§£ä¸ºå¤šä¸ªç‹¬ç«‹å˜é‡ã€‚å®ƒæä¾›äº†ä¸€ç§ç®€ä¾¿çš„æ–¹æ³•æ¥ç›´æ¥è§£æ„æ•°æ®ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::tuple&lt;std::string, std::string, std::string&gt; <span class="title">getClassInfo</span><span class="params">()</span> </span>{</span><br><span class="line">    std::string className = <span class="string">"CS106L"</span>;</span><br><span class="line">    std::string buildingName = <span class="string">"Thornton 110"</span>;</span><br><span class="line">    std::string language = <span class="string">"C++"</span>;</span><br><span class="line">    <span class="keyword">return</span> {className, buildingName, language}; <span class="comment">// è¿™é‡Œè¿”å›çš„æ˜¯tupleå¯¹è±¡</span></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">auto</span> [className, buildingName, language] = <span class="built_in">getClassInfo</span>(); <span class="comment">// æ³¨æ„è¿™ä¸€è¡Œ</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Come to "</span> &lt;&lt; buildingName &lt;&lt; <span class="string">" and join us for "</span> &lt;&lt; className</span><br><span class="line">              &lt;&lt; <span class="string">" to learn "</span> &lt;&lt; language &lt;&lt; <span class="string">"!"</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æˆ‘ç–‘æƒ‘çš„ç‚¹åœ¨äºï¼Œæ˜æ˜<code>getClassInfo()</code>è¿”å›å€¼æ˜¯tupleå¯¹è±¡ï¼Œä¸ºä»€ä¹ˆæœ€åå˜æˆäº†ä¸‰ä¸ªå¯¹è±¡ï¼Ÿå› ä¸ºç¬¬å…«è¡Œçš„<code>[ ]</code>
æ˜¯ç»“æ„åŒ–ç»‘å®šçš„æ ‡å‡†è¯­æ³•ï¼Œç”¨äº<strong>è§£æ„</strong>
<code>getClassInfo</code> è¿”å›çš„
<code>std::tuple</code>ï¼Œ<strong>å°†å…ƒç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ç»‘å®šåˆ°ç‹¬ç«‹å˜é‡ä¸­</strong>ã€‚</p>
<h3 id="å¼•ç”¨ä¸ç»“æ„åŒ–ç»‘å®š">å¼•ç”¨ä¸ç»“æ„åŒ–ç»‘å®š</h3>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">shift</span><span class="params">(std::vector&lt;std::pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt; &amp;nums)</span> </span>{</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> [num1, num2] : nums) { <span class="comment">// å€¼ç»‘å®šï¼šäº§ç”Ÿå‰¯æœ¬ï¼Œä¿®æ”¹ä¸å½±å“åŸå§‹æ•°æ®</span></span><br><span class="line">        num1++;</span><br><span class="line">        num2++;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è°ƒç”¨è¯¥å‡½æ•°æ˜¯æ— æ³•è¯¥æ”¹å˜<code>nums</code>çš„ï¼Œåº”è¯¥åœ¨<code>auto</code>åé¢æ·»åŠ <code>&amp;</code>ç¬¦å·</p>
<h2 id="å·¦å€¼å’Œå³å€¼">å·¦å€¼å’Œå³å€¼</h2>
<h3 id="å·¦å€¼-l-value">å·¦å€¼ l-value</h3>
<p>å·¦å€¼å¯ä»¥æ”¾ç½®åœ¨<code>=</code>ç¬¦å·çš„å·¦è¾¹æˆ–è€…å³è¾¹</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// x æ˜¯å·¦å€¼ï¼Œä¸‹é¢ä¸¤ä¸ªå¼å­å‡æˆç«‹</span></span><br><span class="line"><span class="type">int</span> y = x;</span><br><span class="line">x = <span class="number">344</span>;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="å³å€¼-r-value">å³å€¼ r-value</h3>
<p>å³å€¼åªèƒ½æ”¾ç½®åœ¨<code>=</code>ç¬¦å·çš„å³è¾¹</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 21 æ˜¯å³å€¼</span></span><br><span class="line"><span class="type">int</span> y = <span class="number">21</span>; <span class="comment">// æ­£ç¡®</span></span><br><span class="line"></span><br><span class="line"><span class="number">21</span> = y; <span class="comment">// é”™è¯¯</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ³¨æ„</strong>ï¼šå½“å‡½æ•°çš„å‚æ•°å£°æ˜ä¸ºå¼•ç”¨æ—¶ï¼Œåˆ™ä¸èƒ½åœ¨è°ƒç”¨æ—¶ä½¿ç”¨å³å€¼ä½œä¸ºå‚æ•°</p>
<h2 id="stream">stream</h2>
<h3 id="stdcout">std::cout</h3>
<p>è¾“å‡ºæµåœ¨ä¸­çš„å­—ç¬¦åœ¨è¢«åˆ·æ–°åˆ°ç›®æ ‡ï¼ˆç»ˆç«¯ï¼‰ä¹‹å‰å­˜å‚¨åœ¨ä¸­é—´ç¼“å†²åŒºä¸­</p>
<h3 id="stdstringstream">std::stringstream</h3>
<p>å­—ç¬¦ä¸²æµï¼Œç”¨äºå¤„ç†ï¼ˆä¾‹å¦‚ï¼šåˆ†å‰²ï¼‰å­—ç¬¦ä¸²ã€‚ ç¤ºä¾‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// partial Bjarne Quote</span></span><br><span class="line">    std::string initial_quote = â€œBjarne Stroustrup C makes it easy to shoot yourself in the foot\n<span class="string">"</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // create a stringstream</span></span><br><span class="line"><span class="string">    std::stringstream ss(initial_quote); // åˆå§‹åŒ–å­—ç¬¦ä¸²æµï¼Œå¯ä»¥ç”¨ä¸‹é¢ä¸¤è¡Œä»£æ›¿</span></span><br><span class="line"><span class="string">    /*</span></span><br><span class="line"><span class="string">    std::stringstream ss;</span></span><br><span class="line"><span class="string">	ss &lt;&lt; initial_quote;</span></span><br><span class="line"><span class="string">    */</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // data destinations</span></span><br><span class="line"><span class="string">    std::string first;</span></span><br><span class="line"><span class="string">    std::string last;</span></span><br><span class="line"><span class="string">    std::string language, extracted_quote;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // &gt;&gt;è¿ç®—ç¬¦åªè¯»å–åˆ°ä¸‹ä¸€ä¸ªwhitespace(ç©ºæ ¼ï¼Œ\nï¼Œ\t)</span></span><br><span class="line"><span class="string">    ss &gt;&gt; first &gt;&gt; last &gt;&gt; language;</span></span><br><span class="line"><span class="string">    // è¦è®©extracted_quoteç­‰äº"</span>makes it easy to shoot yourself in the foot<span class="string">"éœ€è¦ä½¿ç”¨getline()</span></span><br><span class="line"><span class="string">    std::getline(ss, extracted_quote);</span></span><br><span class="line"><span class="string">    std::cout &lt;&lt; first &lt;&lt; â€œ â€ &lt;&lt; last &lt;&lt; â€œ said this: â€&lt;&lt; language &lt;&lt; â€œ â€œ &lt;&lt; </span></span><br><span class="line"><span class="string">    extracted_quote &lt;&lt; std::endl;</span></span><br><span class="line"><span class="string">}</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">istream&amp; <span class="title">getline</span><span class="params">(istream&amp; is, string&amp; str, <span class="type">char</span> delim)</span></span></span><br></pre></td></tr></tbody></table></figure>
<p>è¯»å–è¾“å…¥æµ<code>is</code>ï¼Œç›´åˆ°<code>delim</code>å­—ç¬¦ï¼ˆé»˜è®¤æ˜¯<code>\n</code>ï¼‰ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨æŸä¸ªç¼“å†²åŒºï¼ˆå˜é‡ï¼‰<code>str</code>ä¸­</p>
</blockquote>
<h3 id="stdflush">std::flush</h3>
<p>ç”¨äºåˆ·æ–°<code>stream</code>æµï¼Œå°†ç¼“å†²åŒºä¸­çš„æ•°æ®<strong>ç«‹å³</strong>å‘é€åˆ°æ§åˆ¶å°ï¼ˆç»ˆç«¯ï¼‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Long operation in progress: "</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; ++i) {</span><br><span class="line">        std::this_thread::<span class="built_in">sleep_for</span>(std::chrono::<span class="built_in">seconds</span>(<span class="number">1</span>));</span><br><span class="line">        std::cout &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="string">", "</span> &lt;&lt; std::flush;</span><br><span class="line">    }</span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Operation completed!"</span> &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// æ¯éš”ä¸€ç§’è¾“å‡ºä¸€ä¸ªæ•°å­—</span></span><br></pre></td></tr></tbody></table></figure>
<p>è‹¥ä¸Šè¿°ä»£ç ä¸åŠ <code>std::flush</code>ï¼Œé‚£ä¹ˆè¾“å‡ºä¼šåœ¨äº”ç§’åå…¨éƒ¨<strong>ä¸€æ¬¡æ€§æ˜¾ç¤º</strong>ã€‚</p>
<p><code>std::cout</code>é€šå¸¸æ˜¯è¡Œç¼“å†²çš„ï¼Œæ‰€ä»¥<code>std::endl</code>ä¹Ÿä¼šä½¿å¾—<code>stream</code>è¿›è¡Œåˆ·æ–°ï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šè¾“å‡ºä¸€ä¸ªæ•°å­—ï¼Œä½†æ˜¯è¿™ç§è¡Œä¸ºä½¿å¾—è¿è¡Œæ•ˆç‡ä½ä¸‹ï¼Œæ‰€ä»¥å¯ä»¥å°†<code>std::endl</code>æ¢æˆ<code>\n</code>ï¼Œè¿™æ ·å½“ç¼“å†²åŒºæ»¡æˆ–è€…å¾ªç¯ç»“æŸæ—¶æ‰ä¼šä¸€æ¬¡æ€§è¾“å‡ºï¼ˆæ³¨æ„è¦æå‰å£°æ˜<code>std::ios::sync_with_stdio(false);</code>ï¼‰ã€‚</p>
<h3 id="stdofstream">std::ofstream</h3>
<p>Output File Streamï¼Œå°†æ•°æ®å†™å…¥æ–‡ä»¶ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line"><span class="comment">/// associating file on construction</span></span><br><span class="line">	<span class="function">std::ofstream <span class="title">ofs</span><span class="params">(â€œhello.txtâ€)</span></span>; <span class="comment">// ç­‰ä»·äºä¸‹é¢ä¸¤è¡Œ</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    std::ofstream ofs; </span></span><br><span class="line"><span class="comment">    ofs.open(â€œhello.txtâ€);</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">	<span class="keyword">if</span> (ofs.<span class="built_in">is_open</span>()) {  <span class="comment">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å·²æ‰“å¼€ï¼Œå¦‚æœå·²æ‰“å¼€ï¼Œåˆ™å°è¯•å‘å…¶å†™å…¥å­—ç¬¦ä¸² </span></span><br><span class="line">		ofs &lt;&lt; â€œHello CS106L!â€ &lt;&lt; â€˜\nâ€™; </span><br><span class="line">	}</span><br><span class="line">	ofs.<span class="built_in">close</span>();</span><br><span class="line">	ofs &lt;&lt; â€œ<span class="keyword">this</span> will <span class="keyword">not</span> get writtenâ€; <span class="comment">// ç”±äºæ–‡ä»¶æµå·²å…³é—­ï¼Œä¼šå¯¼è‡´å†™å…¥å¤±è´¥</span></span><br><span class="line">    </span><br><span class="line">	ofs.<span class="built_in">open</span>(â€œhello.txtâ€);</span><br><span class="line">	ofs &lt;&lt; â€œ<span class="keyword">this</span> will though! Itâ€™s open againâ€;  <span class="comment">// å†™å…¥æˆåŠŸ</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="stdcin">std::cin</h3>
<p><code>std::cin</code>ä¹Ÿä¼šå…ˆæŠŠå­—ç¬¦å­˜å…¥ç¼“å†²åŒºï¼Œç„¶åä»ç¼“å†²åŒºä¸­è¯»å–å†…å®¹ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::cin &gt;&gt; a;  <span class="comment">// è¾“å…¥å­—ç¬¦ï¼Œå­˜å…¥ç¼“å†²åŒºï¼Œç„¶åä»ç¼“å†²åŒºè¯»å–å­—ç¬¦åˆ°å˜é‡a</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>std::cin</code>é‡åˆ°whitespaceåˆ™ä¼šåœæ­¢å­˜å…¥ç¼“å†²åŒº</p>
<p>Whitespace in C++ includes:</p>
<ul>
<li>â€œ â€ â€“ a literal spaceï¼ˆç©ºæ ¼ï¼‰</li>
<li><code>\n</code> character</li>
<li><code>\t</code> character</li>
</ul>
<h2 id="stl">STL</h2>
<p>Standard Template Library</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250105162916455.png" alt="image-20250105162916455">
<figcaption aria-hidden="true">image-20250105162916455</figcaption>
</figure>
<h3 id="sequence-containers">Sequence Containers</h3>
<p>å­˜æ”¾çº¿æ€§åºåˆ—</p>
<h4 id="stdvector">std::vector</h4>
<p>ä½¿ç”¨ range-based for (é€‚ç”¨äºæ‰€æœ‰å¯è¿­ä»£å®¹å™¨)éå† vector</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> elem : vec) {  <span class="comment">// for (const auto&amp; elem : v) å¯ä»¥èŠ‚çœå‰¯æœ¬çš„å¼€é”€</span></span><br><span class="line">	std::cout &lt;&lt; elem &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>push_back()</code>ï¼š ä¼šå¯¼è‡´å®¹å™¨å¤§å° <code>size()</code>
å¢åŠ ï¼ŒåŒæ—¶å¦‚æœæ²¡æœ‰è¶³å¤Ÿç©ºé—´ï¼Œå®¹é‡ <code>capacity()</code> ä¹Ÿéšç€å¢åŠ </li>
<li><code>pop_back()</code>
ï¼šç§»é™¤å®¹å™¨ä¸­æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†å®¹å™¨çš„<code>size()</code>å‡å°ï¼Œ<strong>å®¹é‡</strong>
(<code>capacity()</code>) ä¿æŒä¸å˜ã€‚</li>
</ul>
<h4 id="stddeque">std::deque</h4>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250107220918767.png" alt="image-20250107220918767">
<figcaption aria-hidden="true">image-20250107220918767</figcaption>
</figure>
<p><code>std::deque</code> çš„åº•å±‚å®ç°ç»“åˆäº† <strong>åˆ†æ®µå†…å­˜</strong> å’Œ
<strong>æŒ‡é’ˆæ•°ç»„</strong> çš„è®¾è®¡ï¼š</p>
<ol type="1">
<li><strong>åˆ†æ®µå­˜å‚¨</strong>ï¼š
<ul>
<li>ä¸ <code>std::vector</code> ä¸åŒï¼Œ<code>std::deque</code>
ä¸ä½¿ç”¨ä¸€å—è¿ç»­çš„å¤§å†…å­˜å—ï¼Œè€Œæ˜¯å°†æ•°æ®åˆ†ä¸ºå¤šä¸ªå›ºå®šå¤§å°çš„å†…å­˜å—ï¼ˆç§°ä¸ºç¼“å†²åŒºæˆ–
blockï¼‰ã€‚</li>
<li>æ¯ä¸ªç¼“å†²åŒºçš„å¤§å°é€šå¸¸æ˜¯å›ºå®šçš„ï¼ˆå…·ä½“å¤§å°ä¾èµ–äºå®ç°ï¼Œé€šå¸¸ä¸º 512
å­—èŠ‚æˆ–æ›´å¤šï¼‰ã€‚</li>
</ul></li>
<li><strong>æŒ‡é’ˆæ•°ç»„ï¼ˆMap Arrayï¼‰</strong>ï¼š
<ul>
<li><code>std::deque</code> ä½¿ç”¨ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼ˆç§°ä¸º map
æˆ–æ§åˆ¶å—ï¼‰æ¥ç®¡ç†è¿™äº›ç¼“å†²åŒºã€‚</li>
<li>è¿™ä¸ªæŒ‡é’ˆæ•°ç»„å­˜å‚¨äº†æ¯ä¸ªç¼“å†²åŒºçš„èµ·å§‹åœ°å€ï¼Œå¹¶è´Ÿè´£å®šä½å®é™…æ•°æ®çš„ä½ç½®ã€‚</li>
</ul></li>
</ol>
<h4 id="stdlist">std::list</h4>
<p><code>std::list</code> æ˜¯ C++ æ ‡å‡†åº“ä¸­çš„åŒå‘é“¾è¡¨ï¼ˆDoubly Linked
Listï¼‰å®¹å™¨ï¼Œå®šä¹‰åœ¨ <code>&lt;list&gt;</code> å¤´æ–‡ä»¶ä¸­ã€‚ä¸
<code>std::vector</code> ä¸åŒï¼Œ<code>std::list</code>
å…è®¸é«˜æ•ˆåœ°åœ¨åºåˆ—çš„ä»»æ„ä½ç½®è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œä½†ä¸æ”¯æŒéšæœºè®¿é—®ã€‚</p>
<ul>
<li><strong>åŒå‘é“¾è¡¨ç»“æ„</strong>ï¼šæ¯ä¸ªå…ƒç´ éƒ½æœ‰å‰é©±å’Œåç»§æŒ‡é’ˆã€‚</li>
<li><strong>åŠ¨æ€å¤§å°</strong>ï¼šä¸éœ€è¦é¢„åˆ†é…å†…å­˜ï¼Œé€‚ç”¨äºé¢‘ç¹çš„æ’å…¥/åˆ é™¤æ“ä½œã€‚</li>
<li><strong>é«˜æ•ˆçš„æ’å…¥/åˆ é™¤</strong>ï¼š<code>O(1)</code>
å¤æ‚åº¦ï¼Œä¸æ¶‰åŠå¤§è§„æ¨¡å…ƒç´ ç§»åŠ¨ã€‚</li>
<li><strong>ä¸æ”¯æŒéšæœºè®¿é—®</strong>ï¼šä¸èƒ½é€šè¿‡ <code>operator[]</code>
è®¿é—®å…ƒç´ ï¼Œå¿…é¡»ä½¿ç”¨è¿­ä»£å™¨ã€‚</li>
</ul>
<h3 id="associative-containers">Associative Containers</h3>
<p>é€šè¿‡ key æ¥ç»„ç»‡å…ƒç´ </p>
<h4 id="stdmap">std::map</h4>
<ul>
<li><p>ç­‰ä»·äºpythonä¸­çš„å­—å…¸</p></li>
<li><p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">std::map&lt;std::string, <span class="type">int</span>&gt; map {</span><br><span class="line">  { <span class="string">"Chris"</span>, <span class="number">2</span> },</span><br><span class="line">  { <span class="string">"CS106L"</span>, <span class="number">42</span> },</span><br><span class="line">  { <span class="string">"Keith"</span>, <span class="number">14</span> },</span><br><span class="line">  { <span class="string">"Nick"</span>, <span class="number">51</span> },</span><br><span class="line">  { <span class="string">"Sean"</span>, <span class="number">35</span> },</span><br><span class="line">};</span><br><span class="line"><span class="type">int</span> sean = map[<span class="string">"Sean"</span>]; <span class="comment">// 35</span></span><br><span class="line">map[<span class="string">"Chris"</span>] = <span class="number">31</span>;</span><br></pre></td></tr></tbody></table></figure></li>
<li><p><code>std::map</code> ä¸­ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª <code>std::pair</code>
å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å« <code>first</code> å’Œ <code>second</code>
ä¸¤ä¸ªæˆå‘˜ã€‚<code>first</code> æ˜¯é”®ï¼ˆkeyï¼‰ï¼Œ<code>second</code>
æ˜¯å€¼ï¼ˆvalueï¼‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">std::map&lt;std::string, <span class="type">int</span>&gt; map;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> kv : map) {</span><br><span class="line">  <span class="comment">// kv is a std::pair&lt;const std::string, int&gt;</span></span><br><span class="line">  std::string key = kv.first;</span><br><span class="line">  <span class="type">int</span> value = kv.second;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥é€šè¿‡ç»“æ„åŒ–ç»‘å®šéå†map</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; [key, value] : map) {</span><br><span class="line">  <span class="comment">// key has type const std::string&amp;</span></span><br><span class="line">  <span class="comment">// value has type const int&amp;</span></span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>åº•å±‚æ˜¯é€šè¿‡ <strong>çº¢é»‘æ ‘</strong>ï¼ˆRed-Black
Treeï¼‰æ¥å®ç°çš„ã€‚å› æ­¤<code>std::map&lt;K, V&gt;</code>è¦æ±‚<code>K</code>èƒ½å¤Ÿè¿›è¡Œ<code>operator&lt;</code>æ“ä½œï¼ˆæ¯”å¤§å°ï¼Œåˆ¤æ–­è¿›å…¥çº¢é»‘æ ‘çš„å·¦å³å“ªä¸ªåˆ†æ”¯ï¼‰</p></li>
</ul>
<h4 id="stdunordered_map">std::unordered_map</h4>
<ul>
<li><p>ä¸ <code>std::map</code> ä¸åŒï¼Œ<code>std::unordered_map</code>
æ˜¯åŸºäº <strong>å“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰</strong> å®ç°çš„ã€‚</p></li>
<li><p>è·å–è´Ÿè½½å› å­ï¼Œè®¾ç½®æœ€å¤§è´Ÿè½½å› å­ï¼Œè‹¥è¶…è¿‡åˆ™é‡æ–°å“ˆå¸Œ</p>
<p>è´Ÿè½½å› å­ = å…ƒç´ ä¸ªæ•°ï¼ˆsizeï¼‰/ æ¡¶çš„æ•°é‡ï¼ˆbucket countï¼‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">std::unordered_map&lt;std::string, <span class="type">int</span>&gt; map;</span><br><span class="line"><span class="type">double</span> lf = map.<span class="built_in">load_factor</span>(); <span class="comment">// Get current load factor</span></span><br><span class="line">map.<span class="built_in">max_load_factor</span>(<span class="number">2.0</span>); <span class="comment">// Set the max load factor</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h4 id="stdset">std::set</h4>
<ul>
<li>é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å”¯ä¸€çš„</li>
<li><code>std::set</code> çš„å®ç°é€šå¸¸ä¹Ÿæ˜¯åŸºäº
<strong>çº¢é»‘æ ‘</strong></li>
</ul>
<h4 id="stdunordered_set">std::unordered_set</h4>
<ul>
<li><code>std::unordered_set</code> æ˜¯åŸºäº <strong>å“ˆå¸Œè¡¨ï¼ˆHash
Tableï¼‰</strong> å®ç°çš„</li>
<li>å¦‚æœä½ ä¸éœ€è¦æ’åºï¼Œå¹¶ä¸”å¸Œæœ›å®ç°å¿«é€Ÿçš„æŸ¥æ‰¾å’Œæ’å…¥æ“ä½œï¼Œ<code>std::unordered_map</code>
æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚</li>
</ul>
<h3 id="iterator">Iterator</h3>
<p>track where we are in a containerï¼ˆç±»ä¼¼äºç´¢å¼•ï¼‰</p>
<ul>
<li><p><code>container.begin()</code>æŒ‡å‘å®¹å™¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </p></li>
<li><p><code>container.end()</code>æŒ‡å‘å®¹å™¨æœ«ç«¯ï¼ˆä½†ä¸æŒ‡å‘æœ«å°¾å…ƒç´ ï¼‰</p></li>
<li><p>å½“å®¹å™¨ä¸ºç©ºæ—¶ï¼Œ<code>container.begin() == container.end()</code></p></li>
<li><p>éå†å®¹å™¨</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸‹é¢ä¸¤æ®µä»£ç æ˜¯ç­‰ä»·çš„</span></span><br><span class="line"><span class="keyword">auto</span> b = s.<span class="built_in">begin</span>();</span><br><span class="line"><span class="keyword">auto</span> e = s.<span class="built_in">end</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = b; it != e; ++it)  <span class="comment">// è¿™é‡Œä½¿ç”¨ ++it å¯ä»¥å‡å°‘ä¸€æ¬¡ä¸å¿…è¦çš„æ‹·è´</span></span><br><span class="line">{</span><br><span class="line">     <span class="keyword">auto</span> elem = *it;</span><br><span class="line">     std::cout &lt;&lt; elem;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// range-based for </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> elem : s) </span><br><span class="line">{</span><br><span class="line">	std::cout &lt;&lt; elem;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h2 id="ç»§æ‰¿inheritance">ç»§æ‰¿ï¼ˆInheritanceï¼‰</h2>
<p>å¤šæ€æ€§</p>
<h3 id="çº¯è™šå‡½æ•°">çº¯è™šå‡½æ•°</h3>
<p>åŠ¨æ€å¤šæ€ï¼Œå®ƒåœ¨åŸºç±»ä¸­è¢«å®ä¾‹åŒ–ï¼Œä½†åœ¨å­ç±»ä¸­è¢«è¦†ç›–</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Shape</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">double</span> <span class="title">area</span><span class="params">()</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h3 id="è™šå‡½æ•°">è™šå‡½æ•°</h3>
<p>https://hxt616.github.io/2024/10/26/CS106B/</p>
<h3 id="è™šåŸºç±»">è™šåŸºç±»</h3>
<p>è§£å†³è±å½¢ç»§æ‰¿é—®é¢˜ï¼Œè¯¦è§<a target="_blank" rel="noopener" href="https://hxt616.github.io/2024/10/26/CS106B/">CS106B</a></p>
<h2 id="æ¨¡æ¿ç±»template-classes">æ¨¡æ¿ç±»ï¼ˆTemplate Classesï¼‰</h2>
<p>æ¨¡æ¿çš„å£°æ˜å’Œå®ç°ä¸€èˆ¬åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// 'typename' å¯æ›¿æ¢æˆ 'class'</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vector</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"> <span class="function">T&amp; <span class="title">at</span><span class="params">(<span class="type">size_t</span> i)</span></span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="comment">// åœ¨ç±»å¤–å®šä¹‰å‡½æ•°éœ€è¦è¿›è¡Œæ¨¡æ¿å£°æ˜</span></span><br><span class="line">T&amp; Vector&lt;T&gt;::<span class="built_in">at</span>(<span class="type">size_t</span> i) { <span class="comment">// æ³¨æ„è¿™é‡Œç±»ååé¢è¦æ·»åŠ  &lt;T&gt;</span></span><br><span class="line"> <span class="comment">// Implementation...</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="const">const</h2>
<p><code>const</code>
å¯ä»¥åŠ åœ¨å‡½æ•°å£°æ˜çš„å‰é¢æˆ–è€…åé¢ï¼Œè¿™ä¸¤ç§ç”¨æ³•çš„å«ä¹‰æ˜¯ä¸åŒçš„ã€‚ä¸»è¦æœ‰ä¸¤ç§å¸¸è§çš„æƒ…å†µï¼š</p>
<h3 id="const-åŠ åœ¨å‡½æ•°è¿”å›ç±»å‹å‰é¢"><code>const</code>
åŠ åœ¨å‡½æ•°è¿”å›ç±»å‹å‰é¢</h3>
<p>è¿™æ˜¯æŒ‡ <strong>è¿”å›å€¼æ˜¯ <code>const</code>
ç±»å‹</strong>ï¼Œæ„å‘³ç€è¯¥è¿”å›å€¼æ˜¯ä¸å¯ä¿®æ”¹çš„ã€‚</p>
<h4 id="ç¤ºä¾‹">ç¤ºä¾‹ï¼š</h4>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">const</span> <span class="type">int</span> <span class="title">getValue</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="number">42</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>const</code> åŠ åœ¨ <code>int</code>
å‰é¢ï¼Œè¡¨ç¤ºå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª <code>const int</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿”å›çš„å€¼æ˜¯
<code>const</code> ç±»å‹ï¼Œè°ƒç”¨è€…ä¸èƒ½ä¿®æ”¹å®ƒã€‚</li>
<li>æ³¨æ„ï¼šè¿™ç§ <code>const</code>
ä¿®é¥°ç¬¦é€‚ç”¨äºè¿”å›å€¼çš„ç±»å‹ï¼Œå¹¶ä¸å½±å“å‡½æ•°æœ¬èº«çš„è¡Œä¸ºã€‚</li>
</ul>
<h4 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>å½“å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœè¿”å›çš„å¯¹è±¡ä¸å¸Œæœ›è¢«ä¿®æ”¹ï¼Œå¯ä»¥åŠ ä¸Š
<code>const</code>ã€‚</li>
<li>ä¾‹å¦‚ï¼Œåœ¨è¿”å›ä¸€ä¸ªæŒ‡é’ˆã€å¼•ç”¨æˆ–å¸¸é‡æ—¶ï¼Œ<code>const</code>
ä¼šç¡®ä¿è¿”å›çš„å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ã€‚</li>
</ul>
<h3 id="const-åŠ åœ¨æˆå‘˜å‡½æ•°çš„åé¢"><code>const</code>
åŠ åœ¨æˆå‘˜å‡½æ•°çš„åé¢</h3>
<p>è¿™æ˜¯æŒ‡ <strong>æˆå‘˜å‡½æ•°æ˜¯ <code>const</code>
æˆå‘˜å‡½æ•°</strong>ï¼Œæ„å‘³ç€è¯¥å‡½æ•°ä¸èƒ½ä¿®æ”¹ç±»çš„æˆå‘˜å˜é‡ã€‚</p>
<h4 id="ç¤ºä¾‹-1">ç¤ºä¾‹ï¼š</h4>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">MyClass</span>(<span class="type">int</span> v) : <span class="built_in">value</span>(v) {}</span><br><span class="line"></span><br><span class="line">    <span class="comment">// constæˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="type">const</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é const æˆå‘˜å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setValue</span><span class="params">(<span class="type">int</span> v)</span> </span>{</span><br><span class="line">        value = v;</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>getValue()</code> åé¢çš„ <code>const</code>
è¡¨ç¤ºè¯¥æˆå‘˜å‡½æ•°æ˜¯ <strong><code>const</code>
æˆå‘˜å‡½æ•°</strong>ï¼Œå³å®ƒä¸ä¼šä¿®æ”¹ç±»çš„ä»»ä½•æˆå‘˜å˜é‡ï¼ˆå³ <code>this</code>
æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼‰ã€‚</li>
</ul>
<h4 id="å…³é”®ç‚¹">å…³é”®ç‚¹ï¼š</h4>
<ul>
<li><code>const</code> åŠ åœ¨æˆå‘˜å‡½æ•°çš„åé¢æ˜¯ä¸ºäº†å£°æ˜è¿™ä¸ªæˆå‘˜å‡½æ•°æ˜¯
<strong>åªè¯»çš„</strong>ï¼Œå³å®ƒä¸ä¼šä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ã€‚</li>
<li>åœ¨ C++ ä¸­ï¼Œ<strong><code>const</code> æˆå‘˜å‡½æ•°åªèƒ½è°ƒç”¨å…¶ä»–
<code>const</code> æˆå‘˜å‡½æ•°</strong>ï¼Œä¸èƒ½ä¿®æ”¹æˆå‘˜å˜é‡ï¼Œä¸èƒ½è°ƒç”¨é
<code>const</code> æˆå‘˜å‡½æ•°ï¼Œä¹Ÿä¸èƒ½ä¿®æ”¹ <code>this</code>
æŒ‡é’ˆæŒ‡å‘çš„å¯¹è±¡ã€‚</li>
</ul>
<h4 id="ä½¿ç”¨åœºæ™¯-1">ä½¿ç”¨åœºæ™¯ï¼š</h4>
<ul>
<li>å½“ä½ å¸Œæœ›ä¿è¯æŸä¸ªæˆå‘˜å‡½æ•°ä¸ä¼šä¿®æ”¹ç±»çš„çŠ¶æ€æ—¶ï¼Œåº”è¯¥å°†å…¶å£°æ˜ä¸º
<code>const</code> æˆå‘˜å‡½æ•°ã€‚</li>
<li>ä¾‹å¦‚ï¼Œåœ¨æŸ¥è¯¢ç±»çŠ¶æ€çš„å‡½æ•°ï¼ˆå¦‚è·å–å€¼ã€å¤§å°ã€æ˜¯å¦ä¸ºç©ºç­‰ï¼‰ä¸­ï¼Œåº”è¯¥å°†å…¶å£°æ˜ä¸º
<code>const</code>ï¼Œä»¥ä¾¿å®ƒä»¬èƒ½å¤Ÿåœ¨ <code>const</code> å¯¹è±¡ä¸Šè°ƒç”¨ã€‚</li>
</ul>
<blockquote>
<p><strong>1. æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆ (Pointer to const)</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span>* ptr;  <span class="comment">// æˆ–ç­‰ä»·çš„ int const* ptr;</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>ä¸èƒ½ä¿®æ”¹æŒ‡å‘çš„å¯¹è±¡</strong>ï¼šä¸èƒ½é€šè¿‡è¿™ä¸ªæŒ‡é’ˆä¿®æ”¹å®ƒæŒ‡å‘çš„å€¼</li>
<li><strong>å¯ä»¥ä¿®æ”¹æŒ‡é’ˆæœ¬èº«</strong>ï¼šå¯ä»¥è®©æŒ‡é’ˆæŒ‡å‘å…¶ä»–åœ°å€</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> y = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* ptr = &amp;x;</span><br><span class="line">*ptr = <span class="number">30</span>;  <span class="comment">// é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹æŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line">ptr = &amp;y;   <span class="comment">// æ­£ç¡®ï¼šå¯ä»¥ä¿®æ”¹æŒ‡é’ˆæœ¬èº«</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>2. å¸¸é‡æŒ‡é’ˆ (Const pointer)</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>* <span class="type">const</span> ptr;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>ä¸èƒ½ä¿®æ”¹æŒ‡é’ˆæœ¬èº«</strong>ï¼šæŒ‡é’ˆä¸èƒ½æŒ‡å‘å…¶ä»–åœ°å€</li>
<li><strong>å¯ä»¥ä¿®æ”¹æŒ‡å‘çš„å¯¹è±¡</strong>ï¼šå¯ä»¥é€šè¿‡æŒ‡é’ˆä¿®æ”¹å®ƒæŒ‡å‘çš„å€¼</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> y = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span>* <span class="type">const</span> ptr = &amp;x;</span><br><span class="line">*ptr = <span class="number">30</span>;  <span class="comment">// æ­£ç¡®ï¼šå¯ä»¥ä¿®æ”¹æŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line">ptr = &amp;y;   <span class="comment">// é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹æŒ‡é’ˆæœ¬èº«</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>3. æŒ‡å‘å¸¸é‡çš„å¸¸é‡æŒ‡é’ˆ (Const pointer to const)</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span>* <span class="type">const</span> ptr;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>æ—¢ä¸èƒ½ä¿®æ”¹æŒ‡é’ˆæœ¬èº«</strong>ï¼šä¸èƒ½æŒ‡å‘å…¶ä»–åœ°å€</li>
<li><strong>ä¹Ÿä¸èƒ½ä¿®æ”¹æŒ‡å‘çš„å¯¹è±¡</strong>ï¼šä¸èƒ½é€šè¿‡æŒ‡é’ˆä¿®æ”¹å€¼</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> x = <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> y = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* <span class="type">const</span> ptr = &amp;x;</span><br><span class="line">*ptr = <span class="number">30</span>;  <span class="comment">// é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹æŒ‡å‘çš„å¯¹è±¡</span></span><br><span class="line">ptr = &amp;y;   <span class="comment">// é”™è¯¯ï¼šä¸èƒ½ä¿®æ”¹æŒ‡é’ˆæœ¬èº«</span></span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<h3 id="const_castä¸å¸¸ç”¨"><code>const_cast</code>ï¼ˆä¸å¸¸ç”¨ï¼‰</h3>
<p><code>const_cast</code> çš„å¸¸è§ç”¨æ³•ï¼š</p>
<ol type="1">
<li><p><strong>å»é™¤ <code>const</code> é™å®šç¬¦</strong>ï¼š é€šè¿‡
<code>const_cast</code>ï¼Œå¯ä»¥å°†æŒ‡å‘ <code>const</code>
å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨è½¬æ¢ä¸ºæŒ‡å‘é <code>const</code> å¯¹è±¡çš„æŒ‡é’ˆæˆ–å¼•ç”¨ã€‚</p>
<p>è¿™ç§æ“ä½œçš„å±é™©æ€§åœ¨äºï¼Œå¦‚æœä½ é€šè¿‡ <code>const_cast</code> å»é™¤
<code>const</code>
é™å®šç¬¦å¹¶å°è¯•ä¿®æ”¹å¯¹è±¡çš„å†…å®¹ï¼Œè€Œå¯¹è±¡æœ¬èº«ç¡®å®æ˜¯å¸¸é‡ï¼ˆä¾‹å¦‚ï¼Œå­˜å‚¨åœ¨
<code>const</code>
å†…å­˜åŒºåŸŸï¼‰ï¼Œè¿™å°†å¯¼è‡´æœªå®šä¹‰è¡Œä¸ºï¼ˆUBï¼‰ã€‚å› æ­¤ï¼Œ<strong>åªæœ‰åœ¨ä½ ç¡®å®šå¯¹è±¡å¯ä»¥å®‰å…¨ä¿®æ”¹æ—¶</strong>ï¼Œæ‰åº”è¯¥å»é™¤
<code>const</code>ã€‚</p></li>
</ol>
<h2 id="æ¨¡æ¿å‡½æ•°template-functions">æ¨¡æ¿å‡½æ•°ï¼ˆTemplate Functionsï¼‰</h2>
<ol type="1">
<li><p>ç¤ºä¾‹ï¼šå–ä¸¤ä¸ªå˜é‡çš„è¾ƒå°å€¼</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">min</span><span class="params">(T a, T b)</span> </span>{</span><br><span class="line">  <span class="keyword">return</span> a &lt; b ? a : b;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¾å¼å®ä¾‹åŒ–</span></span><br><span class="line"><span class="built_in">min</span>&lt;<span class="type">int</span>&gt;(<span class="number">7</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// éšå¼å®ä¾‹åŒ–ï¼Œè®©ç¼–è¯‘å™¨åˆ¤æ–­ç±»å‹</span></span><br><span class="line"><span class="built_in">min</span>(<span class="number">7</span>, <span class="number">10</span>);</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>å¯å˜å‚æ•°æ¨¡æ¿å‡½æ•°ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">min</span><span class="params">(T a)</span> </span>{ <span class="comment">// ä¸€å®šè¦åŠ ä¸Šï¼Œå› ä¸ºä¸‹é¢çš„æ¨¡æ¿æ˜¯é€’å½’æ¨¡æ¿ï¼Œéœ€è¦ä¸€ä¸ªç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">return</span> a;  <span class="comment">// åŸºæœ¬æƒ…å†µï¼šåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œè¿”å›è¯¥å…ƒç´ </span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="function">T <span class="title">min</span><span class="params">(T a, Args... args)</span> </span>{</span><br><span class="line">    T temp = <span class="built_in">min</span>(args...);  <span class="comment">// é€’å½’è°ƒç”¨ï¼šæ¯”è¾ƒå‰©ä¸‹çš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">return</span> a &lt; temp ? a : temp;  <span class="comment">// è¿”å›è¾ƒå°çš„å€¼</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><p><code>find</code>å‡½æ•°ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸åŒå®¹å™¨å¯¹åº”çš„è¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> It, <span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">It <span class="title">find</span><span class="params">(It begin, It end, <span class="type">const</span> T&amp; value)</span> </span>{</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it = begin; it != end; ++it) {</span><br><span class="line">    <span class="keyword">if</span> (*it == value) <span class="keyword">return</span> it;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> end;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¦ä¸€ç§å†™æ³•ï¼Œç›´æ¥å°†å®¹å™¨ä½œä¸ºå‚æ•°</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Container, <span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">find</span><span class="params">(<span class="type">const</span> Container&amp; c, <span class="type">const</span> T&amp; value)</span> </span>{</span><br><span class="line"> <span class="keyword">for</span> (<span class="keyword">auto</span> it = c.<span class="built_in">begin</span>(); it != c.<span class="built_in">end</span>(); ++it) {</span><br><span class="line">  <span class="keyword">if</span> (*it == value) <span class="keyword">return</span> it;</span><br><span class="line"> }</span><br><span class="line"> <span class="keyword">return</span> end;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h2 id="æ¨¡æ¿å…ƒç¼–ç¨‹template-metaprogramming">æ¨¡æ¿å…ƒç¼–ç¨‹ï¼ˆTemplate
Metaprogrammingï¼‰</h2>
<p>TMPï¼Œå®ƒå…è®¸ç¨‹åºåœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œå¤æ‚çš„è®¡ç®—å’Œç±»å‹æ¨å¯¼ï¼Œè€Œä¸éœ€è¦åœ¨è¿è¡Œæ—¶è¿›è¡Œå¤„ç†</p>
<ol type="1">
<li><p>ç¤ºä¾‹ï¼šé€šè¿‡æ¨¡æ¿é€’å½’è®¡ç®—é˜¶ä¹˜ï¼Œå¯ä»¥åœ¨<strong>ç¼–è¯‘æœŸ</strong>æ‰§è¡Œè®¡ç®—</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€’å½’æ¨¡æ¿è®¡ç®—é˜¶ä¹˜</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">int</span> N&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Factorial</span> {</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> value = N * Factorial&lt;N - <span class="number">1</span>&gt;::value;  <span class="comment">// é€’å½’è°ƒç”¨</span></span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸºæœ¬æƒ…å†µï¼šå½“ N ä¸º 0 æ—¶ï¼Œé˜¶ä¹˜ä¸º 1</span></span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Factorial</span>&lt;<span class="number">0</span>&gt; {</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">int</span> value = <span class="number">1</span>;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    std::cout &lt;&lt; Factorial&lt;<span class="number">5</span>&gt;::value &lt;&lt; std::endl;  <span class="comment">// è¾“å‡º: 120</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ <strong>predicates</strong>ï¼ˆè°“è¯ï¼‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> It, <span class="keyword">typename</span> Pred&gt;</span><br><span class="line"><span class="function">It <span class="title">find</span><span class="params">(It first, It last, Pred pred)</span> </span>{ <span class="comment">// è¿™é‡Œçš„predå…¶å®æ˜¯ä¸€ä¸ªè¿”å›å¸ƒå°”å€¼çš„å‡½æ•°</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> it = first; it != last; ++it) {</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">pred</span>(*it)) <span class="keyword">return</span> it;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> last;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h2 id="lambda">Lambda</h2>
<p>è¯¦è§
https://hxt616.github.io/2024/12/02/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/</p>
<h2 id="functor">Functor</h2>
<p><strong>functor</strong>ï¼ˆä»¿å‡½æ•°ï¼‰æ˜¯ä¸€ä¸ªè¡Œä¸ºç±»ä¼¼å‡½æ•°çš„å¯¹è±¡ï¼Œå…·ä½“æ¥è¯´æ˜¯
<strong>é‡è½½äº†å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦ <code>()</code>
çš„ç±»æˆ–ç»“æ„ä½“çš„å®ä¾‹</strong>ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç±»æˆ–ç»“æ„ä½“çš„å¯¹è±¡å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹ä¸€</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Functor</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> x)</span> <span class="type">const</span> </span>{</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Called with "</span> &lt;&lt; x &lt;&lt; std::endl;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹äºŒ</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">std</span>::greater {</span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; a, <span class="type">const</span> T&amp; b)</span> <span class="type">const</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> a &gt; b;</span><br><span class="line">  }</span><br><span class="line">};</span><br><span class="line">std::greater&lt;<span class="type">int</span>&gt; g;</span><br><span class="line"><span class="built_in">g</span>(<span class="number">1</span>, <span class="number">2</span>); <span class="comment">// è¿”å›å€¼æ˜¯false</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>å½“ä½¿ç”¨lambdaè¡¨è¾¾å¼æ—¶ï¼Œä¼šç”Ÿæˆå¯¹åº”çš„functor</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> lambda = [](<span class="type">int</span> x) { <span class="keyword">return</span> x * x; };</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼–è¯‘å™¨ä¼šç”Ÿæˆç±»ä¼¼ä»¥ä¸‹çš„ç±»ï¼š</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LambdaAnonymous</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">int</span> x)</span> <span class="type">const</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> x * x;</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<h2 id="algorithm-åº“"><code>&lt;algorithm&gt;</code> åº“</h2>
<p>è¯¥åº“æ˜¯æ¨¡æ¿å‡½æ•°çš„é›†åˆ</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250123004800250.png" alt="image-20250123004800250">
<figcaption aria-hidden="true">image-20250123004800250</figcaption>
</figure>
<h2 id="æ“ä½œç¬¦é‡è½½">æ“ä½œç¬¦é‡è½½</h2>
<p>Operator Overloadingï¼Œè‡ªå®šä¹‰æ“ä½œç¬¦çš„è¡Œä¸º</p>
<ul>
<li><p>ä¸èƒ½è¢«é‡è½½çš„è¿ç®—ç¬¦ï¼š<code>::   ?   .   .*   sizeof()   typeid()   cast()</code></p></li>
<li><p>ä¸¤ç§é‡è½½æ–¹å¼ï¼š</p>
<ol type="1">
<li><p>æˆå‘˜é‡è½½ï¼šåœ¨ç±»å†…å¯¹æ“ä½œç¬¦è¿›è¡Œé‡è½½ï¼Œè°ƒç”¨æ—¶é€šè¿‡<code>b.operator&lt;(rhs)</code>ï¼ˆbæ˜¯å¯¹è±¡ï¼‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> Obj::<span class="keyword">operator</span>&lt; (<span class="type">const</span> Obj&amp; rhs) <span class="type">const</span> {...}</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>éæˆå‘˜é‡è½½ï¼šåœ¨ç±»å¤–è¿›è¡Œé‡è½½ï¼ŒåŒæ—¶å°†ä¸¤ä¸ªæ“ä½œå¯¹è±¡ä½œä¸ºå‚æ•°</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&lt; (<span class="type">const</span> Obj&amp; lhs, <span class="type">const</span> Obj&amp; rhs);</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>éæˆå‘˜é‡è½½å¯ä»¥é€šè¿‡<strong>å‹å…ƒ</strong>å®ç°ï¼Œè¿™æ ·å°±èƒ½è®¿é—®ç§æœ‰å˜é‡</p>
</blockquote></li>
</ol></li>
</ul>
<h2 id="ç‰¹æ®Šæˆå‘˜å‡½æ•°">ç‰¹æ®Šæˆå‘˜å‡½æ•°</h2>
<p>Special Member Functions
(SMFs)ï¼Œç‰¹æ®Šæˆå‘˜å‡½æ•°æ˜¯ç±»ï¼ˆæˆ–ç»“æ„ï¼‰æˆå‘˜å‡½æ•°ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºä½ ç”Ÿæˆã€‚
åŒ…æ‹¬<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/cpp/cpp/constructors-cpp?view=msvc-170#default_constructors">é»˜è®¤æ„é€ å‡½æ•°</a>ã€<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/cpp/cpp/destructors-cpp?view=msvc-170">ææ„å‡½æ•°</a>ã€<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/cpp/cpp/copy-constructors-and-copy-assignment-operators-cpp?view=msvc-170">å¤åˆ¶æ„é€ å‡½æ•°å’Œå¤åˆ¶èµ‹å€¼è¿ç®—ç¬¦</a>ï¼Œä»¥åŠ<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/cpp/cpp/move-constructors-and-move-assignment-operators-cpp?view=msvc-170">ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</a>ã€‚</p>
<ul>
<li><p>Default constructor: T()</p></li>
<li><p>Destructor: ~T()</p></li>
<li><p>Copy constructor: T(const T&amp;)</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Widget widgetOne;</span><br><span class="line">Widget widgetTwo = widgetOne;</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p><strong>å¯¹äºæ‹·è´æ„é€ å‡½æ•°ï¼Œå¦‚æœç±»åŒ…å«åŠ¨æ€æ•°ç»„ï¼ˆå³æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜ï¼‰ï¼Œå¿…é¡»å•ç‹¬ä¸ºæ•°ç»„åˆ†é…æ–°å†…å­˜ï¼Œå¹¶æ‹·è´å†…å®¹ï¼ˆæ·±æ‹·è´ï¼‰ï¼Œè€Œä¸æ˜¯ä»…ä»…èµ‹å€¼æŒ‡é’ˆï¼Œå¦åˆ™ä¼šå¼•å‘
æµ…æ‹·è´ï¼ˆshallow copyï¼‰ é—®é¢˜</strong></p>
</blockquote></li>
<li><p>Copy assignment operator: T&amp; operator=(const T&amp;)
ï¼ˆæ“ä½œå¯¹è±¡æ˜¯<strong>å·²ç»å­˜åœ¨çš„å¯¹è±¡</strong>ï¼Œæ³¨æ„ä¸ä¸Šé¢å‡½æ•°åŒºåˆ«ï¼‰</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Widget widgetOne;</span><br><span class="line">Widget widgetTwo;</span><br><span class="line">widgetOne = widgetTwo</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>Move constructor: T(T&amp;&amp;)</p>
<p>ç§»åŠ¨æ„é€ å‡½æ•°çš„ä½œç”¨æ˜¯é€šè¿‡<strong>è½¬ç§»èµ„æº</strong>æ¥æ„é€ ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ·±æ‹·è´èµ„æºï¼Œè¿™æ ·å°±å¯ä»¥æé«˜ç©ºé—´åˆ©ç”¨ç‡</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="built_in">MyClass</span>(MyClass&amp;&amp; other) <span class="keyword">noexcept</span> : <span class="built_in">data</span>(other.data) {</span><br><span class="line">    other.data = <span class="literal">nullptr</span>; <span class="comment">// å°†æºå¯¹è±¡çš„èµ„æºç½®ä¸º nullptr</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Move Constructor called"</span> &lt;&lt; std::endl;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>Move assignment operator: T&amp; operator=(T&amp;&amp;)</p>
<p>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„èµ„æºè½¬ç§»åˆ°å¦ä¸€ä¸ª<strong>å·²ç»å­˜åœ¨</strong>çš„å¯¹è±¡ä¸­ã€‚å®ƒåœ¨æ‰§è¡Œèµ„æºè½¬ç§»çš„åŒæ—¶ï¼Œé‡Šæ”¾ç›®æ ‡å¯¹è±¡çš„å·²æœ‰èµ„æºä»¥é˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line">MyClass&amp; <span class="keyword">operator</span>=(MyClass&amp;&amp; other) <span class="keyword">noexcept</span> {</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> != &amp;other) { <span class="comment">// é˜²æ­¢è‡ªèµ‹å€¼</span></span><br><span class="line">        <span class="keyword">delete</span> data;      <span class="comment">// é‡Šæ”¾å·²æœ‰èµ„æº</span></span><br><span class="line">        data = other.data; <span class="comment">// è½¬ç§»èµ„æº</span></span><br><span class="line">        other.data = <span class="literal">nullptr</span>; <span class="comment">// å°†æºå¯¹è±¡çš„èµ„æºç½®ä¸º nullptr</span></span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Move Assignment Operator called"</span> &lt;&lt; std::endl;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function">MyClass <span class="title">obj1</span><span class="params">(<span class="number">42</span>)</span></span>;    <span class="comment">// è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="function">MyClass <span class="title">obj2</span><span class="params">(<span class="number">100</span>)</span></span>;   <span class="comment">// è°ƒç”¨æ„é€ å‡½æ•°</span></span><br><span class="line">obj2 = std::<span class="built_in">move</span>(obj1); <span class="comment">// è§¦å‘ ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h2 id="move-semanticsç§»åŠ¨è¯­ä¹‰">Move Semanticsï¼ˆç§»åŠ¨è¯­ä¹‰ï¼‰</h2>
<p>æ¶‰åŠåˆ°äº†å·¦å€¼å³å€¼ï¼Œä¸‹é¢æ²¡æœ‰è¯¦ç»†å±•å¼€ï¼Œä¸»è¦ä»‹ç»<code>std::move</code>å‡½æ•°ã€‚</p>
<p>ç§»åŠ¨æ„é€ å‡½æ•°ã€ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦å‡å±äºè¯¥çŸ¥è¯†ç‚¹ï¼Œå½“è¦è§¦å‘è¿™ä¸¤ä¸ªå‡½æ•°æ—¶ï¼Œéœ€è¦ç”¨åˆ°<code>std::move</code>ï¼Œä¾‹å¦‚ä¸Šé¢çš„ä¾‹å­</p>
<h3 id="stdmove">std::move</h3>
<h4 id="å®šä¹‰">å®šä¹‰</h4>
<ul>
<li><code>std::move</code>
æ˜¯ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°ï¼Œç”¨äºå°†å·¦å€¼æ˜¾å¼åœ°è½¬ä¸ºå³å€¼å¼•ç”¨ï¼Œä»è€Œè§¦å‘ç§»åŠ¨è¯­ä¹‰ã€‚</li>
<li>æ³¨æ„ï¼š<code>std::move</code>
å¹¶ä¸ç§»åŠ¨å¯¹è±¡ï¼Œè€Œæ˜¯å…è®¸å¯¹è±¡çš„èµ„æºè¢«ç§»åŠ¨ã€‚</li>
</ul>
<h4 id="è¯­æ³•">è¯­æ³•</h4>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">T&amp;&amp; <span class="title">std::move</span><span class="params">(T&amp; t)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="ç¤ºä¾‹-2">ç¤ºä¾‹</h4>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::string str = <span class="string">"Hello"</span>;</span><br><span class="line">std::string movedStr = std::<span class="built_in">move</span>(str); <span class="comment">// è§¦å‘ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="stdoptional">std::optional</h2>
<p><code>std::optional</code> æ˜¯ C++17
å¼•å…¥çš„ä¸€ä¸ªå·¥å…·ç±»ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå€¼å¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨çš„æƒ…å½¢ã€‚å®ƒæä¾›äº†ä¸€ç§ä¼˜é›…çš„æ–¹å¼æ¥å¤„ç†å¯èƒ½ä¸ºç©ºçš„å€¼ï¼Œè€Œä¸éœ€è¦ä¾èµ–é¢å¤–çš„å¸ƒå°”æ ‡å¿—æˆ–ä½¿ç”¨æŒ‡é’ˆã€‚</p>
<h3 id="ä¸»è¦ç‰¹ç‚¹"><strong>ä¸»è¦ç‰¹ç‚¹</strong></h3>
<ol type="1">
<li><strong>å€¼çš„å¯é€‰æ€§ï¼š</strong>
<ul>
<li>ä¸€ä¸ª <code>std::optional</code>
å¯¹è±¡å¯ä»¥åŒ…å«ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥ä¸åŒ…å«å€¼ï¼ˆå³å¤„äº "empty" çŠ¶æ€ï¼‰ã€‚</li>
<li>é€‚åˆç”¨æ¥è¡¨ç¤ºâ€œå¯æœ‰å¯æ— â€çš„æ•°æ®ã€‚</li>
</ul></li>
<li><strong>é¿å…ç©ºæŒ‡é’ˆï¼š</strong>
<ul>
<li>æ¯”å¦‚å‡½æ•°å¯èƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯èƒ½ä¸è¿”å›å€¼ï¼Œç”¨
<code>std::optional</code> æ›¿ä»£è¿”å›æŒ‡é’ˆé¿å…ç©ºæŒ‡é’ˆå¼•å‘çš„é”™è¯¯ã€‚</li>
</ul></li>
<li><strong>å¼ºç±»å‹ä¿éšœï¼š</strong>
<ul>
<li>æä¾›æ¯”è¿”å› <code>nullptr</code> æˆ–ç‰¹æ®Šæ ‡å¿—ï¼ˆä¾‹å¦‚ <code>-1</code> æˆ–
<code>0</code>ï¼‰æ›´å®‰å…¨çš„æ–¹å¼ï¼Œç¡®ä¿ç¨‹åºçš„è¡Œä¸ºæ›´åŠ æ˜ç¡®ã€‚</li>
</ul></li>
</ol>
<h3 id="ä½¿ç”¨åœºæ™¯-2"><strong>ä½¿ç”¨åœºæ™¯</strong></h3>
<ol type="1">
<li><p><strong>å‡½æ•°è¿”å›å€¼</strong> å½“å‡½æ•°ä¸æ€»æ˜¯èƒ½è¿”å›æœ‰æ•ˆå€¼æ—¶ï¼Œç”¨
<code>std::optional</code> è¡¨ç¤ºè¿”å›å€¼çš„å¯é€‰æ€§ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;optional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">std::optional&lt;std::string&gt; <span class="title">findNameById</span><span class="params">(<span class="type">int</span> id)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">1</span>) <span class="keyword">return</span> <span class="string">"Alice"</span>;</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">2</span>) <span class="keyword">return</span> <span class="string">"Bob"</span>;</span><br><span class="line">    <span class="keyword">return</span> std::<span class="literal">nullopt</span>; <span class="comment">// æ— å€¼çš„æƒ…å†µ</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">auto</span> name = <span class="built_in">findNameById</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (name) {</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Found: "</span> &lt;&lt; *name &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Name not found.\n"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><p><strong>æ›¿ä»£å¸ƒå°”æ ‡å¿—ï¼š</strong>
ç”¨äºæ ‡å¿—æ˜¯å¦å­˜åœ¨å€¼ï¼Œé¿å…é¢å¤–çš„å¸ƒå°”å˜é‡ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Result</span> {</span><br><span class="line">    std::optional&lt;<span class="type">int</span>&gt; data;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function">Result <span class="title">compute</span><span class="params">(<span class="type">bool</span> flag)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (flag) <span class="keyword">return</span> Result{<span class="number">42</span>};</span><br><span class="line">    <span class="keyword">return</span> Result{std::<span class="literal">nullopt</span>};</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><p><strong>ä¸´æ—¶å¯¹è±¡çš„çŠ¶æ€ç®¡ç†ï¼š</strong>
è¡¨ç¤ºæŸäº›ä¸´æ—¶å€¼æ˜¯å¦æœ‰æ•ˆï¼Œæ¯”å¦‚ç¼“å­˜ç»“æœã€‚</p></li>
</ol>
<blockquote>
<p>æ³¨æ„<code>nullptr</code>å’Œ<code>std::nullopt</code>åŒºåˆ«</p>
<ul>
<li><code>nullptr</code>ï¼šä¸“é—¨ç”¨æ¥è¡¨ç¤ºæŒ‡é’ˆä¸æŒ‡å‘ä»»ä½•å¯¹è±¡ã€‚å®ƒå¯ä»¥éšå¼åœ°è½¬æ¢ä¸ºä»»æ„æŒ‡é’ˆç±»å‹ï¼Œä¾‹å¦‚
<code>int*</code>, <code>char*</code>, <code>void*</code> ç­‰ã€‚</li>
<li><code>std::nullopt</code>ï¼šå®ƒæ˜¯ C++17 ä¸­å¼•å…¥çš„
<code>std::optional</code> çš„ç‰¹æ®Šå€¼ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ª
<code>std::optional</code>
å¯¹è±¡ä¸åŒ…å«ä»»ä½•å€¼ï¼ˆä¸ºç©ºçš„çŠ¶æ€ï¼‰ã€‚å®ƒå¯ä»¥éšå¼åœ°ç”¨äºä»»ä½•
<code>std::optional&lt;T&gt;</code> ç±»å‹ï¼Œç”¨äºåˆå§‹åŒ–æˆ–é‡ç½®
<code>optional</code>ã€‚</li>
</ul>
</blockquote>
<h2 id="raii">RAII</h2>
<p>RAIIï¼Œå…¨ç§°ä¸º <strong>èµ„æºè·å–å³åˆå§‹åŒ–</strong>ï¼ˆResource Acquisition
Is Initializationï¼‰ï¼Œæ˜¯ä¸€ç§ C++ çš„é‡è¦è®¾è®¡ç†å¿µã€‚RAII
çš„æ ¸å¿ƒæ˜¯å°†èµ„æºï¼ˆå¦‚å†…å­˜ã€æ–‡ä»¶ã€ç½‘ç»œè¿æ¥ã€é”ç­‰ï¼‰çš„ç®¡ç†ä¸å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»‘å®šã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li><strong>åœ¨å¯¹è±¡æ„é€ æ—¶è·å–èµ„æº</strong>ï¼Œç¡®ä¿èµ„æºåœ¨å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…å¯ç”¨ã€‚</li>
<li><strong>åœ¨å¯¹è±¡ææ„æ—¶é‡Šæ”¾èµ„æº</strong>ï¼Œè‡ªåŠ¨æ¸…ç†ä»¥é˜²èµ„æºæ³„æ¼ã€‚</li>
</ul>
<p>è¿™ç§æ–¹å¼å¯ä»¥æœ‰æ•ˆåœ°é¿å…èµ„æºæ³„éœ²é—®é¢˜ï¼Œç®€åŒ–èµ„æºç®¡ç†ã€‚<strong>å¸¸è§åº”ç”¨åœºæ™¯</strong>ï¼š</p>
<ol type="1">
<li><p><strong>æ™ºèƒ½æŒ‡é’ˆï¼š</strong></p>
<ul>
<li><code>std::unique_ptr</code>, <code>std::shared_ptr</code>
ç­‰æ™ºèƒ½æŒ‡é’ˆåˆ©ç”¨ RAII ç®¡ç†åŠ¨æ€å†…å­˜ã€‚</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">example</span><span class="params">()</span> </span>{</span><br><span class="line">    std::unique_ptr&lt;<span class="type">int</span>&gt; ptr = std::<span class="built_in">make_unique</span>&lt;<span class="type">int</span>&gt;(<span class="number">42</span>); <span class="comment">// æ„é€ æ—¶åˆ†é…å†…å­˜</span></span><br><span class="line">    <span class="comment">// æ— éœ€æ‰‹åŠ¨é‡Šæ”¾å†…å­˜</span></span><br><span class="line">} <span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œptr è‡ªåŠ¨é‡Šæ”¾å†…å­˜</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p><strong>æ–‡ä»¶ç®¡ç†ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ RAII ç±»ç®¡ç†æ–‡ä»¶èµ„æºï¼Œé¿å…æ–‡ä»¶æœªå…³é—­çš„é—®é¢˜ã€‚</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeToFile</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="function">std::ofstream <span class="title">file</span><span class="params">(<span class="string">"example.txt"</span>)</span></span>; <span class="comment">// æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (!file) <span class="keyword">return</span>;</span><br><span class="line">    file &lt;&lt; <span class="string">"Hello, RAII!"</span>;</span><br><span class="line">} <span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œfile è‡ªåŠ¨å…³é—­</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p><strong>é”ç®¡ç†ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨ RAII ç±»å¦‚ <code>std::lock_guard</code>
ç®¡ç†çº¿ç¨‹åŒæ­¥ä¸­çš„é”ã€‚</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">criticalSection</span><span class="params">()</span> </span>{</span><br><span class="line">    std::mutex mtx;</span><br><span class="line">    <span class="function">std::lock_guard&lt;std::mutex&gt; <span class="title">lock</span><span class="params">(mtx)</span></span>; <span class="comment">// è‡ªåŠ¨åŠ é”</span></span><br><span class="line">    <span class="comment">// ä¸´ç•ŒåŒºä»£ç </span></span><br><span class="line">} <span class="comment">// ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œlock_guard è‡ªåŠ¨è§£é”</span></span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<h2 id="æ™ºèƒ½æŒ‡é’ˆ">æ™ºèƒ½æŒ‡é’ˆ</h2>
<p>Smart Pointers</p>
<h3 id="stdunique_ptr">1.
<strong><code>std::unique_ptr</code></strong></h3>
<ul>
<li><strong>ç‰¹ç‚¹</strong>: ç‹¬å æ‰€æœ‰æƒã€‚ä¸€ä¸ªå¯¹è±¡åªèƒ½ç”±ä¸€ä¸ª
<code>std::unique_ptr</code> æ‰€ç®¡ç†ã€‚</li>
<li><strong>ä¸»è¦ç”¨é€”</strong>:
ç”¨äºæ˜ç¡®å¯¹è±¡æ‰€æœ‰æƒçš„åœºæ™¯ï¼Œæ¯”å¦‚å±€éƒ¨å˜é‡çš„èµ„æºç®¡ç†ã€‚</li>
<li><strong>è‡ªåŠ¨é‡Šæ”¾</strong>: ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾æ‰€ç®¡ç†çš„å¯¹è±¡ã€‚</li>
</ul>
<p><strong>ç”¨æ³•</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">uniquePtrExample</span><span class="params">()</span> </span>{</span><br><span class="line">    std::unique_ptr&lt;<span class="type">int</span>&gt; ptr = std::<span class="built_in">make_unique</span>&lt;<span class="type">int</span>&gt;(<span class="number">10</span>); <span class="comment">// æ¨èä½¿ç”¨ std::make_unique</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Value: "</span> &lt;&lt; *ptr &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸èƒ½å¤åˆ¶ï¼Œä»¥ä¸‹ä»£ç ä¼šæŠ¥é”™</span></span><br><span class="line">    <span class="comment">// std::unique_ptr&lt;int&gt; ptr2 = ptr;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥è½¬ç§»æ‰€æœ‰æƒ</span></span><br><span class="line">    std::unique_ptr&lt;<span class="type">int</span>&gt; ptr2 = std::<span class="built_in">move</span>(ptr);</span><br><span class="line">    <span class="keyword">if</span> (!ptr) {</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"ptr is now empty after move."</span> &lt;&lt; std::endl;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>æ›´è½»é‡åŒ–ï¼Œæ•ˆç‡æœ€é«˜ã€‚</li>
<li>é¿å…é‡å¤é‡Šæ”¾åŒä¸€ä¸ªå¯¹è±¡çš„é—®é¢˜ã€‚</li>
<li>ä½¿ç”¨åœºæ™¯æ¸…æ™°ï¼Œé€‚åˆç‹¬å èµ„æºã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>ä¸èƒ½å…±äº«æ‰€æœ‰æƒï¼ˆå³å¤šä¸ªæŒ‡é’ˆç®¡ç†åŒä¸€ä¸ªèµ„æºï¼‰ã€‚</li>
</ul>
<h3 id="stdshared_ptr">2.
<strong><code>std::shared_ptr</code></strong></h3>
<ul>
<li><strong>ç‰¹ç‚¹</strong>: å…±äº«æ‰€æœ‰æƒã€‚å¤šä¸ª <code>std::shared_ptr</code>
å¯ä»¥å…±åŒç®¡ç†åŒä¸€ä¸ªå¯¹è±¡ï¼Œç›´åˆ°æœ€åä¸€ä¸ª <code>std::shared_ptr</code>
è¢«é”€æ¯æ—¶å¯¹è±¡æ‰ä¼šé‡Šæ”¾ã€‚</li>
<li><strong>ä¸»è¦ç”¨é€”</strong>:
ç”¨äºéœ€è¦å¤šä¸ªæŒ‡é’ˆå…±äº«èµ„æºçš„åœºæ™¯ï¼Œæ¯”å¦‚èµ„æºå…±äº«å’Œå¹¶å‘åœºæ™¯ã€‚</li>
</ul>
<p><strong>ç”¨æ³•</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sharedPtrExample</span><span class="params">()</span> </span>{</span><br><span class="line">    std::shared_ptr&lt;<span class="type">int</span>&gt; ptr1 = std::<span class="built_in">make_shared</span>&lt;<span class="type">int</span>&gt;(<span class="number">20</span>); <span class="comment">// æ¨èä½¿ç”¨ std::make_shared</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Value: "</span> &lt;&lt; *ptr1 &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    std::shared_ptr&lt;<span class="type">int</span>&gt; ptr2 = ptr1; <span class="comment">// å…±äº«æ‰€æœ‰æƒ</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Use count: "</span> &lt;&lt; ptr1.<span class="built_in">use_count</span>() &lt;&lt; std::endl; <span class="comment">// å¼•ç”¨è®¡æ•°</span></span><br><span class="line"></span><br><span class="line">    ptr1.<span class="built_in">reset</span>(); <span class="comment">// ptr1 ä¸å†ç®¡ç†èµ„æº</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">"Use count after reset: "</span> &lt;&lt; ptr2.<span class="built_in">use_count</span>() &lt;&lt; std::endl;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>æ–¹ä¾¿åœ¨éœ€è¦å…±äº«èµ„æºçš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚</li>
<li>è‡ªåŠ¨è¿›è¡Œå¼•ç”¨è®¡æ•°ï¼Œæœ€åä¸€ä¸ªæŒ‡é’ˆé”€æ¯æ—¶é‡Šæ”¾èµ„æºã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>æœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€ï¼ˆå¼•ç”¨è®¡æ•°ç®¡ç†ï¼‰ã€‚</li>
<li>å¦‚æœå­˜åœ¨å¾ªç¯å¼•ç”¨ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ˆéœ€é…åˆ
<code>std::weak_ptr</code> è§£å†³ï¼‰ã€‚</li>
</ul>
<h3 id="stdweak_ptr">3. <strong><code>std::weak_ptr</code></strong></h3>
<ul>
<li><strong>ç‰¹ç‚¹</strong>: å¼±å¼•ç”¨ã€‚ç”¨äºè§£å†³ <code>std::shared_ptr</code>
å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</li>
<li><strong>ä¸»è¦ç”¨é€”</strong>: è¾…åŠ© <code>std::shared_ptr</code>
ä½¿ç”¨ï¼Œä¸å¢åŠ å¼•ç”¨è®¡æ•°ï¼Œåªèƒ½è§‚å¯Ÿï¼ˆå¼±å¼•ç”¨ï¼‰èµ„æºã€‚</li>
</ul>
<p><strong>ç”¨æ³•</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">weakPtrExample</span><span class="params">()</span> </span>{</span><br><span class="line">    std::shared_ptr&lt;<span class="type">int</span>&gt; shared = std::<span class="built_in">make_shared</span>&lt;<span class="type">int</span>&gt;(<span class="number">30</span>);</span><br><span class="line">    std::weak_ptr&lt;<span class="type">int</span>&gt; weak = shared; <span class="comment">// ä¸å¢åŠ å¼•ç”¨è®¡æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">auto</span> ptr = weak.<span class="built_in">lock</span>()) { <span class="comment">// æ£€æŸ¥èµ„æºæ˜¯å¦ä»ç„¶å­˜åœ¨</span></span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Value: "</span> &lt;&lt; *ptr &lt;&lt; std::endl;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Resource no longer exists."</span> &lt;&lt; std::endl;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    shared.<span class="built_in">reset</span>(); <span class="comment">// é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">auto</span> ptr = weak.<span class="built_in">lock</span>()) {</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Value: "</span> &lt;&lt; *ptr &lt;&lt; std::endl;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        std::cout &lt;&lt; <span class="string">"Resource no longer exists."</span> &lt;&lt; std::endl;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>ç”¨äºè§£å†³ <code>std::shared_ptr</code> å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</li>
<li>å…è®¸è®¿é—®èµ„æºä½†ä¸æ‹¥æœ‰èµ„æºï¼Œä¸å½±å“å¼•ç”¨è®¡æ•°ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>åªèƒ½ä¸ <code>std::shared_ptr</code> æ­é…ä½¿ç”¨ï¼Œå•ç‹¬æ„ä¹‰ä¸å¤§ã€‚</li>
</ul>
<h2 id="makefiles-å’Œ-cmake">Makefiles å’Œ CMake</h2>
<h3 id="makefile"><strong>1. Makefile</strong></h3>
<ul>
<li><code>Makefile</code> æ˜¯ç”¨äº <code>make</code>
å·¥å…·çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒå®šä¹‰äº†ä¸€ç³»åˆ—è§„åˆ™ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨å¦‚ä½•ç”Ÿæˆç›®æ ‡æ–‡ä»¶ã€‚</li>
<li>æœ¬è´¨ä¸Šæ˜¯æ‰‹å†™çš„æ„å»ºè§„åˆ™ï¼Œç›´æ¥è°ƒç”¨ç¼–è¯‘å™¨å‘½ä»¤ã€‚</li>
</ul>
<h3 id="cmake"><strong>2. CMake</strong></h3>
<p>éœ€è¦ç¼–å†™ç¼–å†™ <code>CMakeLists.txt</code></p>
<ul>
<li><code>CMake</code>
æ˜¯ä¸€ç§è·¨å¹³å°çš„æ„å»ºç³»ç»Ÿç”Ÿæˆå·¥å…·ï¼Œå®ƒå¯ä»¥ç”Ÿæˆä¸åŒå¹³å°ä¸Šçš„é¡¹ç›®æ–‡ä»¶ï¼ˆå¦‚
<code>Makefile</code>ã€Visual Studio çš„é¡¹ç›®æ–‡ä»¶ï¼‰ã€‚</li>
<li><code>CMake</code> æœ¬è´¨ä¸Šæ˜¯ä¸ºå¤§å‹é¡¹ç›®æä¾›äº†é«˜å±‚æ¬¡çš„æŠ½è±¡ã€‚</li>
</ul>
<h2 id="assignment">Assignment</h2>
<p>å‚è€ƒèµ„æ–™ï¼šhttps://www.zhihu.com/column/c_1839339107211419649</p>
<h3 id="assignment-1">Assignment 1</h3>
<ul>
<li><p>åœ¨è¿­ä»£ <code>std::vector</code>
æ—¶ï¼Œä¸å»ºè®®ç›´æ¥ä¿®æ”¹å½“å‰éå†çš„å®¹å™¨ï¼ˆå¦‚åˆ é™¤å…ƒç´ ï¼‰ã€‚ä¸€ç§å¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨
<strong>åå‘è¿­ä»£</strong> æˆ–è€…
<strong>æ ‡è®°åˆ é™¤</strong>ï¼Œç„¶ååœ¨è¿­ä»£å®Œæˆååˆ é™¤å…ƒç´ ã€‚</p>
<p>ä½†æ˜¯è¿™é‡Œä¸èƒ½ä½¿ç”¨åå‘è¿­ä»£ï¼Œä¼šå¯¼è‡´æ–‡ä»¶å†…å®¹ä¸æ­£ç¡®æ–‡ä»¶å†…å®¹ä¸åŒ¹é…ï¼ˆå€’åºï¼Œä»æœ€åä¸€è¡Œå¾€ç¬¬ä¸€è¡Œè¯»å–å†…å®¹ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªä¸­é—´å˜é‡å­˜æ”¾å¾…åˆ é™¤çš„å…ƒç´ ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;Course&gt; tmp; <span class="comment">// å­˜æ”¾å¾…åˆ é™¤çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> c: all_courses) {</span><br><span class="line">    <span class="keyword">if</span>(c.quarter != <span class="string">"null"</span>) {</span><br><span class="line">        ofile &lt;&lt; c.title &lt;&lt; <span class="string">","</span> &lt;&lt; c.number_of_units &lt;&lt; <span class="string">","</span> &lt;&lt; c.quarter &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">        tmp.<span class="built_in">push_back</span>(c);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> t: tmp) {</span><br><span class="line">    <span class="built_in">delete_elem_from_vector</span>(all_courses, t);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>åˆ›å»ºäº†ä¸€ä¸ªä¸´æ—¶å®¹å™¨
<code>tmp</code>ï¼Œå¹¶åœ¨éå†è¿‡ç¨‹ä¸­æŠŠè¦åˆ é™¤çš„å…ƒç´ æ”¾å…¥å…¶ä¸­ã€‚éå†å®Œåï¼Œå†é€šè¿‡
<code>delete_elem_from_vector</code> ä» <code>all_courses</code>
ä¸­åˆ é™¤è¿™äº›å…ƒç´ ã€‚è¿™æ ·å¯ä»¥é¿å…åœ¨åŸå®¹å™¨ä¸Šè¿›è¡Œåˆ é™¤æ“ä½œæ—¶æ”¹å˜å®¹å™¨çš„å¤§å°æˆ–é¡ºåºï¼Œä»è€Œé¿å…è¿­ä»£å™¨å¤±æ•ˆçš„é—®é¢˜ã€‚</p>
</blockquote></li>
</ul>
<h3 id="assignment-2">Assignment 2</h3>
<p>éœ€è¦æ³¨æ„ä½œä¸šè¦æ±‚è·å– first name å’Œ last name
çš„ä¸¤ä¸ªé¦–å­—æ¯ï¼Œä¸¤ä¸ªéƒ½å¿…é¡»å‚ä¸æ¯”è¾ƒï¼Œå¯ä»¥å•ç‹¬å†™ä¸€ä¸ªå‡½æ•°è®°å½•ä¸¤ä¸ªå­—æ¯ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒ</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::string <span class="title">get_initials</span><span class="params">(std::string name)</span> </span>{</span><br><span class="line">  <span class="comment">// åˆå§‹åŒ–ç»“æœå­—ç¬¦ä¸²</span></span><br><span class="line">    std::string res;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–ç¬¬ä¸€ä¸ªå­—æ¯</span></span><br><span class="line">    res += name[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾ç©ºæ ¼ä½ç½®</span></span><br><span class="line">    <span class="type">size_t</span> space_pos = name.<span class="built_in">find</span>(<span class="string">' '</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœæ‰¾åˆ°äº†ç©ºæ ¼ï¼Œè·å–ç©ºæ ¼åç¬¬ä¸€ä¸ªå­—æ¯</span></span><br><span class="line">    <span class="keyword">if</span> (space_pos != std::string::npos &amp;&amp; space_pos + <span class="number">1</span> &lt; name.<span class="built_in">size</span>()) {</span><br><span class="line">        res += name[space_pos + <span class="number">1</span>];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">std::queue&lt;<span class="type">const</span> std::string*&gt; <span class="title">find_matches</span><span class="params">(std::string name, std::unordered_set&lt;std::string&gt;&amp; students)</span> </span>{</span><br><span class="line">  <span class="comment">// STUDENT <span class="doctag">TODO:</span> Implement this function.</span></span><br><span class="line">  std::queue&lt;<span class="type">const</span> std::string*&gt; q;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">auto</span> it = students.<span class="built_in">begin</span>(); it != students.<span class="built_in">end</span>(); ++it) {</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">get_initials</span>(*it) == <span class="built_in">get_initials</span>(kYourName))</span><br><span class="line">      q.<span class="built_in">push</span>(&amp;(*it)); <span class="comment">// å…ˆè§£å¼•ç”¨itå¾—åˆ°å­—ç¬¦ä¸²ï¼Œç„¶åå†è·å–è¯¥å­—ç¬¦ä¸²çš„åœ°å€</span></span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> q;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="assignment-3">Assignment 3</h3>
<p>CastXMLç¯å¢ƒæœ‰é—®é¢˜ï¼Œæ— æ³•ç”Ÿæˆxmlæ–‡ä»¶å¯¼è‡´æ— æ³•æµ‹è¯„</p>
<h3 id="assignment-4">Assignment 4</h3>
<p>ä¸»è¦ç”¨åˆ°ä¸‹é¢è¿™å‡ ä¸ªå‡½æ•°ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">std::<span class="built_in">min_element</span>( ForwardIt first, ForwardIt last );</span><br><span class="line">std::<span class="built_in">accumulate</span>(InputIt first, InputIt last, T init); <span class="comment">// è¿™é‡Œçš„initæ˜¯åˆå§‹å€¼</span></span><br><span class="line">std::<span class="built_in">max_element</span>( ForwardIt first, ForwardIt last );</span><br><span class="line"></span><br><span class="line">std::<span class="built_in">transform</span>( InputIt first1, InputIt last1, OutputIt d_first, UnaryOp unary_op ); <span class="comment">// ç¬¬å››ä¸ªå‚æ•°å¯ç”¨lambdaè¡¨è¾¾å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//std::remove_if å®ƒä¼š é‡æ–°æ’åˆ— æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ï¼Œä½¿æ‰€æœ‰ ä¸ç¬¦åˆ ç»™å®šæ¡ä»¶çš„å…ƒç´ æ’åœ¨å‰é¢ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ å°¾éƒ¨è¿­ä»£å™¨ï¼ŒæŒ‡å‘é‡æ–°æ’åˆ—åçš„æœ‰æ•ˆèŒƒå›´çš„æœ«å°¾ã€‚</span></span><br><span class="line">std::<span class="built_in">remove_if</span>(ForwardIt first, ForwardIt last, UnaryPred p); <span class="comment">// på‡½æ•°çš„è¿”å›å€¼ä¸€èˆ¬æ˜¯å¸ƒå°”å€¼</span></span><br><span class="line"></span><br><span class="line">std::erase <span class="comment">// èƒ½å¤ŸçœŸæ­£åˆ é™¤å…ƒç´ ï¼Œå¯ä¸remove_ifé…åˆä½¿ç”¨</span></span><br></pre></td></tr></tbody></table></figure>
<p>è¿˜éœ€æ³¨æ„<code>const</code>çš„ä½¿ç”¨ï¼Œæœ‰äº›å‡½æ•°çš„å‚æ•°ä¸èƒ½ä½¿ç”¨<code>const</code>ç±»å‹å˜é‡ã€‚</p>
<blockquote>
<p>å¦‚æœå‡ºç°ä»¥ä¸‹æŠ¥é”™ï¼Œåˆ™åœ¨å¯¹åº”çš„æ–‡ä»¶æ‰“å¼€å‡½æ•°ä¸­æ·»åŠ ç¼–ç å‚æ•°ï¼Œä¾‹å¦‚ï¼š<code>open(file_path, "r", encoding="utf-8")</code></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File "D:\ComputerScience\CS106L\cs106l-assignments\assign4\autograder\autograder.py", line 181, in &lt;module&gt;</span><br><span class="line">    add_matcher_tests(grader)</span><br><span class="line">  File "D:\ComputerScience\CS106L\cs106l-assignments\assign4\autograder\autograder.py", line 138, in add_matcher_tests     </span><br><span class="line">    student_methods = parse_methods(MAIN_CPP_PATH)</span><br><span class="line">                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File "D:\ComputerScience\CS106L\cs106l-assignments\assign4\autograder\autograder.py", line 97, in parse_methods</span><br><span class="line">    content = file.read()</span><br><span class="line">              ^^^^^^^^^^^</span><br><span class="line">UnicodeDecodeError: 'gbk' codec can't decode byte 0xa8 in position 693: illegal multibyte sequence</span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<h3 id="assignment-5">Assignment 5</h3>
<p>ç¬¬äºŒéƒ¨åˆ†ä¸­æ³¨æ„ï¼šå¯¹äºæ‹·è´æ„é€ å‡½æ•°ï¼Œå¦‚æœç±»åŒ…å«åŠ¨æ€æ•°ç»„ï¼ˆå³æŒ‡é’ˆæŒ‡å‘çš„å †å†…å­˜ï¼‰ï¼Œå¿…é¡»å•ç‹¬ä¸ºæ•°ç»„åˆ†é…æ–°å†…å­˜ï¼Œå¹¶æ‹·è´å†…å®¹ï¼Œè€Œä¸æ˜¯ä»…ä»…èµ‹å€¼æŒ‡é’ˆï¼Œå¦åˆ™ä¼šå¼•å‘
æµ…æ‹·è´ï¼ˆshallow copyï¼‰ é—®é¢˜</p>
<h3 id="assignment-6">Assignment 6</h3>
<p>è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯<code>std::optional</code>ï¼Œå¯å‚è€ƒä¸Šé¢çš„ç¬”è®°</p>
<h3 id="assignment-7">Assignment 7</h3>
<p><strong>éœ€è¦ä½¿ç”¨ <code>std::move</code>
æ¥æ˜¾å¼è§¦å‘ç§»åŠ¨æ„é€ å‡½æ•°å’Œç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</strong></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§¦å‘ç§»åŠ¨æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="function">MyClass <span class="title">obj1</span><span class="params">(<span class="number">42</span>)</span></span>;</span><br><span class="line">MyClass obj2 = std::<span class="built_in">move</span>(obj1); </span><br><span class="line"></span><br><span class="line"><span class="comment">// è§¦å‘ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦</span></span><br><span class="line"><span class="function">MyClass <span class="title">obj1</span><span class="params">(<span class="number">42</span>)</span></span>;</span><br><span class="line"><span class="function">MyClass <span class="title">obj2</span><span class="params">(<span class="number">100</span>)</span></span>;</span><br><span class="line">obj2 = std::<span class="built_in">move</span>(obj1);  </span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œè¿˜éœ€è¦ä½¿ç”¨åå‘è¿­ä»£å™¨ï¼ˆreverse_iteratorï¼‰æ¥å®ç°å€’åºéå†ï¼ˆé€†åºéå†ï¼‰ï¼Œ<code>rbegin()</code>æŒ‡å‘å®¹å™¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ<code>rend()</code>
æŒ‡å‘å®¹å™¨çš„å‰ä¸€ä¸ªä½ç½®ï¼ˆå³ <code>begin() - 1</code>ï¼‰ï¼Œä¸‹é¢æ˜¯ç›¸å…³ä»£ç </p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> i = values.<span class="built_in">rbegin</span>(); i != values.<span class="built_in">rend</span>(); ++i) {</span><br><span class="line">    unique_ptr&lt;ListNode&lt;T&gt;&gt; node = <span class="keyword">new</span> <span class="built_in">ListNode</span>&lt;T&gt;(*i);</span><br><span class="line">    node-&gt;next = std::<span class="built_in">move</span>(head);</span><br><span class="line">    head = std::<span class="built_in">move</span>(node);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/04/gdb%E5%9C%A8WSL1%E4%B8%AD%E6%8A%A5%E9%94%99/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/04/gdb%E5%9C%A8WSL1%E4%B8%AD%E6%8A%A5%E9%94%99/" class="post-title-link" itemprop="url">gdbåœ¨WSL1ä¸­æŠ¥é”™è§£å†³æ–¹æ¡ˆ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-01-04 00:00:00 / ä¿®æ”¹æ—¶é—´ï¼š16:58:12" itemprop="dateCreated datePublished" datetime="2025-01-04T00:00:00+08:00">2025-01-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WSL/" itemprop="url" rel="index"><span itemprop="name">WSL</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>550</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>1 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æˆ‘çš„ç¯å¢ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\hxt&gt; wsl <span class="literal">--list</span> <span class="literal">--verbose</span></span><br><span class="line">  NAME      STATE           VERSION</span><br><span class="line">* Ubuntu    Stopped         <span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>
<p>æˆ‘æƒ³è¦åœ¨è¯¥ç¯å¢ƒä¸‹è°ƒè¯•ä¸€ä¸ªcppæ–‡ä»¶ï¼Œä½†æ˜¯æŠ¥é”™ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b 6</span><br><span class="line">Breakpoint 1 at 0x1224: file cin_2.cpp, line 7.</span><br><span class="line">(gdb) r</span><br><span class="line">Starting program: /home/hxt/test_code/cin_2</span><br><span class="line">warning: opening /proc/PID/mem file for lwp 399.399 failed: No such file or directory (2)</span><br><span class="line">Warning:</span><br><span class="line">Cannot insert breakpoint 1.</span><br><span class="line">Cannot access memory at address 0x8001224</span><br></pre></td></tr></tbody></table></figure>
<p>ç»è¿‡æœç´¢å‘ç°WSL1ï¼ˆWindows Subsystem for
Linuxï¼‰ä¸­æ²¡æœ‰å¯¹<code>/proc/PID/mem</code>æä¾›æ”¯æŒï¼Œå¯¼è‡´GDBåœ¨å°è¯•è®¿é—®è¯¥æ–‡ä»¶æ—¶å‡ºé”™ã€‚è€ç‰ˆæœ¬çš„GDBåœ¨æ‰¾ä¸åˆ°<code>/proc/PID/mem</code>æ–‡ä»¶æ—¶ä¼šä½¿ç”¨
ptraceï¼Œè€Œæ–°ç‰ˆæœ¬çš„GDBåˆ™ç¦ç”¨äº†è¿™ç§æœºåˆ¶ã€‚è¿™é‡Œæ˜¯<a target="_blank" rel="noopener" href="https://github.com/microsoft/WSL/issues/8356">ç›¸å…³è®¨è®ºå’Œä¸åŒè§£å†³æ–¹æ¡ˆ</a>ã€‚</p>
<p><strong>æˆ‘çš„è§£å†³æ–¹æ¡ˆ</strong>æ˜¯å°†WSL1å‡çº§åˆ°WSL2ï¼Œä½¿ç”¨å‘½ä»¤<code>wsl --set-version &lt;å‘è¡Œç‰ˆåç§°&gt; 2</code>ï¼Œé—®é¢˜è§£å†³ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/17/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/17/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84/" class="post-title-link" itemprop="url">å†…å­˜æ˜ å°„</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-12-17 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-17T00:00:00+08:00">2024-12-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-05-16 22:40:59" itemprop="dateModified" datetime="2025-05-16T22:40:59+08:00">2025-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">æ“ä½œç³»ç»Ÿ</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å†…å­˜æ˜ å°„<code>mmap</code>åˆ†ä¸ºæ™®é€šæ–‡ä»¶å’ŒåŒ¿åæ–‡ä»¶ï¼Œè¿™é‡Œè®¨è®ºçš„æ˜¯Linuxç¯å¢ƒ</p>
<h2 id="æ–‡ä»¶æ˜ å°„file-mapping">æ–‡ä»¶æ˜ å°„ï¼ˆFile Mappingï¼‰</h2>
<blockquote>
<ul>
<li><strong><code>malloc</code>
æ˜¯é«˜çº§æŠ½è±¡</strong>ï¼Œå°è£…äº†å†…å­˜åˆ†é…ç»†èŠ‚ï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒåº•å±‚æ˜¯
<code>brk</code> è¿˜æ˜¯ <code>mmap</code>ã€‚</li>
<li><strong><code>mmap</code> æ˜¯åº•å±‚æœºåˆ¶</strong>ï¼Œæ—¢æœåŠ¡äº
<code>malloc</code> çš„å¤§å†…å­˜åˆ†é…ï¼Œä¹Ÿç”¨äºæ–‡ä»¶æ˜ å°„ç­‰é«˜çº§åŠŸèƒ½ã€‚</li>
</ul>
</blockquote>
<h3 id="æ™®é€šæ–‡ä»¶">æ™®é€šæ–‡ä»¶</h3>
<p>å°†<strong>æ™®é€šç£ç›˜æ–‡ä»¶</strong>çš„æŸä¸ªåŒºåŸŸæ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ã€‚</p>
<h4 id="å·¥ä½œåŸç†">å·¥ä½œåŸç†</h4>
<ul>
<li><strong>é¡µé¢åˆ’åˆ†</strong>ï¼šæ–‡ä»¶å†…å®¹è¢«åˆ’åˆ†æˆé¡µé¢å¤§å°ï¼ˆé€šå¸¸ä¸º4KBï¼‰çš„ç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µå¯¹åº”è™šæ‹Ÿå†…å­˜ä¸­çš„ä¸€ä¸ªé¡µé¢ã€‚</li>
<li>æŒ‰éœ€åŠ è½½ï¼ˆDemand Pagingï¼‰ï¼š
<ul>
<li>åˆå§‹æ—¶ï¼Œæ–‡ä»¶å†…å®¹å¹¶ä¸ä¼šå…¨éƒ¨åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸­ã€‚</li>
<li>å½“CPU<strong>é¦–æ¬¡</strong>è®¿é—®æŸä¸ªè™šæ‹Ÿé¡µé¢æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ‰å°†æ–‡ä»¶å¯¹åº”çš„é¡µé¢<strong>ä»ç£ç›˜åŠ è½½åˆ°ç‰©ç†å†…å­˜</strong>ã€‚</li>
</ul></li>
<li><strong>è¶…å‡ºæ–‡ä»¶åŒºåŸŸ</strong>ï¼šè‹¥æ˜ å°„åŒºåŸŸå¤§äºæ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºéƒ¨åˆ†ä¼šè¢«<strong>é›¶å¡«å……</strong>ï¼ˆPadding
with zerosï¼‰ã€‚</li>
</ul>
<h4 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h4>
<ul>
<li>æ–‡ä»¶çš„å†…å®¹ç›´æ¥ä¸è™šæ‹Ÿå†…å­˜å¯¹åº”ï¼Œå¯è¿›è¡Œé«˜æ•ˆçš„æ–‡ä»¶I/Oæ“ä½œã€‚</li>
<li>ç”¨äº<strong>ç¨‹åºæ‰§è¡Œ</strong>ï¼ˆå¦‚åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼‰æˆ–å®ç°<strong>æ–‡ä»¶å…±äº«</strong>ã€‚</li>
</ul>
<h3 id="åŒ¿åæ–‡ä»¶">åŒ¿åæ–‡ä»¶</h3>
<p>å°†ä¸€ç‰‡<strong>ä¸å…³è”ç£ç›˜æ–‡ä»¶</strong>çš„å†…å­˜åŒºåŸŸæ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚è¿™ç§åŒºåŸŸå†…å®¹åˆå§‹åŒ–ä¸º<strong>å…¨é›¶</strong>ï¼Œç”±å†…æ ¸åˆ›å»ºçš„<strong>åŒ¿åæ–‡ä»¶</strong>ç®¡ç†ã€‚åŒ¿åæ–‡ä»¶çš„å†…å®¹å…¨éƒ¨ç”±<strong>äºŒè¿›åˆ¶é›¶</strong>ç»„æˆï¼Œå› æ­¤å®ƒæ˜¯<strong>ç©ºç™½çš„</strong>ã€æœªåˆå§‹åŒ–çš„ã€‚</p>
<h4 id="å·¥ä½œåŸç†-1">å·¥ä½œåŸç†</h4>
<ul>
<li>æŒ‰éœ€åˆ†é…ï¼š
<ul>
<li>åˆå§‹æ—¶ï¼ŒåŒ¿åæ˜ å°„åŒºåŸŸå¹¶ä¸å ç”¨ç‰©ç†å†…å­˜ã€‚</li>
<li>å½“CPUé¦–æ¬¡è®¿é—®æŸä¸ªè™šæ‹Ÿé¡µé¢æ—¶ï¼Œå†…æ ¸ä¼šåˆ†é…ä¸€ä¸ª<strong>ç‰©ç†é¡µé¢</strong>ï¼Œå¹¶å°†å…¶å†…å®¹å¡«å……ä¸º<strong>äºŒè¿›åˆ¶é›¶</strong>ã€‚</li>
</ul></li>
<li>åªæœ‰å½“CPUç¬¬ä¸€æ¬¡è®¿é—®æŸä¸ªè™šæ‹Ÿé¡µé¢æ—¶ï¼ˆå³â€œè§¦æ‘¸â€è¯¥é¡µé¢ï¼‰ï¼Œå†…æ ¸æ‰ä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š
<ol type="1">
<li><strong>é€‰æ‹©ä¸€ä¸ªç‰ºç‰²é¡µé¢</strong>ï¼ˆVictim
Pageï¼‰ï¼šä»ç‰©ç†å†…å­˜ä¸­æ‰¾åˆ°ä¸€ä¸ªé€‚åˆè¢«æ›¿æ¢çš„é¡µé¢ã€‚</li>
<li><strong>äº¤æ¢è„é¡µé¢</strong>ï¼ˆå¦‚æœ‰å¿…è¦ï¼‰ï¼šå¦‚æœé€‰ä¸­çš„é¡µé¢æ˜¯<strong>è„é¡µé¢</strong>ï¼ˆå†…å®¹è¢«ä¿®æ”¹è¿‡ä½†å°šæœªå†™å›ç£ç›˜ï¼‰ï¼Œå†…æ ¸ä¼šå…ˆå°†å…¶å†…å®¹å†™å›ç£ç›˜ã€‚</li>
<li><strong>å¡«å……é›¶å€¼</strong>ï¼šå†…æ ¸å°†ç‰©ç†é¡µé¢çš„å†…å®¹å…¨éƒ¨å¡«å……ä¸º<strong>äºŒè¿›åˆ¶é›¶</strong>ã€‚</li>
<li><strong>æ›´æ–°é¡µè¡¨</strong>ï¼šå†…æ ¸å°†è™šæ‹Ÿé¡µé¢ä¸æ–°åˆ†é…çš„ç‰©ç†é¡µé¢å…³è”èµ·æ¥ï¼Œå¹¶å°†é¡µé¢æ ‡è®°ä¸º<strong>å·²é©»ç•™</strong>ï¼ˆResidentï¼‰ã€‚</li>
</ol></li>
</ul>
<h4 id="ç‰¹ç‚¹-1">ç‰¹ç‚¹</h4>
<ul>
<li>é€‚ç”¨äºåˆ†é…éœ€è¦åˆå§‹åŒ–ä¸ºé›¶çš„å†…å­˜åŒºåŸŸï¼Œä¾‹å¦‚å †å†…å­˜ã€æ ˆå†…å­˜ã€‚</li>
<li>ä¸æ¶‰åŠç£ç›˜æ–‡ä»¶ï¼Œå› æ­¤æ— éœ€ç£ç›˜I/Oã€‚</li>
<li>ç”±äºè¿™ç§æœºåˆ¶ä¸ä¼šæ¶‰åŠç£ç›˜å’Œå†…å­˜ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œå†…æ ¸åªæ˜¯åœ¨åˆ†é…ç‰©ç†é¡µé¢æ—¶å¡«å……é›¶å€¼ï¼Œå› æ­¤è¿™ç±»é¡µé¢è¢«ç§°ä¸º<strong>éœ€æ±‚é›¶é¡µé¢</strong>ï¼ˆDemand-Zero
Pagesï¼‰ã€‚</li>
</ul>
<blockquote>
<p><code>malloc</code> çš„å®ç°ï¼ˆå¦‚ glibc çš„
ptmallocï¼‰é€šå¸¸ä¼šç»“åˆä¸¤ç§æ–¹å¼åˆ†é…å†…å­˜ï¼š</p>
<ol type="1">
<li><strong>å°å†…å­˜å—ï¼ˆ&lt; 128KB æˆ–é˜ˆå€¼ï¼‰</strong>ï¼š
<ul>
<li>é€šè¿‡ <code>brk</code>/<code>sbrk</code>
ç³»ç»Ÿè°ƒç”¨æ‰©å±•å †ç©ºé—´ï¼Œä»å †ä¸­åˆ†é…ã€‚</li>
<li>ä¼˜ç‚¹ï¼šé«˜æ•ˆï¼Œå‡å°‘å†…å­˜ç¢ç‰‡ï¼ˆé€šè¿‡å†…å­˜æ± ç®¡ç†ï¼‰ã€‚</li>
</ul></li>
<li><strong>å¤§å†…å­˜å—ï¼ˆâ‰¥ 128KB æˆ–é˜ˆå€¼ï¼‰</strong>ï¼š
<ul>
<li>ç›´æ¥ä½¿ç”¨ <code>mmap</code>
åˆ†é…åŒ¿åå†…å­˜ï¼ˆ<code>MAP_ANONYMOUS</code>ï¼‰ã€‚</li>
<li>ä¼˜ç‚¹ï¼šå¤§å—å†…å­˜ç‹¬ç«‹ç®¡ç†ï¼Œé¿å…å †ç©ºé—´ç¢ç‰‡åŒ–ï¼›é‡Šæ”¾æ—¶ç›´æ¥é€šè¿‡
<code>munmap</code> å½’è¿˜ç»™æ“ä½œç³»ç»Ÿã€‚</li>
</ul></li>
</ol>
</blockquote>
<h2 id="fork-å‡½æ•°">fork å‡½æ•°</h2>
<p><strong>1. è°ƒç”¨ <code>fork()</code> æ—¶çš„å†…å­˜å¤åˆ¶ï¼š</strong></p>
<ul>
<li><p>åœ¨è°ƒç”¨ <code>fork()</code>
æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸ä¼šç«‹å³å¤åˆ¶æ•´ä¸ªçˆ¶è¿›ç¨‹çš„å†…å­˜ç©ºé—´ï¼Œè€Œæ˜¯é€šè¿‡<strong>å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Write,
COWï¼‰æœºåˆ¶</strong>ä¼˜åŒ–å†…å­˜ä½¿ç”¨ã€‚</p>
<blockquote>
<p><strong>å†™æ—¶å¤åˆ¶</strong>åªæœ‰åœ¨ä»»â¼€è¿›ç¨‹ï¼ˆâ½—è¿›ç¨‹æˆ–â¼¦è¿›ç¨‹ï¼‰å¯¹æ•°æ®æ‰§â¾äº†å†™æ“ä½œæ—¶ï¼Œå¤åˆ¶æ‰ä¼šå‘â½£ï¼ˆå…ˆæ˜¯ç¼ºâ»šä¸­æ–­ï¼Œç„¶åæ“ä½œç³»ç»Ÿç»™â¼¦è¿›ç¨‹åˆ†é…å†…å­˜å¹¶å¤åˆ¶â½—è¿›ç¨‹çš„æ•°æ®ï¼‰</p>
</blockquote></li>
<li><p>çˆ¶å­è¿›ç¨‹ä¼š<strong>å…±äº«åŒä¸€å—ç‰©ç†å†…å­˜é¡µé¢</strong>ï¼ˆåªè¯»ï¼‰ã€‚</p></li>
<li><p>åªæœ‰å½“çˆ¶è¿›ç¨‹æˆ–å­è¿›ç¨‹å°è¯•ä¿®æ”¹å†…å­˜æ—¶ï¼Œå†™æ—¶å¤åˆ¶æœºåˆ¶ä¼šä¸ºå¯¹åº”çš„è¿›ç¨‹åˆ›å»ºä¸€ä¸ªæ–°é¡µé¢ï¼Œä»è€Œä¸ºæ¯ä¸ªè¿›ç¨‹ä¿æŒäº†ç§æœ‰åœ°å€ç©ºé—´çš„æŠ½è±¡æ¦‚å¿µã€‚</p></li>
</ul>
<p><strong>2. åˆ›å»ºå­è¿›ç¨‹ï¼š</strong></p>
<ul>
<li>å†…æ ¸ä¼šä¸ºå­è¿›ç¨‹åˆ†é…ä¸€ä¸ªæ–°çš„<strong>è¿›ç¨‹æ§åˆ¶å—ï¼ˆPCBï¼‰</strong>ï¼Œç”¨äºå­˜å‚¨å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ã€‚</li>
<li>å­è¿›ç¨‹è·å¾—ä¸çˆ¶è¿›ç¨‹ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼ˆé€šè¿‡ COW å®ç°å…±äº«ï¼‰ã€‚</li>
<li>å­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹çš„å¤§éƒ¨åˆ†èµ„æºï¼Œä¾‹å¦‚ï¼š
<ul>
<li>ç¨‹åºä»£ç ï¼ˆä»£ç æ®µï¼‰</li>
<li>å †ã€æ ˆï¼ˆé€šè¿‡ COW å…±äº«ï¼‰</li>
<li>æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦</li>
<li>ç¯å¢ƒå˜é‡ç­‰</li>
</ul></li>
</ul>
<p><strong>3. è¿”å›å€¼ä¸åŒï¼š</strong></p>
<ul>
<li><code>fork()</code>åœ¨çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¸­éƒ½ä¼šè¿”å›ï¼š
<ul>
<li>åœ¨<strong>çˆ¶è¿›ç¨‹</strong>ä¸­ï¼Œ<code>fork()</code>
è¿”å›<strong>å­è¿›ç¨‹çš„PID</strong>ã€‚</li>
<li>åœ¨<strong>å­è¿›ç¨‹</strong>ä¸­ï¼Œ<code>fork()</code>
è¿”å›<strong>0</strong>ã€‚</li>
<li>å¦‚æœ <code>fork()</code> å¤±è´¥ï¼Œè¿”å›
<strong>-1</strong>ï¼Œè¡¨ç¤ºå­è¿›ç¨‹åˆ›å»ºå¤±è´¥ã€‚</li>
</ul></li>
</ul>
<p>é€šè¿‡è¿”å›å€¼çš„ä¸åŒï¼Œç¨‹åºå¯ä»¥åˆ¤æ–­å½“å‰æ­£åœ¨è¿è¡Œçš„æ˜¯çˆ¶è¿›ç¨‹è¿˜æ˜¯å­è¿›ç¨‹ã€‚</p>
<p><strong>4. è¿›ç¨‹è°ƒåº¦ï¼š</strong></p>
<ul>
<li>çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ä¼šè¢«æ“ä½œç³»ç»Ÿè°ƒåº¦å™¨è§†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œç‹¬ç«‹è¿è¡Œã€‚</li>
<li>ç”±äºçˆ¶å­è¿›ç¨‹å…±äº«åŒä¸€ä¸ªä»£ç æ®µï¼Œå®ƒä»¬å¯ä»¥æ‰§è¡Œä¸åŒçš„ä»£ç è·¯å¾„ï¼ˆå¦‚é€šè¿‡
<code>if</code> åˆ¤æ–­ <code>fork()</code> è¿”å›å€¼ï¼‰ã€‚</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/02/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/02/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="post-title-link" itemprop="url">lambdaè¡¨è¾¾å¼</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-12-02 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-02T00:00:00+08:00">2024-12-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-01-23 00:31:45" itemprop="dateModified" datetime="2025-01-23T00:31:45+08:00">2025-01-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CPP/" itemprop="url" rel="index"><span itemprop="name">CPP</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>2 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å†…å®¹å‚è€ƒã€ŠC++ primerã€‹</p>
<h2 id="å®šä¹‰">å®šä¹‰</h2>
<ul>
<li><p>ä¸€ä¸ªlambdaè¡¨è¾¾å¼è¡¨ç¤ºä¸€ä¸ªå¯è°ƒç”¨çš„ä»£ç å•å…ƒã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶ç†è§£ä¸ºä¸€ä¸ªæœªå‘½åçš„
å†…è”å‡½æ•°ã€‚</p></li>
<li><p>è¡¨è¾¾å¼å½¢å¼</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[capture list](parameter list) -&gt; return type { function body }</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>lambdaè¡¨è¾¾å¼å¿…é¡»ä½¿ç”¨å°¾ç½®è¿”å›ï¼Œå°¾ç½®è¿”å›ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// funcæ¥å—ä¸€ä¸ªintç±»å‹çš„å®å‚ï¼Œè¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å«æœ‰10ä¸ªæ•´æ•°çš„æ•°ç»„</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">func</span><span class="params">(<span class="type">int</span> i)</span> -&gt; <span class="title">int</span><span class="params">(*)</span>[10]</span>;</span><br></pre></td></tr></tbody></table></figure>
</blockquote></li>
<li><p>è‹¥å¿½ç•¥æ‹¬å·å’Œå‚æ•°åˆ—è¡¨ï¼Œåˆ™ç­‰ä»·äºæŒ‡å®šä¸€ä¸ªç©ºå‚æ•°åˆ—è¡¨</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> f = [] { <span class="keyword">return</span> <span class="number">42</span>; };</span><br><span class="line">cout &lt;&lt; <span class="built_in">f</span>() &lt;&lt; endl; <span class="comment">//æ‰“å°42</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="å‘lambdaä¼ é€’å‚æ•°">å‘lambdaä¼ é€’å‚æ•°</h3>
<ul>
<li><p>åŒ…å«å‚æ•°çš„lambdaè¡¨è¾¾å¼ï¼Œå¯ä½œä¸º<code>find_if</code>å‡½æ•°çš„ä¸€ä¸ªå‚æ•°</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[](<span class="type">const</span> string &amp;a, <span class="type">const</span> string &amp;b) { <span class="keyword">return</span> a.<span class="built_in">size</span>() &lt; b.<span class="built_in">size</span>(); }</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="ä½¿ç”¨æ•è·åˆ—è¡¨">ä½¿ç”¨æ•è·åˆ—è¡¨</h3>
<ul>
<li><p>lambdaè¡¨è¾¾å¼é€šè¿‡å°†å±€éƒ¨å˜é‡åŒ…å«åœ¨å…¶æ•è·åˆ—è¡¨ä¸­æ¥æŒ‡å‡ºå°†ä¼šä½¿ç”¨è¿™äº›å˜é‡ã€‚</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[sz](<span class="type">const</span> string &amp;a) { <span class="keyword">return</span> a.<span class="built_in">size</span>() &gt;= sz; };</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h2 id="å˜é‡çš„æ•è·æ–¹å¼">å˜é‡çš„æ•è·æ–¹å¼</h2>
<h3 id="å€¼æ•è·">å€¼æ•è·</h3>
<ul>
<li>lambdaé‡‡ç”¨å€¼æ•è·çš„æ–¹å¼ã€‚ä¸ä¼ å€¼å‚æ•°ç±»ä¼¼ï¼Œé‡‡ç”¨å€¼æ•è·çš„å‰ææ˜¯å˜é‡å¯ä»¥æ‹·è´ã€‚</li>
<li>ä¸å‚æ•°ä¸åŒï¼Œè¢«æ•è·çš„å˜é‡çš„å€¼æ˜¯åœ¨lambdaåˆ›å»ºæ—¶æ‹·è´ï¼Œè€Œä¸æ˜¯è°ƒç”¨æ—¶æ‹·è´</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">fcn1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">size_t</span> v1 = <span class="number">42</span>; <span class="comment">//å±€éƒ¨å˜é‡</span></span><br><span class="line">	<span class="comment">//å°†v1æ‹·è´åˆ°åä¸ºfçš„å¯è°ƒç”¨å¯¹è±¡</span></span><br><span class="line">	<span class="keyword">auto</span> f = [v1]{ <span class="keyword">return</span> v1; };</span><br><span class="line">	v1 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">auto</span> j = <span class="built_in">f</span>(); <span class="comment">// j ä¸º 42ï¼Œfä¿å­˜äº†æˆ‘ä»¬åˆ›å»ºå®ƒæ—¶v1çš„æ‹·è´</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="å¼•ç”¨æ•è·">å¼•ç”¨æ•è·</h3>
<ul>
<li>v1ä¹‹å‰çš„<code>&amp;</code>æŒ‡å‡ºv1åº”è¯¥ä»¥å¼•ç”¨æ–¹å¼æ•è·ã€‚</li>
<li>å½“æˆ‘ä»¬åœ¨lambdaå‡½æ•°ä½“å†…ä½¿ç”¨æ­¤å˜é‡æ—¶ï¼Œå®é™…ä¸Šä½¿ç”¨çš„æ˜¯å¼•ç”¨æ‰€ç»‘å®šçš„å¯¹è±¡ã€‚</li>
<li>åœ¨æœ¬ä¾‹ä¸­ï¼Œå½“lambdaè¿”å›v1æ—¶ï¼Œå®ƒè¿”å›çš„æ˜¯v1æŒ‡å‘çš„å¯¹è±¡çš„å€¼ã€‚</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">fcn1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">	<span class="type">size_t</span> v1 = <span class="number">42</span>; <span class="comment">//å±€éƒ¨å˜é‡</span></span><br><span class="line">	<span class="comment">// fåŒ…å«å¯¹v1çš„å¼•ç”¨</span></span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;v1]{ <span class="keyword">return</span> v1; };</span><br><span class="line">	v1 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">auto</span> j = <span class="built_in">f</span>(); <span class="comment">// j ä¸º 0ï¼Œfä¿å­˜äº†v1çš„å¼•ç”¨</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="éšå¼æ•è·">éšå¼æ•è·</h3>
<ul>
<li>è®©ç¼–è¯‘å™¨æ ¹æ®lambdaä½“ä¸­çš„ä»£ç æ¥æ¨æ–­æˆ‘ä»¬è¦ä½¿ç”¨å“ªäº›å˜é‡</li>
<li><code>&amp;</code>å‘Šè¯‰ç¼–è¯‘å™¨é‡‡ç”¨æ•è·å¼•ç”¨æ–¹å¼ï¼Œ<code>=</code>åˆ™è¡¨ç¤ºé‡‡ç”¨å€¼æ•è·æ–¹å¼</li>
<li>æ··åˆä½¿ç”¨éšå¼æ•è·å’Œæ˜¾å¼æ•è·æ—¶ï¼Œæ˜¾å¼æ•è·çš„å˜é‡å¿…é¡»ä½¿ç”¨ä¸éšå¼æ•è·ä¸åŒçš„æ–¹å¼ã€‚</li>
</ul>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// szä¸ºéšå¼æ•è·ï¼Œå€¼æ•è·æ–¹å¼ï¼Œè¿™é‡Œçš„lambdaè¡¨è¾¾å¼æ˜¯find_ifçš„ç¬¬ä¸‰ä¸ªå‚æ•°</span></span><br><span class="line">wc = <span class="built_in">find_if</span>(words.<span class="built_in">begin</span>(),words.<span class="built_in">end</span>(), </span><br><span class="line">             [=](<span class="type">const</span> string &amp;s)</span><br><span class="line">                { <span class="keyword">return</span> s.<span class="built_in">size</span>() &gt;= sz; });</span><br></pre></td></tr></tbody></table></figure>
<h2 id="å¯å˜lambda">å¯å˜lambda</h2>
<ul>
<li><p>å¯¹äºä¸€ä¸ªå€¼è¢«æ‹·è´çš„å˜é‡ï¼Œè‹¥è¦æ”¹å˜ä¸€ä¸ªè¢«æ•è·çš„å˜é‡çš„å€¼ï¼Œå°±å¿…é¡»åœ¨å‚æ•°åˆ—è¡¨é¦–åŠ ä¸Šå…³é”®å­—mutable</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">fen3</span><span class="params">()</span></span></span><br><span class="line"><span class="function"><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">size_t</span> v1 = <span class="number">42</span>;<span class="comment">//å±€éƒ¨å˜é‡</span></span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="comment">// få¯ä»¥æ”¹å˜å®ƒæ‰€æ•è·çš„å˜é‡çš„å€¼</span></span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">auto</span> f = [v1] ()  <span class="keyword">mutable</span> { <span class="keyword">return</span> ++v1;};</span></span></span><br><span class="line"><span class="params"><span class="function">	v1 =<span class="number">0</span>;</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="keyword">auto</span> j = f();<span class="comment">//jä¸º43</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span></span><br></pre></td></tr></tbody></table></figure></li>
<li><p>å¯¹äºå¼•ç”¨æ•è·çš„å˜é‡å¯ä»¥ç›´æ¥ä¿®æ”¹ï¼Œä¸ç”¨æ·»åŠ mutableå…³é”®å­—</p></li>
</ul>
<h2 id="æŒ‡å®šè¿”å›ç±»å‹">æŒ‡å®šè¿”å›ç±»å‹</h2>
<ul>
<li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªlambdaä½“åŒ…å«<code>return</code>ä¹‹å¤–çš„ä»»ä½•è¯­å¥ï¼Œåˆ™ç¼–è¯‘å™¨å‡å®šæ­¤lambdaè¿”å›voidã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç å°±æ˜¯é”™è¯¯çš„</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é”™è¯¯ï¼šä¸èƒ½æ¨æ–­lambdaçš„è¿”å›ç±»å‹</span></span><br><span class="line"><span class="built_in">transform</span>(vi.<span class="built_in">begin</span>(), vi.<span class="built_in">end</span>(), vi.<span class="built_in">begin</span>(),</span><br><span class="line">          [](<span class="type">int</span> i)</span><br><span class="line">            { <span class="keyword">if</span>(i&lt;<span class="number">0</span>) <span class="keyword">return</span> -i; <span class="keyword">else</span> <span class="keyword">return</span> i;};</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>è‹¥lambdaè¡¨è¾¾å¼åŒ…å«å…¶ä»–è¯­å¥ï¼Œä¸”è¿”å›å€¼å…¶å®ä¸æ˜¯voidï¼Œåˆ™ä½¿ç”¨å°¾ç½®è¿”å›ç±»å‹</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">transform</span>(vi.<span class="built_in">begin</span>(), vi.<span class="built_in">end</span>(), vi.<span class="built_in">begin</span>(),</span><br><span class="line">          [](<span class="type">int</span> i) -&gt; <span class="type">int</span>  <span class="comment">// è¿™é‡ŒæŒ‡å®šäº†è¿”å›ç±»å‹</span></span><br><span class="line">            { <span class="keyword">if</span>(i&lt;<span class="number">0</span>) <span class="keyword">return</span> -i; <span class="keyword">else</span> <span class="keyword">return</span> i; });</span><br></pre></td></tr></tbody></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/11/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/11/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">æœºå™¨å­¦ä¹ </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2024-11-24 00:00:00" itemprop="dateCreated datePublished" datetime="2024-11-24T00:00:00+08:00">2024-11-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-07-29 23:34:20" itemprop="dateModified" datetime="2025-07-29T23:34:20+08:00">2025-07-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æœºå™¨å­¦ä¹ </span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
              <span>4k</span>
            </span>
            <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
              <span>4 åˆ†é’Ÿ</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ç›‘ç£å­¦ä¹ ">ç›‘ç£å­¦ä¹ </h2>
<p>åº”ç”¨æœ€å¤š</p>
<h3 id="å›å½’regression">å›å½’ï¼ˆregressionï¼‰</h3>
<ul>
<li>ç»™å®šè¾“å…¥å’Œè¾“å‡ºï¼Œå¾—åˆ°æ˜ å°„å‡½æ•°ï¼Œå†æ ¹æ®ä¸åŒè¾“å…¥è¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°è¾“å‡ºï¼ˆæ— é™çš„å¯èƒ½ï¼‰</li>
</ul>
<h4 id="ä»£ä»·å‡½æ•°">ä»£ä»·å‡½æ•°</h4>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241121191024821.png" alt="image-20241121191024821">
<figcaption aria-hidden="true">image-20241121191024821</figcaption>
</figure>
<p>çº¿æ€§å›å½’çš„ä»£ä»·å‡½æ•°<code>J</code>ä¸å˜é‡<code>w</code>å’Œ<code>b</code>çš„å›¾åƒæ˜¯ä¸‰ç»´çš„ï¼Œç±»ä¼¼äºç¢—çŠ¶</p>
<h4 id="çº¿æ€§å›å½’">çº¿æ€§å›å½’</h4>
<ul>
<li>è®­ç»ƒé›†</li>
</ul>
<h4 id="å¤šå…ƒçº¿æ€§å›å½’">å¤šå…ƒçº¿æ€§å›å½’</h4>
<p>ç³»æ•°å‘é‡åŒ–</p>
<ul>
<li><p><strong>ç‰¹å¾ç¼©æ”¾</strong>ï¼ˆfeatures
scalingï¼‰ï¼šä¸åŒç‰¹å¾çš„ä¸åŒå–å€¼èŒƒå›´å¯¼è‡´ç­‰é«˜çº¿å›¾åƒç»†é•¿ï¼Œéœ€è¦ç¼©æ”¾ç‰¹å¾å€¼ä½¿å›¾åƒæ›´åŠ å‡åŒ€</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241126134526107.png" alt="image-20241126134526107">
<figcaption aria-hidden="true">image-20241126134526107</figcaption>
</figure></li>
<li><p><strong>å‡å€¼å½’ä¸€åŒ–</strong>ï¼ˆmean normalizationï¼‰</p></li>
<li><p>Z-score æ ‡å‡†åŒ–</p></li>
</ul>
<h4 id="ç‰¹å¾å·¥ç¨‹">ç‰¹å¾å·¥ç¨‹</h4>
<p>åˆ›å»ºæ–°çš„ç‰¹å¾ï¼Œå¾—åˆ°æ–°çš„æ¨¡å‹</p>
<h4 id="å¤šé¡¹å¼å›å½’">å¤šé¡¹å¼å›å½’</h4>
<ul>
<li><p>åŒ…å«é«˜æ¬¡é¡¹</p></li>
<li><p>å¤šé¡¹å¼å›å½’æ˜¯ä¸€ç§æ‰©å±•çº¿æ€§å›å½’çš„æ–¹æ³•</p></li>
</ul>
<h3 id="æ¢¯åº¦ä¸‹é™">æ¢¯åº¦ä¸‹é™</h3>
<p><strong>ã€Œæ¢¯åº¦çš„æ¦‚å¿µã€</strong>ï¼šæ¢¯åº¦å°±æ˜¯å‡½æ•°å¯¹å®ƒçš„å„ä¸ªè‡ªå˜é‡æ±‚åå¯¼åï¼Œç”±<a target="_blank" rel="noopener" href="https://zhida.zhihu.com/search?content_id=146213942&amp;content_type=Article&amp;match_order=1&amp;q=åå¯¼æ•°&amp;zhida_source=entity">åå¯¼æ•°</a>ç»„æˆçš„ä¸€ä¸ªå‘é‡ã€‚</p>
<p>å¯ä»¥ç”¨æ¥æœ€å°åŒ–ä»»æ„å‡½æ•°</p>
<ul>
<li><p>æ‰¾åˆ°ä»£ä»·å‡½æ•°çš„å±€éƒ¨æœ€å°å€¼å³æå°å€¼ï¼ˆåœ¨ä»£ä»·å‡½æ•°çš„å›¾åƒä¸Šï¼Œæœä¸åŒæ–¹å‘æ‰¾åˆ°æå°å€¼ï¼‰</p></li>
<li><p>å­¦ä¹ ç‡ï¼ˆlearning rateï¼‰ï¼šÎ±ï¼Œå½±å“æ¢¯åº¦ä¸‹é™çš„å¿«æ…¢</p></li>
<li><p>ç”¨åˆ°äº†åå¯¼ï¼Œ<code>w</code>å’Œ<code>b</code>éœ€è¦åŒæ—¶æ›´æ–°</p>
<p><code>J</code>å¯¹<code>w</code>çš„åå¯¼è¡¨ç¤º<code>J</code>å’Œ<code>w</code>ç»„æˆçš„å‡½æ•°å›¾åƒçš„åˆ‡çº¿æ–œç‡</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241123134344175.png" alt="image-20241123134344175">
<figcaption aria-hidden="true">image-20241123134344175</figcaption>
</figure></li>
<li><p>æ‰¹é‡ï¼ˆbatchï¼‰æ¢¯åº¦ä¸‹é™ï¼šæ¯ä¸€æ­¥æ¢¯åº¦ä¸‹é™ä½¿ç”¨çš„æ˜¯æ‰€æœ‰çš„è®­ç»ƒç¤ºä¾‹</p>
<p><strong>small batch çš„å‡†ç¡®ç‡å¯èƒ½æ˜¯å¤§äº large batch
çš„ï¼Œè¿™æ˜¯ä¼˜åŒ–é—®é¢˜ï¼ˆæ¢¯åº¦ä¸‹é™æ‰¾æœ€å°å€¼ï¼‰ï¼Œè€Œä¸æ˜¯overfitting</strong></p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250624200237130.png" alt="image-20250624200237130">
<figcaption aria-hidden="true">image-20250624200237130</figcaption>
</figure></li>
</ul>
<blockquote>
<p>æ¢¯åº¦ä¸‹é™å¯»æ‰¾æœ€å°å€¼å¯èƒ½ä¸å‡†ç¡®ï¼Œå› ä¸ºå¯èƒ½æ˜¯å±€éƒ¨æœ€å°å€¼ï¼Œå¦‚æœmodelçµæ´»æ€§è¾ƒé«˜ï¼ˆå¤šå±‚ï¼‰ä½†æ˜¯å…¶lossæ¯”çµæ´»æ€§è¾ƒä½çš„modelçš„lossæ›´é«˜ï¼Œè¯´æ˜å°±æ˜¯ä¼˜åŒ–é—®é¢˜ï¼ˆæ²¡æ‰¾åˆ°æœ€å°å€¼ï¼‰ï¼Œä½†æ˜¯è¦æ³¨æ„<strong>éç‚¹</strong></p>
</blockquote>
<h4 id="batch-å’Œ-epoch">Batch å’Œ Epoch</h4>
<ul>
<li><strong>Batchï¼ˆæ‰¹ï¼‰</strong>ï¼šæ ·æœ¬è¢«åˆ†ä¸ºå¤šä¸ªbatchï¼Œ<strong>ä¸€ä¸ª
Batch çš„æ•°æ®ä¼šç”¨äºè®¡ç®—ä¸€æ¬¡æ¢¯åº¦ï¼Œå¹¶æ›´æ–°æ•´ä¸ªæ¨¡å‹çš„æ‰€æœ‰å‚æ•°</strong>
<ul>
<li>ä¾‹å¦‚ï¼šæ•°æ®é›† = 1000 å¼ å›¾ç‰‡ï¼ŒBatch Size = 50 å¼ å›¾ç‰‡</li>
</ul></li>
<li><strong>Iterationï¼ˆè¿­ä»£ï¼‰</strong>ï¼šå¤„ç†<strong>ä¸€ä¸ª Batch</strong>
å¹¶æ›´æ–°ä¸€æ¬¡æ¨¡å‹å‚æ•°ã€‚
<ul>
<li>æ¯æ¬¡è¿­ä»£ = ä¸€æ¬¡å‰å‘ä¼ æ’­ + åå‘ä¼ æ’­ + å‚æ•°æ›´æ–°ï¼ˆæ›´æ–°æ‰€æœ‰å‚æ•°ï¼‰ã€‚</li>
</ul></li>
<li><strong>Epochï¼ˆå‘¨æœŸï¼‰</strong>ï¼šå®Œæ•´éå†<strong>æ•´ä¸ªè®­ç»ƒé›†ä¸€æ¬¡</strong>ï¼ˆæ‰€æœ‰
Batch è·‘å®Œï¼‰ã€‚
<ul>
<li>ä¾‹å¦‚ï¼šæ•°æ®æ€»é‡=1000ï¼ŒBatch Size=100 â†’ 1 Epoch = 10 Batchesï¼ˆè¿­ä»£ï¼‰=
1000ï¼ˆæ€»æ ·æœ¬æ•°ï¼‰ã€‚</li>
</ul></li>
</ul>
<h4 id="è§£å†³å±€éƒ¨æœ€å°å€¼">è§£å†³å±€éƒ¨æœ€å°å€¼</h4>
<h5 id="åŠ¨é‡">åŠ¨é‡</h5>
<p>å½“å‰è¿›è¡Œæ¢¯åº¦ä¸‹é™æ—¶éœ€è¦è€ƒè™‘ä¹‹å‰ä¸‹é™çš„æ–¹å‘ï¼Œå åŠ åœ¨ä¸€èµ·</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250624200953949.png" alt="image-20250624200953949">
<figcaption aria-hidden="true">image-20250624200953949</figcaption>
</figure>
<h5 id="è‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡">è‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡</h5>
<blockquote>
<p>å›ºå®šå­¦ä¹ ç‡çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>å­¦ä¹ ç‡å¤ªå°ï¼šæ”¶æ•›é€Ÿåº¦æ…¢ã€‚</li>
<li>å­¦ä¹ ç‡å¤ªå¤§ï¼šå¯èƒ½éœ‡è¡ç”šè‡³æ— æ³•æ”¶æ•›ã€‚</li>
</ul>
</blockquote>
<ol type="1">
<li><p><strong>Adagrad</strong></p>
<ul>
<li><p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šä¸ºæ¯ä¸ªå‚æ•°ç´¯ç§¯å†å²æ¢¯åº¦ï¼ˆåå¯¼æ•°ï¼Œæœ‰æ–¹å‘ï¼‰çš„å¹³æ–¹ï¼Œè‡ªé€‚åº”é™ä½é¢‘ç¹æ›´æ–°å‚æ•°çš„å­¦ä¹ ç‡ã€‚</p>
<blockquote>
<p><strong>æ¢¯åº¦ä¸åå¯¼æ•°çš„å…³ç³»</strong></p>
<ul>
<li><strong>æ¢¯åº¦æ˜¯åå¯¼æ•°çš„å‘é‡ç»„åˆ</strong>ï¼šæ¢¯åº¦å°†æ‰€æœ‰åå¯¼æ•°æ‰“åŒ…æˆä¸€ä¸ªå‘é‡ï¼Œæä¾›äº†å…¨å±€çš„â€œå˜åŒ–ä¿¡æ¯â€ã€‚</li>
<li><strong>æ–¹å‘æ˜¯æ¢¯åº¦çš„å†…åœ¨å±æ€§</strong>ï¼šæ¢¯åº¦æœ¬èº«å·²ç»åŒ…å«äº†æ–¹å‘ï¼ˆæœ€é™¡ä¸Šå‡æ–¹å‘ï¼‰ï¼Œä¸éœ€è¦é¢å¤–â€œåŠ ä¸Šæ–¹å‘â€ã€‚</li>
<li><strong>åå¯¼æ•°æ˜¯æ¢¯åº¦çš„åˆ†é‡</strong>ï¼šæ¯ä¸ªåå¯¼æ•°æ˜¯æ¢¯åº¦å‘é‡åœ¨å¯¹åº”åæ ‡è½´ä¸Šçš„æŠ•å½±ã€‚</li>
</ul>
</blockquote></li>
<li><p><strong>æ›´æ–°è§„åˆ™</strong>ï¼š</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250625171230513.png" alt="image-20250625171230513">
<figcaption aria-hidden="true">image-20250625171230513</figcaption>
</figure></li>
</ul></li>
<li><p><strong>RMSprop</strong></p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250625172119618.png" alt="image-20250625172119618">
<figcaption aria-hidden="true">image-20250625172119618</figcaption>
</figure></li>
<li><p><strong>Adam</strong>ï¼ˆMomentum + RMSpropï¼‰</p></li>
</ol>
<blockquote>
<p>learning rate schedulingï¼ˆä¸¤ç§æ–¹æ³•ï¼‰</p>
<ul>
<li>learning rate decayï¼šè®© Î· éšç€æ—¶é—´å‡å°ï¼Œå¯ä»¥é˜²æ­¢å­¦ä¹ ç‡æš´æ¶¨</li>
<li>warm upï¼šÎ· å…ˆå˜å¤§åå‡å°</li>
</ul>
</blockquote>
<h4 id="ä¼˜åŒ–æ–¹æ³•">ä¼˜åŒ–æ–¹æ³•</h4>
<p>feature normalizationï¼šä½¿å¾—å‚æ•°çš„å›¾åƒæ›´å‡åŒ€ï¼Œæ›´æ–¹ä¾¿æ¢¯åº¦ä¸‹é™</p>
<p>ç”±äºGPUå†…å­˜æœ‰é™ï¼Œå› æ­¤æ¯æ¬¡å¯¹ä¸€ä¸ªbatchçš„æ•°æ®è¿›è¡Œnormalizationï¼Œç§°ä¸º
batch normalization</p>
<h3 id="åˆ†ç±»classification">åˆ†ç±»ï¼ˆclassificationï¼‰</h3>
<ul>
<li>åˆ†ç±»é¢„æµ‹çš„ç»“æœæ˜¯ä»æœ‰é™çš„å¯èƒ½ä¸­é€‰å–ä¸€ä¸ª</li>
</ul>
<h4 id="é€»è¾‘å›å½’">é€»è¾‘å›å½’</h4>
<ul>
<li><p>sigmoidå‡½æ•°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241202234353128.png" alt="image-20241202234353128">
<figcaption aria-hidden="true">image-20241202234353128</figcaption>
</figure></li>
<li><p>å†³ç­–è¾¹ç•Œï¼šz = 0</p></li>
<li><p><strong>æŸå¤±å‡½æ•°</strong>ï¼šå¯¹ä¸€ä¸ªè®­ç»ƒæ ·æœ¬è¿›è¡Œè®¡ç®—</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241203141912797.png" alt="image-20241203141912797">
<figcaption aria-hidden="true">image-20241203141912797</figcaption>
</figure>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241203142006274.png" alt="image-20241203142006274">
<figcaption aria-hidden="true">image-20241203142006274</figcaption>
</figure></li>
</ul>
<h3 id="è¿‡æ‹Ÿåˆ">è¿‡æ‹Ÿåˆ</h3>
<p>æ¬ æ‹Ÿåˆ = é«˜åå·®</p>
<p>è¿‡æ‹Ÿåˆ = é«˜æ–¹å·®</p>
<h4 id="è§£å†³è¿‡æ‹Ÿåˆ">è§£å†³è¿‡æ‹Ÿåˆ</h4>
<ul>
<li><p>å¢åŠ è®­ç»ƒé›†çš„æ ·æœ¬æ•°</p></li>
<li><p>å‡å°‘ç‰¹å¾ï¼ˆfeatureï¼‰</p></li>
<li><p>æ­£åˆ™åŒ–ï¼ˆæ•ˆæœç­‰ä»·äºä¿®æ”¹ç³»æ•°w<sub>j</sub>ï¼‰ï¼šåœ¨ä»£ä»·å‡½æ•°åæ·»åŠ ä¸€ä¸ªå¼å­ï¼Œä½¿ç”¨
Î» ç³»æ•°</p>
<ul>
<li>Î» ä¸º 0ï¼Œåˆ™è¿‡æ‹Ÿåˆ</li>
<li>Î» è¿‡å¤§ï¼Œåˆ™æ¬ æ‹Ÿåˆ</li>
</ul>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241203141830047.png" alt="image-20241203141830047">
<figcaption aria-hidden="true">image-20241203141830047</figcaption>
</figure></li>
</ul>
<h2 id="éç›‘ç£å­¦ä¹ ">éç›‘ç£å­¦ä¹ </h2>
<ul>
<li>èšç±»-clusteringï¼šåœ¨æ²¡æœ‰æ ‡ç­¾çš„æƒ…å†µä¸‹è·å–æ•°æ®ï¼Œå¹¶è‡ªåŠ¨å°†å®ƒä»¬åˆ†ç»„åˆ°ä¸åŒé›†ç¾¤ä¸­ï¼ˆèšç±»-clusteringï¼‰</li>
<li>å¼‚å¸¸æ£€æµ‹-anomaly detectionï¼šæ‰¾åˆ°å¼‚å¸¸æ•°æ®</li>
<li>é™ç»´-dimensionality reductionï¼šå°†å¤§æ•°æ®é›†å‹ç¼©ä¸ºè¾ƒå°çš„æ•°æ®é›†</li>
</ul>
<h2 id="æ·±åº¦å­¦ä¹ ">æ·±åº¦å­¦ä¹ </h2>
<h3 id="ç¥ç»å…ƒ">ç¥ç»å…ƒ</h3>
<ul>
<li>å•ä¸ªç¥ç»å…ƒï¼šå¤šä¸ªè¾“å…¥ä¸€ä¸ªè¾“å‡º</li>
</ul>
<h3 id="å±‚">å±‚</h3>
<ul>
<li>éšè—å±‚ï¼šæ¯å±‚å¯ä»¥åŒ…å«å¤šä¸ªç¥ç»å…ƒ</li>
<li>é»˜è®¤æ˜¯å…¨è¿æ¥å±‚ï¼ˆdense layerï¼Œå¯†é›†å±‚ï¼‰</li>
</ul>
<h3 id="å‰å‘ä¼ æ’­">å‰å‘ä¼ æ’­</h3>
<ul>
<li>ç”±è¾“å…¥ç»è¿‡ç¥ç»å…ƒå¾—åˆ°è¾“å‡ºçš„è¿‡ç¨‹ï¼ˆåšå‡ºé¢„æµ‹ï¼‰</li>
</ul>
<h3 id="æ¿€æ´»å‡½æ•°">æ¿€æ´»å‡½æ•°</h3>
<ul>
<li><p>æ¿€æ´»å‡½æ•°æ˜¯å¯¹ç¥ç»ç½‘ç»œçš„éšè—å±‚å’Œè¾“å‡ºå±‚ä½¿ç”¨çš„ï¼Œè€Œä¸æ˜¯ç¥ç»å…ƒ</p></li>
<li><p>å¯¹äºè¾“å‡ºå±‚æ ¹æ®è¾“å‡ºæ¥å†³å®šä½¿ç”¨å“ªä¸ªæ¿€æ´»å‡½æ•°</p></li>
<li><p>å¯¹äºéšè—å±‚æ¨èé»˜è®¤ä½¿ç”¨ReLUå‡½æ•°</p></li>
<li><p>ReLUå‡½æ•°</p></li>
<li><p>Sigmoidå‡½æ•°ï¼šéœ€è¦è®¡ç®—æŒ‡æ•°ï¼Œæ•ˆç‡æ¯”ReLUä½</p></li>
</ul>
<h3 id="çŸ¢é‡åŒ–">çŸ¢é‡åŒ–</h3>
<p>çŸ©é˜µä¹˜æ³•ï¼Œç®€åŒ–è®¡ç®—</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241209123759484.png" alt="image-20241209123759484">
<figcaption aria-hidden="true">image-20241209123759484</figcaption>
</figure>
<h3 id="åå‘ä¼ æ’­">åå‘ä¼ æ’­</h3>
<p>è®¡ç®—åå¯¼æ•°</p>
<h3 id="å¤šç±»">å¤šç±»</h3>
<h4 id="softmax">Softmax</h4>
<p>å’Œ cross-entropy ç»‘å®šä½¿ç”¨</p>
<ul>
<li><p>Softmaxæ˜¯é€»è¾‘å›å½’çš„æ¨å¹¿</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241214232411429.png" alt="image-20241214232411429">
<figcaption aria-hidden="true">image-20241214232411429</figcaption>
</figure></li>
<li><p>æŸå¤±å‡½æ•°å’Œä»£ä»·å‡½æ•°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241214232510217.png" alt="image-20241214232510217">
<figcaption aria-hidden="true">image-20241214232510217</figcaption>
</figure></li>
<li><p>Softmaxå¯ä½œä¸ºæ¿€æ´»å‡½æ•°</p></li>
</ul>
<h4 id="å¤šæ ‡ç­¾åˆ†ç±»">å¤šæ ‡ç­¾åˆ†ç±»</h4>
<ul>
<li>y çš„è¾“å‡ºä¸æ­¢ä¸€ä¸ªå€¼</li>
</ul>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241215204101106.png" alt="image-20241215204101106">
<figcaption aria-hidden="true">image-20241215204101106</figcaption>
</figure>
<h3 id="é«˜çº§ä¼˜åŒ–æ–¹æ³•">é«˜çº§ä¼˜åŒ–æ–¹æ³•</h3>
<h4 id="adam-algorithm">Adam Algorithm</h4>
<ul>
<li>è‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡</li>
<li>å¯¹æ¯ä¸ªå‚æ•°ï¼ˆw<sub>1</sub>ã€w<sub>2</sub>......bï¼‰æœ‰ä¸åŒçš„å­¦ä¹ ç‡</li>
</ul>
<h3 id="å·ç§¯ç¥ç»ç½‘ç»œ">å·ç§¯ç¥ç»ç½‘ç»œ</h3>
<p>åŒ…å«å¤šä¸ªå·ç§¯å±‚</p>
<h4 id="å·ç§¯å±‚">å·ç§¯å±‚</h4>
<ul>
<li>æ¯ä¸ªç¥ç»å…ƒåªå¤„ç†å›¾åƒçš„ä¸€éƒ¨åˆ†</li>
</ul>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241215230834569.png" alt="image-20241215230834569">
<figcaption aria-hidden="true">image-20241215230834569</figcaption>
</figure>
<h4 id="transformer">Transformer</h4>
<h5 id="è‡ªæ³¨æ„åŠ›æœºåˆ¶">è‡ªæ³¨æ„åŠ›æœºåˆ¶</h5>
<p>ä½¿ç”¨ qã€kã€v è®¡ç®—</p>
<p><strong>å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong></p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250720221746017.png" alt="image-20250720221746017">
<figcaption aria-hidden="true">image-20250720221746017</figcaption>
</figure>
<h5 id="positional-encoding">Positional Encoding</h5>
<p>æ·»åŠ ä½ç½®ä¿¡æ¯ e</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20250720222510647.png" alt="image-20250720222510647">
<figcaption aria-hidden="true">image-20250720222510647</figcaption>
</figure>
<h3 id="æ¨¡å‹è¯„ä¼°">æ¨¡å‹è¯„ä¼°</h3>
<h4 id="å°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†">å°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†</h4>
<ul>
<li><p>çº¿æ€§å›å½’ï¼šä½¿ç”¨ä»£ä»·å‡½æ•°è¯„ä¼°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216140940862.png" alt="image-20241216140940862">
<figcaption aria-hidden="true">image-20241216140940862</figcaption>
</figure></li>
<li><p>é€»è¾‘å›å½’ï¼ˆåˆ†ç±»é—®é¢˜ï¼‰ï¼šä½¿ç”¨ä»£ä»·å‡½æ•°è¯„ä¼°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216141510260.png" alt="image-20241216141510260">
<figcaption aria-hidden="true">image-20241216141510260</figcaption>
</figure>
<p>æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è¯„ä¼°æ¨¡å‹ï¼šç»Ÿè®¡é¢„æµ‹å€¼ä¸å®é™…å€¼ä¸åŒ¹é…çš„æ ·æœ¬æ•°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216141734150.png" alt="image-20241216141734150">
<figcaption aria-hidden="true">image-20241216141734150</figcaption>
</figure></li>
</ul>
<h4 id="æŠŠæ•°æ®é›†åˆ†æˆè®­ç»ƒé›†äº¤å‰éªŒè¯é›†æµ‹è¯•é›†">æŠŠæ•°æ®é›†åˆ†æˆè®­ç»ƒé›†ã€äº¤å‰éªŒè¯é›†ã€æµ‹è¯•é›†</h4>
<ul>
<li><p>äº¤å‰éªŒè¯é›†ï¼šcross validation setï¼ˆæˆ–è€…validation setã€development
setã€dev setï¼‰</p></li>
<li><p>æ¨¡å‹é€‰æ‹©ï¼Œé€‰æ‹©<strong>äº¤å‰éªŒè¯é›†</strong>è¯¯å·®æœ€å°çš„æ¨¡å‹ï¼Œç„¶åç”¨<strong>æµ‹è¯•é›†</strong>è¿›è¡Œè¯„ä¼°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216150120549.png" alt="image-20241216150120549">
<figcaption aria-hidden="true">image-20241216150120549</figcaption>
</figure>
<p>å›¾ä¸­çš„ d è¡¨ç¤ºå¤šé¡¹å¼çš„åº¦</p></li>
<li><p>å¯¹äºä¸åŒå¤šé¡¹å¼ï¼ŒJ<sub>cv</sub> å’Œ J<sub>train</sub>
çš„å…³ç³»ï¼šæ¨ªåæ ‡è¡¨ç¤ºå¤šé¡¹å¼çš„åº¦å³æœ€é«˜æ¬¡çš„å€¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216153505696.png" alt="image-20241216153505696" style="zoom:67%;"></p></li>
</ul>
<h3 id="åå·®ä¸æ–¹å·®">åå·®ä¸æ–¹å·®</h3>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216151835365.png" alt="image-20241216151835365">
<figcaption aria-hidden="true">image-20241216151835365</figcaption>
</figure>
<h4 id="æ­£åˆ™åŒ–">æ­£åˆ™åŒ–</h4>
<p>é€‰æ‹©åˆé€‚çš„ Î» è¿›è¡Œæ­£åˆ™åŒ–ï¼Œé˜²æ­¢æ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆ</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216152925723.png" alt="image-20241216152925723">
<figcaption aria-hidden="true">image-20241216152925723</figcaption>
</figure>
<ul>
<li>å¦‚ä½•é€‰æ‹© Î»ï¼šå–ä¸åŒçš„ Î»
å€¼ï¼Œè®¡ç®—äº¤å‰éªŒè¯é›†çš„è¯¯å·®ï¼Œé€‰æ‹©æœ€å°çš„ï¼Œç„¶åç”¨æµ‹è¯•é›†çš„è¯¯å·®è¿›è¡Œè¯„ä¼°</li>
</ul>
<h4 id="åŸºå‡†">åŸºå‡†</h4>
<p>é€šè¿‡å»ºç«‹åŸºå‡†åˆ¤æ–­æ˜¯å¦é«˜æ–¹å·®æˆ–é«˜åå·®</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216160855644.png" alt="image-20241216160855644">
<figcaption aria-hidden="true">image-20241216160855644</figcaption>
</figure>
<h4 id="å­¦ä¹ æ›²çº¿">å­¦ä¹ æ›²çº¿</h4>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216161331618.png" alt="image-20241216161331618">
<figcaption aria-hidden="true">image-20241216161331618</figcaption>
</figure>
<ul>
<li><p>é«˜åå·®æƒ…å†µä¸‹ï¼šå¢å¤§è®­ç»ƒé›†æ ·æœ¬æ•°é‡ä¸ä¼šé™ä½å¤šå°‘é”™è¯¯ç‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216162308834.png" alt="image-20241216162308834" style="zoom:80%;"></p></li>
<li><p>é«˜æ–¹å·®æƒ…å†µä¸‹ï¼šå¢å¤§è®­ç»ƒé›†æ ·æœ¬æ•°é‡èƒ½å¤Ÿé™ä½é”™è¯¯ç‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216162653266.png" alt="image-20241216162653266" style="zoom:80%;"></p></li>
</ul>
<h4 id="æ€»ç»“">æ€»ç»“</h4>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216163658454.png" alt="image-20241216163658454">
<figcaption aria-hidden="true">image-20241216163658454</figcaption>
</figure>
<ol type="1">
<li>ä¿®å¤é«˜æ–¹å·®çš„æ–¹æ³•
<ul>
<li>å¢åŠ è®­ç»ƒé›†æ ·æœ¬</li>
<li>ä½¿ç”¨æ›´å°çš„ç‰¹å¾é›†åˆ</li>
<li>å¢å¤§ Î»</li>
</ul></li>
<li>ä¿®å¤é«˜åå·®çš„æ–¹æ³•
<ul>
<li>å¢åŠ ç‰¹å¾</li>
<li>å¢åŠ å¤šé¡¹å¼ç‰¹å¾ï¼ˆxçš„é«˜æ¬¡æ–¹ï¼‰</li>
<li>å‡å° Î»</li>
</ul></li>
</ol>
<h3 id="æœºå™¨å­¦ä¹ çš„è¿­ä»£">æœºå™¨å­¦ä¹ çš„è¿­ä»£</h3>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241216165124224.png" alt="image-20241216165124224">
<figcaption aria-hidden="true">image-20241216165124224</figcaption>
</figure>
<h4 id="è¯¯å·®åˆ†æ">è¯¯å·®åˆ†æ</h4>
<h3 id="è¿ç§»å­¦ä¹ ">è¿ç§»å­¦ä¹ </h3>
<p>å°†è®­ç»ƒå¥½çš„ç¥ç»ç½‘ç»œçš„å‚æ•°åº”ç”¨åœ¨æ–°çš„ç¥ç»ç½‘ç»œä¸Šã€‚</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼šå°†è¯†åˆ«ç‰©ä½“çš„ç¥ç»ç½‘ç»œåº”ç”¨åœ¨è¯†åˆ«æ‰‹å†™æ•°å­—ä¸Šï¼Œæ‰‹å†™æ•°å­—è¯†åˆ«ç¥ç»ç½‘ç»œçš„å‰å››å±‚å‚æ•°ç›´æ¥å¼•ç”¨ç‰©ä½“è¯†åˆ«ç¥ç»ç½‘ç»œçš„å‰å››å±‚å‚æ•°ï¼Œåªæœ‰è¾“å‡ºå±‚å‚æ•°ä¸åŒï¼Œç„¶åè¿›è¡Œè®­ç»ƒï¼Œè®­ç»ƒæ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>åªè®­ç»ƒè¾“å‡ºå±‚å‚æ•°</li>
<li>è®­ç»ƒæ‰€æœ‰å±‚çš„å‚æ•°ï¼Œä½†æ˜¯å‰å‡ å±‚å‚æ•°çš„åˆå§‹å€¼è®¾ç½®ä¸ºå¦ä¸€ä¸ªç¥ç»ç½‘ç»œçš„å‰å‡ å±‚å‚æ•°</li>
</ul>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241218191916654.png" alt="image-20241218191916654">
<figcaption aria-hidden="true">image-20241218191916654</figcaption>
</figure>
<h3 id="ç²¾ç¡®ç‡å’Œå¬å›ç‡">ç²¾ç¡®ç‡å’Œå¬å›ç‡</h3>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241218201602616.png" alt="image-20241218201602616">
<figcaption aria-hidden="true">image-20241218201602616</figcaption>
</figure>
<ul>
<li><p>ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰æ˜¯æŒ‡æ­£ç¡®è¯†åˆ«çš„é˜³æ€§æ ·æœ¬ä¸æ‰€æœ‰æ ‡è®°ä¸ºé˜³æ€§çš„æ ·æœ¬çš„æ¯”ä¾‹ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå¯ä»¥ç†è§£ä¸ºåœ¨æ‰€æœ‰æ ‡è®°ä¸ºé˜³æ€§ç»“æœä¸­ï¼ŒçœŸæ­£é˜³æ€§çš„æ¯”ä¾‹ã€‚ç²¾ç¡®ç‡é«˜æ„å‘³ç€æ¼è¯Šå°‘ï¼Œä½†å¯èƒ½ä¼šå› ä¸ºè¿‡åº¦ä¸¥æ ¼è€Œå°†ä¸€äº›çœŸæ­£é˜³æ€§æ ·æœ¬è¯¯è®¤ä¸ºæ˜¯é˜´æ€§ã€‚</p></li>
<li><p>å¬å›ç‡ï¼ˆRecallï¼‰æ˜¯æŒ‡æ‰€æœ‰çœŸæ­£é˜³æ€§æ ·æœ¬ä¸­è¢«æ­£ç¡®è¯†åˆ«çš„æ¯”ä¾‹ã€‚å¬å›ç‡é«˜æ„å‘³ç€å¾ˆå°‘æ¼è¯Šï¼Œå³å°½å¯èƒ½å¤šåœ°å°†é˜³æ€§æ ·æœ¬è¯†åˆ«å‡ºæ¥ï¼Œä½†å¯èƒ½ä¼šå› ä¸ºè¿‡åº¦å®½æ¾è€Œå°†ä¸€äº›çœŸæ­£é˜´æ€§æ ·æœ¬è¯¯è®¤ä¸ºæ˜¯é˜³æ€§ã€‚</p></li>
</ul>
<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå½“è¯•å›¾æé«˜å¬å›ç‡æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé™ä½ç²¾ç¡®ç‡ï¼Œå› ä¸ºæ›´å®½æ¾çš„åˆ¤å®šæ ‡å‡†å¯èƒ½ä¼šå¯¼è‡´æ›´å¤šçš„è¯¯åˆ¤ã€‚ç›¸åï¼Œæé«˜ç²¾ç¡®ç‡å¯èƒ½ä¼šå¯¼è‡´å¬å›ç‡ä¸‹é™ï¼Œå› ä¸ºæ›´ä¸¥æ ¼çš„åˆ¤å®šæ ‡å‡†å¯èƒ½é”™è¿‡ä¸€äº›çœŸæ­£çš„é˜³æ€§æ ·æœ¬ã€‚è¿™ç§æƒè¡¡å…³ç³»å¯¼è‡´äº†ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„çŸ›ç›¾ã€‚</p>
<h3 id="å†³ç­–æ ‘æ¨¡å‹">å†³ç­–æ ‘æ¨¡å‹</h3>
<ul>
<li><p>æ¯ä¸ªéå¶å­èŠ‚ç‚¹æ˜¯ç‰¹å¾</p></li>
<li><p>é™åˆ¶å†³ç­–æ ‘çš„é«˜åº¦</p></li>
<li><p>entropyï¼ˆç†µï¼‰ï¼šç†µè¡¨ç¤ºä¿¡æ¯çš„ä¸ç¡®å®šæ€§æˆ–ä¿¡æ¯é‡çš„å¤§å°ã€‚ç†µè¶Šé«˜ï¼Œæ„å‘³ç€ç³»ç»Ÿè¶Šæ··ä¹±æˆ–ä¿¡æ¯è¶Šä¸ç¡®å®š</p>
<p>ä¸‹å›¾ä¸­Hæ˜¯è®¡ç®—ç†µçš„å‡½æ•°</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241221141609541.png" alt="image-20241221141609541">
<figcaption aria-hidden="true">image-20241221141609541</figcaption>
</figure></li>
<li><p>One hot
encodingï¼šè§£å†³å¤šç±»é—®é¢˜ï¼Œä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºç‰¹å¾ï¼Œæ–¹ä¾¿è¾“å…¥ç¥ç»ç½‘ç»œ</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20241221144408684.png" alt="image-20241221144408684">
<figcaption aria-hidden="true">image-20241221144408684</figcaption>
</figure></li>
</ul>
<h3 id="å›å½’æ ‘">å›å½’æ ‘</h3>
<p>å¯é¢„æµ‹è¿ç»­çš„å…·ä½“çš„æ•°å€¼</p>
<h3 id="å¤šä¸ªå†³ç­–æ ‘">å¤šä¸ªå†³ç­–æ ‘</h3>
<ul>
<li>é¦–å…ˆé€šè¿‡æ”¾å›æŠ½æ ·è·å–ä¸åŒçš„æ•°æ®é›†</li>
<li>å¯¹äºä¸åŒçš„æ•°æ®é›†å¯èƒ½å¾—åˆ°ä¸åŒçš„å†³ç­–æ ‘</li>
<li>æ ¹æ®ä¸Šè¿°å¾—åˆ°çš„å¤šä¸ªå†³ç­–æ ‘é¢„æµ‹ç»“æœï¼Œå¯¹ç»“æœè¿›è¡ŒæŠ•ç¥¨å¾—åˆ°æœ€ç»ˆç»“æœ</li>
<li>ç¼ºç‚¹ï¼šä¸åŒå†³ç­–æ ‘ä¹‹é—´å¯èƒ½å·®å¼‚è¾ƒå°</li>
</ul>
<h3 id="éšæœºæ£®æ—ç®—æ³•">éšæœºæ£®æ—ç®—æ³•</h3>
<p>åŸºäºä¸Šè¿°çš„å¤šä¸ªå†³ç­–æ ‘çš„ç®—æ³•ï¼Œä¸ºäº†è®©æ ‘ä¸æ ‘ä¹‹é—´å·®å¼‚è¾ƒå¤§ï¼Œæ‰€ä»¥æ ‘çš„ç‰¹å¾èŠ‚ç‚¹çš„é€‰æ‹©ä¸€èˆ¬æ˜¯
ç‰¹å¾ä¸ªæ•°ä¸ºk çš„å­é›†ï¼ˆç‰¹å¾æ€»æ•°ä¸ºnï¼Œk&lt;nï¼‰ï¼Œç„¶åä»è¿™kä¸ªç‰¹å¾ä¸­é€‰å–èŠ‚ç‚¹</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="hxt"
      src="/images/hxt.jpg">
  <p class="site-author-name" itemprop="name">hxt</p>
  <div class="site-description" itemprop="description">May the Force be with you.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">182</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">46</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">74</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hxt</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">419k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">6:21</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
