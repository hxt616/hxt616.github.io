<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="BUUCTF 1.easyre 下载压缩包，用Exeinfope查看文件架构信息：  可知文件是64位，将其拖进IDA64中，直接得到flag  2.reverse1 先判断文件为64位，用IDA64打开文件  切换为文本界面也没有什么特殊字符，然后通过Shift+F12打开String窗口  找到关键字符，双击后进入反汇编的文本界面  按Ctrl+X找到该地址的函数  双击Address一栏下方">
<meta property="og:type" content="article">
<meta property="og:title" content="Reverse做题记录">
<meta property="og:url" content="http://example.com/2022/08/23/Reverse%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="hxt&#39;s Blog">
<meta property="og:description" content="BUUCTF 1.easyre 下载压缩包，用Exeinfope查看文件架构信息：  可知文件是64位，将其拖进IDA64中，直接得到flag  2.reverse1 先判断文件为64位，用IDA64打开文件  切换为文本界面也没有什么特殊字符，然后通过Shift+F12打开String窗口  找到关键字符，双击后进入反汇编的文本界面  按Ctrl+X找到该地址的函数  双击Address一栏下方">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/b454fe47178e4ece86e9b4a8e69fb35f.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6cd55322012c45b5a4158bc1fd28cc6f.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1d017b7ed51047ae869a046f91c4ddb6.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/dde454aebd1b46e79d022ad822f261cc.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/d3cc6d422d964c509323e8207faaed6d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASF94dA==,size_20,color_FFFFFF,t_70,g_se,x_16">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c333353c6fb4480e8c2dbd4b823f8966.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1d3482dc52df48cab2dd09ce412e8036.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/dd3012e2c7494ea48b8dd0cc52510ba5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/18610c3416d643b0bb474f51956cb6b7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/259901194e564efa976e1ec25b7abb3e.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/26fef228d9574c70b564dd0ef4d79254.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/4982256a01b4420db577196099486518.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/b9041e7325834372b9a243920b26134c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/7b5f68ce277c4cbbb667826c30714161.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/227ade9dab51417aadaa8d7f79506ec7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/fb420d7a3c04452ea744eb117d7ead71.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/14285ebf5326479f8ba8cc84c3eeb264.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c0994c44c301438f9ac633b8d8926c79.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1c245929786649ce868145c21e7f8470.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e6a05b9028eb4515a6cb89bbf830372a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/196101e59a79474bac2874abd509589e.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/9be8e105191a476a8917b911ed2878f7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e56086b1be6d40d298d8bf594d4f1aa0.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/fb5453f2fa074ccfb08d71f38b635dee.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/9220d87cdb914402943c6374c4a9d721.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/cb0aeb63625e4726a73f7ca12dba4299.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/54751906dc2b40d0a81381d828766102.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e3f6b809f0fa4891a6c542d56f129c6a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/636dc98e381148d2b772dd5c45466143.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/f5b56ab29b9e45bd81f9b7b46bb60c01.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ce8c4690feee421c928bd7ec9c04f185.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/0f92a09adad44ef59525c6ff7272deac.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/44c5cb32259f422bb00f1b9b276b4c30.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1f2ba2d9f8614b54b944f281bfc34938.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5787fa28addf43e08a8005b0b7175ccc.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/bb367cb767a84aea9703677dc90d9f5d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/d2f497c1674d4143a91cd883f011a79a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/58ffb0d56aa648ff990e654cafeeee4b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/0572832498014932af27d2addef3279c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6294104fede849bda72d7736f2643b0d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/334b68f870c74d61ac66e683af22f398.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ca768441d6e54da0ad42456cf51fd8d8.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/df604c58ed1f494fb88c466f445180b7.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/3c45182480694e03898888a986234b13.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220905095138713.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220905121435536.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908202330115.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908202507565.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908202848127.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908203511791.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220906193246304.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220913214655907.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220913214801996.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220913220646105.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c2f5d121af2b4f0e83b5ad0a56b2ed7b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/8ff18d19eb6e43149aa2ce03d611e2ad.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/63c37f5e1dc04387b8108e0ecacf3143.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/51ed2f780e61456b8fea5d8cd5ea1eec.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/db11f50a22ce467c89f1ed07efc32667.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/d606c4ac2c594c7c903df3afcd63fabe.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/9a02f2e97d0148cba285166c7088cd42.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ac2439789e0d4ef297342427e7bc12d3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c495350207434c99b5784d4225766df1.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/d23e4a85f9414e2e87943e28c482941e.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1810e9d9faed454f9a728943e9a9edca.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5a503386fe6a415bae01b8ee2b4337e3.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/448ef3fcf2aa4570941e8b607236d17f.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/04cbbc6e77144d55b687d54cf346693a.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1909d790c1fd42ad90732614588a343d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/2078b7be2a154ea599fae3b4855df924.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6c68bef755ad47629a52c94e440f246d.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e5e959d835b648f88ab5a748167c8754.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/3cd1ed483fa74c80940f19e7822df157.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/f8e0588a947345c88ee2f65a454794bc.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5dd9baa0b1fa4b248888db6f6474cd6c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ee267419b82a44c8bf99024039e05ae9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/bd611bf38fdd4e8ca23b44525f06897c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6a351ce0e6f44b0b850a186c913bac91.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/633ec1ecec8747e88667abfa1898163c.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1170c5b73a634e03b10996d9d9bd91ea.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/8855a06945be461ca80db3b1aa125bb5.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/f3b23be59432442e991473cd7f90c575.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/823c9081338a4b029d4a121ec9b08e44.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/da38193b35c1466fbff24689ab6abf24.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6b930b1bd2db4f5ea0d731ce069b697b.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/2ba1801ffc8146e3a84a4262615250a9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/73987c0a3dd64e14baba86b2417e4420.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5ddd22044736463cb621f063519cfdf9.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/3b0c90f6995f4fe9ac30ee8ba4941303.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/89beadfb0bc3436db4e85889162b9c26.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907165026692.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907122850797.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907123348942.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907105903812.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907110655390.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907115838190.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907123643112.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907123925712.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907171906770.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907172221181.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907172336470.png">
<meta property="article:published_time" content="2022-08-23T05:00:41.092Z">
<meta property="article:modified_time" content="2023-06-27T07:14:30.566Z">
<meta property="article:author" content="hxt">
<meta property="article:tag" content="Reverse">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/b454fe47178e4ece86e9b4a8e69fb35f.png">

<link rel="canonical" href="http://example.com/2022/08/23/Reverse%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Reverse做题记录 | hxt's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">hxt's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/08/23/Reverse%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hxt.jpg">
      <meta itemprop="name" content="hxt">
      <meta itemprop="description" content="May the Force be with you.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hxt's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Reverse做题记录
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-08-23 13:00:41" itemprop="dateCreated datePublished" datetime="2022-08-23T13:00:41+08:00">2022-08-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-06-27 15:14:30" itemprop="dateModified" datetime="2023-06-27T15:14:30+08:00">2023-06-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>36k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>32 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="buuctf">BUUCTF</h2>
<h3 id="easyre">1.easyre</h3>
<p>下载压缩包，用Exeinfope查看文件架构信息： <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/b454fe47178e4ece86e9b4a8e69fb35f.png" alt="在这里插入图片描述">
可知文件是64位，将其拖进IDA64中，直接得到flag <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6cd55322012c45b5a4158bc1fd28cc6f.png" alt="在这里插入图片描述"></p>
<h3 id="reverse1">2.reverse1</h3>
<p>先判断文件为64位，用IDA64打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1d017b7ed51047ae869a046f91c4ddb6.png" alt="在这里插入图片描述">
切换为文本界面也没有什么特殊字符，然后通过Shift+F12打开String窗口 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/dde454aebd1b46e79d022ad822f261cc.png" alt="在这里插入图片描述"> 找到关键字符，双击后进入反汇编的文本界面
<img src="https://img-blog.csdnimg.cn/d3cc6d422d964c509323e8207faaed6d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBASF94dA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="在这里插入图片描述"> 按Ctrl+X找到该地址的函数 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c333353c6fb4480e8c2dbd4b823f8966.png" alt="在这里插入图片描述"> 双击Address一栏下方的地址 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1d3482dc52df48cab2dd09ce412e8036.png" alt="在这里插入图片描述"> 按F5进入伪代码窗口 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/dd3012e2c7494ea48b8dd0cc52510ba5.png" alt="在这里插入图片描述">
阅读伪代码可知Str1和Str2进行了比较，当两者不相同是输出“this is the right
flag!”。将“111”和“48”以char类型显示 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/18610c3416d643b0bb474f51956cb6b7.png" alt="在这里插入图片描述">
可知"hello_world"中的'o'被替换为了'0'，所以flag为flag{hell0_w0rld}。</p>
<span id="more"></span>
<h3 id="reverse2">3.reverse2</h3>
<p>打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/259901194e564efa976e1ec25b7abb3e.png" alt="在这里插入图片描述"> 按F5进入伪代码窗口 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/26fef228d9574c70b564dd0ef4d79254.png" alt="在这里插入图片描述"> 将一些整型转换为char类型 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/4982256a01b4420db577196099486518.png" alt="在这里插入图片描述">
现在只需知道flag的内容，然后将’i‘和’r'替换为‘1’。 双击‘&amp;flag’ <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/b9041e7325834372b9a243920b26134c.png" alt="在这里插入图片描述">
得到字符串“hacking_for_fun”，所以flag为flag{hack1ng_fo1_fun}。</p>
<h3 id="内涵的软件">4.内涵的软件</h3>
<p>用IDA打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/7b5f68ce277c4cbbb667826c30714161.png" alt="在这里插入图片描述"> 双击“_main_0”函数 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/227ade9dab51417aadaa8d7f79506ec7.png" alt="在这里插入图片描述">
我一开始看字符串为32位，以为是md5加密，但是行不通，于是直接将大括号里的字符串作为flag，结果答案正确。</p>
<h3 id="新年快乐">5.新年快乐</h3>
<p>用IDA打开文件，发现只显示了两个函数且控制流图比较复杂，猜测加了壳。
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/fb420d7a3c04452ea744eb117d7ead71.png" alt="在这里插入图片描述"> 然后用OD打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/14285ebf5326479f8ba8cc84c3eeb264.png" alt="在这里插入图片描述"> 按F9运行到下一个断点 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c0994c44c301438f9ac633b8d8926c79.png" alt="在这里插入图片描述">
发现popad，按F9再次运行到下一个断点，再按F8单步步过 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1c245929786649ce868145c21e7f8470.png" alt="在这里插入图片描述"> 直接转到了OEP，鼠标右击出现： <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e6a05b9028eb4515a6cb89bbf830372a.png" alt="在这里插入图片描述">
修改相关数据进行脱壳并保存脱壳后的文件“新年快乐_dump.exe” <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/196101e59a79474bac2874abd509589e.png" alt="在这里插入图片描述"> 用IDA打开该文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/9be8e105191a476a8917b911ed2878f7.png" alt="在这里插入图片描述"> 出现多个函数且发现main函数，直接F5反编译
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e56086b1be6d40d298d8bf594d4f1aa0.png" alt="在这里插入图片描述"> 可知flag为{HappyNewYear!}。</p>
<h3 id="xor">6.xor</h3>
<p>判断出文件为64位后用IDA64打开文件，F5查看伪代码： <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/fb5453f2fa074ccfb08d71f38b635dee.png" alt="在这里插入图片描述">
分析伪代码，发现global变量是我们已知的，双击进入 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/9220d87cdb914402943c6374c4a9d721.png" alt="在这里插入图片描述"> 然后编写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">str1 = [<span class="string">'f'</span>, <span class="number">0x0A</span>, <span class="string">'k'</span>, <span class="number">0x0C</span>, <span class="string">'w'</span>, <span class="string">'&amp;'</span>, <span class="string">'O'</span>, <span class="string">'.'</span>, <span class="string">'@'</span>, <span class="number">0x11</span>, <span class="string">'x'</span>, <span class="number">0x0D</span>, <span class="string">'Z'</span>, <span class="string">';'</span>, <span class="string">'U'</span>, <span class="number">0x11</span>, <span class="string">'p'</span>, <span class="number">0x19</span>, <span class="string">'F'</span>, <span class="number">0x1F</span>, <span class="string">'v'</span>,</span><br><span class="line">        <span class="string">'"'</span>, <span class="string">'M'</span>, <span class="string">'#'</span>, <span class="string">'D'</span>, <span class="number">0x0E</span>, <span class="string">'g'</span>, <span class="number">6</span>, <span class="string">'h'</span>, <span class="number">0x0F</span>, <span class="string">'G'</span>, <span class="string">'2'</span>, <span class="string">'O'</span>]</span><br><span class="line"></span><br><span class="line">x = <span class="string">'f'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(str1)):</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isinstance</span>(str1[i], <span class="built_in">str</span>)):<span class="comment">#判断两个类型是否相同</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">isinstance</span>(str1[i - <span class="number">1</span>], <span class="built_in">str</span>)):</span><br><span class="line">            x += <span class="built_in">chr</span>(<span class="built_in">ord</span>(str1[i]) ^ <span class="built_in">ord</span>(str1[i - <span class="number">1</span>]))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x += <span class="built_in">chr</span>(<span class="built_in">ord</span>(str1[i]) ^ str1[i - <span class="number">1</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x += <span class="built_in">chr</span>(str1[i] ^ <span class="built_in">ord</span>(str1[i - <span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x)</span><br></pre></td></tr></tbody></table></figure>
<p>运行得出flag </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag{QianQiuWanDai_YiTongJiangHu}</span><br></pre></td></tr></tbody></table></figure> ### 7.helloworld
下载文件后发现文件后缀是apk，之前没有遇到过，经过搜索后得知是安卓文件，需要ApkIDE工具进行分析。用其打开文件后，不断打开文件夹寻找特殊文件，发现一个包含Main字段的文件，打开后发现flag。
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/cb0aeb63625e4726a73f7ca12dba4299.png" alt="在这里插入图片描述"><p></p>
<h3 id="reverse3">8.reverse3</h3>
<p>用IDA打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/54751906dc2b40d0a81381d828766102.png" alt="在这里插入图片描述"> F5查看伪代码，发现main_0函数，双击进入 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e3f6b809f0fa4891a6c542d56f129c6a.png" alt="在这里插入图片描述">
分析代码可知首先将v1的值赋给Dest，然后对Dest进行处理，其中v1的值是字符串经过函数sub_4110BE处理的结果。Dest又与Str2相同，双击查看Str2得到字符串“e3nifIH9b_C@n<span class="citation" data-cites="dH">@dH</span>”，因此逆向处理一下Str2即可得到v1，双击进入该函数
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/636dc98e381148d2b772dd5c45466143.png" alt="在这里插入图片描述"> 发现出现大量重复字符串，再次双击，得到 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/f5b56ab29b9e45bd81f9b7b46bb60c01.png" alt="在这里插入图片描述"> 感觉大概率是Base64编码了，接下来编写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">Dest = <span class="string">"e3nifIH9b_C@n@dH"</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(Dest[i])-i)</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag))</span><br></pre></td></tr></tbody></table></figure>
<p>运行得到flag <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ce8c4690feee421c928bd7ec9c04f185.png" alt="在这里插入图片描述"></p>
<h3 id="不一样的flag">9.不一样的flag</h3>
<h3 id="simplerev">10.SimpleRev</h3>
<p>首先判断出文件是64位的，拖入IDA64中 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/0f92a09adad44ef59525c6ff7272deac.png" alt="在这里插入图片描述"> F5查看伪代码，发现Decry()函数，双击进入 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/44c5cb32259f422bb00f1b9b276b4c30.png" alt="在这里插入图片描述"> 阅读代码，将特殊的数字转换为字符串 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1f2ba2d9f8614b54b944f281bfc34938.png" alt="在这里插入图片描述">
此时注意大小端序的区别，IDA上显示为大端序，而原本的数据在计算机内部存储为小端序，所以要将将两个字符串倒序，得到text
= ‘killshadow’，key =
'ADSFKNDCLS'。接下来就是分析代码，编写出脚本。由于我的python水平较低，写出的代码不够简洁，凑合着看。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">'ADSFKNDCLS'</span></span><br><span class="line">key = <span class="built_in">list</span>(key)</span><br><span class="line">v9 = <span class="string">'wodah'</span><span class="comment">#大端序</span></span><br><span class="line">text = <span class="string">'killshadow'</span></span><br><span class="line">text = <span class="built_in">list</span>(text)</span><br><span class="line">str2=<span class="string">''</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">v5 = <span class="built_in">len</span>(key)</span><br><span class="line">v3 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,v5):</span><br><span class="line">    <span class="keyword">if</span> key[v3%v5]&gt;=<span class="string">'A'</span> <span class="keyword">and</span> key[v3%v5]&lt;=<span class="string">'Z'</span>:</span><br><span class="line">        key[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[v3%v5])+<span class="number">32</span>)</span><br><span class="line">    v3+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(text)):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> y&gt;=<span class="number">65</span> <span class="keyword">and</span> y&lt;=<span class="number">90</span>: </span><br><span class="line">            <span class="keyword">if</span> (y-<span class="number">39</span>-<span class="built_in">ord</span>(key[x%v5])+<span class="number">97</span>)%<span class="number">26</span>+<span class="number">97</span> == <span class="built_in">ord</span>(text[x%v5]):</span><br><span class="line">                flag+=<span class="built_in">chr</span>(y)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行结果为：KLDQCUDFZO ### 11.[GXYCTF2019]luck_guy
参考：https://chowdera.com/2022/02/202202062232392340.html
用IDA打开文件，直接F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5787fa28addf43e08a8005b0b7175ccc.png" alt="在这里插入图片描述"> 双击进入“patch_me” <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/bb367cb767a84aea9703677dc90d9f5d.png" alt="在这里插入图片描述"> 再双击进入get_flag()中</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 <span class="title">get_flag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// al</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> j; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  __int64 s; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v0 = <span class="built_in">time</span>(<span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">srand</span>(v0);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">switch</span> ( <span class="built_in">rand</span>() % <span class="number">200</span> )</span><br><span class="line">    {</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"OK, it's flag:"</span>);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x28</span>uLL);</span><br><span class="line">        <span class="built_in">strcat</span>((<span class="type">char</span> *)&amp;s, f1);</span><br><span class="line">        <span class="built_in">strcat</span>((<span class="type">char</span> *)&amp;s, &amp;f2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%s"</span>, &amp;s);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Solar not like you"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Solar want a girlfriend"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        v6 = <span class="number">0</span>;</span><br><span class="line">        s = <span class="number">9180147350284624745LL</span>;</span><br><span class="line">        <span class="built_in">strcat</span>(&amp;f2, (<span class="type">const</span> <span class="type">char</span> *)&amp;s);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">7</span>; ++j )</span><br><span class="line">        {</span><br><span class="line">          <span class="keyword">if</span> ( j % <span class="number">2</span> == <span class="number">1</span> )</span><br><span class="line">            v1 = *(&amp;f2 + j) - <span class="number">2</span>;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">            v1 = *(&amp;f2 + j) - <span class="number">1</span>;</span><br><span class="line">          *(&amp;f2 + j) = v1;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"emmm,you can't find flag 23333"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v7;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>阅读代码可知得到flag的顺序应该为<code>case 4-&gt;case 5-&gt;case 1</code>，将光标移到s值处，按R键得到<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/d2f497c1674d4143a91cd883f011a79a.png" alt="在这里插入图片描述">
共有8个字符，将s转换为16进制，得到<code>0x7F666F6067756369</code>，由于内存中数据存储顺序为小端序，所以，十六进制真正的顺序是<code>0x69637567606F667F</code>。
写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">'GXY{do_not_'</span></span><br><span class="line">f2 = [<span class="number">0x7F</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x60</span>, <span class="number">0x67</span>, <span class="number">0x75</span>, <span class="number">0x63</span>, <span class="number">0x69</span>][::-<span class="number">1</span>]</span><br><span class="line">s = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        s = <span class="built_in">chr</span>(<span class="built_in">int</span>(f2[i]) - <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = <span class="built_in">chr</span>(<span class="built_in">int</span>(f2[i]) - <span class="number">1</span>)</span><br><span class="line">    flag += s</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行可得<code>GXY{do_not_hate_me}</code>，最后提交的时候将GXY改为flag。
### 12.Java逆向解密
下载附件可知附件为编译后的java文件，通过JD-GUI打开附件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/58ffb0d56aa648ff990e654cafeeee4b.png" alt="在这里插入图片描述"> 分析源代码，通过python写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">key=[<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, </span><br><span class="line">        <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span>]</span><br><span class="line">l=<span class="built_in">len</span>(key)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,l):</span><br><span class="line">    flag+=<span class="built_in">chr</span>((key[i]^<span class="number">0x20</span>)-<span class="number">64</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行的flag为: <code>This_is_the_flag_!</code>。 ###
13.[BJDCTF2020]JustRE 这题算是我运气好，连蒙带猜得到了flag。
用IDA打开文件，光标移至WinMain处，查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/0572832498014932af27d2addef3279c.png" alt="在这里插入图片描述"> 紫色高亮函数为库函数，双击进入sub_4010C0函数
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6294104fede849bda72d7736f2643b0d.png" alt="在这里插入图片描述">
上图中均为初始化相关参数，双击查看sub_4011C0函数 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/334b68f870c74d61ac66e683af22f398.png" alt="在这里插入图片描述"> 根据代码可知DialogFunc应该很重要，双击查看
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ca768441d6e54da0ad42456cf51fd8d8.png" alt="在这里插入图片描述">
可知当dword_4099F0等于19999时，会将aBjdDD2069a4579的值赋予String，双击aBjdDD2069a4579
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/df604c58ed1f494fb88c466f445180b7.png" alt="在这里插入图片描述">
发现疑似flag的字符串，猜测将其中两个“%d”替换为相应的整数可得到完整的flag。
根据sprintf函数的性质 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/3c45182480694e03898888a986234b13.png" alt="在这里插入图片描述">
再结合<code>sprintf(&amp;String, aBjdDD2069a4579, 19999, 0)</code>可知两个整数分别为19999和0，最终可得flag为：<code>flag{1999902069a45792d233ac}</code>。</p>
<h3 id="刮开有奖">14.刮开有奖</h3>
<p>首先用exeinfope打开文件，发现是32位，且无壳</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220905095138713.png" alt="image-20220905095138713">
<figcaption aria-hidden="true">image-20220905095138713</figcaption>
</figure>
<p>用32位的IDA打开文件，将光标移至WinMain函数处，按F5查看伪代码，发现只有一个函数</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __stdcall <span class="title function_">WinMain</span><span class="params">(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, <span class="type">int</span> nShowCmd)</span></span><br><span class="line">{</span><br><span class="line">  DialogBoxParamA(hInstance, (LPCSTR)<span class="number">0x67</span>, <span class="number">0</span>, DialogFunc, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>双击查看<code>DialogFunc</code>函数</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">BOOL __stdcall <span class="title function_">DialogFunc</span><span class="params">(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v4; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v5; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+8h] [ebp-20030h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+Ch] [ebp-2002Ch]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+10h] [ebp-20028h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+14h] [ebp-20024h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+18h] [ebp-20020h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+1Ch] [ebp-2001Ch]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+20h] [ebp-20018h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [esp+24h] [ebp-20014h]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [esp+28h] [ebp-20010h]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [esp+2Ch] [ebp-2000Ch]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [esp+30h] [ebp-20008h]</span></span><br><span class="line">  CHAR String; <span class="comment">// [esp+34h] [ebp-20004h]</span></span><br><span class="line">  <span class="type">char</span> v19; <span class="comment">// [esp+35h] [ebp-20003h]</span></span><br><span class="line">  <span class="type">char</span> v20; <span class="comment">// [esp+36h] [ebp-20002h]</span></span><br><span class="line">  <span class="type">char</span> v21; <span class="comment">// [esp+37h] [ebp-20001h]</span></span><br><span class="line">  <span class="type">char</span> v22; <span class="comment">// [esp+38h] [ebp-20000h]</span></span><br><span class="line">  <span class="type">char</span> v23; <span class="comment">// [esp+39h] [ebp-1FFFFh]</span></span><br><span class="line">  <span class="type">char</span> v24; <span class="comment">// [esp+3Ah] [ebp-1FFFEh]</span></span><br><span class="line">  <span class="type">char</span> v25; <span class="comment">// [esp+3Bh] [ebp-1FFFDh]</span></span><br><span class="line">  <span class="type">char</span> v26; <span class="comment">// [esp+10034h] [ebp-10004h]</span></span><br><span class="line">  <span class="type">char</span> v27; <span class="comment">// [esp+10035h] [ebp-10003h]</span></span><br><span class="line">  <span class="type">char</span> v28; <span class="comment">// [esp+10036h] [ebp-10002h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">272</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 != <span class="number">273</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (_WORD)a3 == <span class="number">1001</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">memset</span>(&amp;String, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">    GetDlgItemTextA(hDlg, <span class="number">1000</span>, &amp;String, <span class="number">0xFFFF</span>);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;String) == <span class="number">8</span> )</span><br><span class="line">    {<span class="comment">//将光标移至数字上，按'R'键，将数字转为对应的字符</span></span><br><span class="line">      v7 = <span class="number">90</span>;                     <span class="comment">//'Z'</span></span><br><span class="line">      v8 = <span class="number">74</span>;                     <span class="comment">//'J'</span></span><br><span class="line">      v9 = <span class="number">83</span>;                     <span class="comment">//'S'</span></span><br><span class="line">      v10 = <span class="number">69</span>;                    <span class="comment">//'E'</span></span><br><span class="line">      v11 = <span class="number">67</span>;                    <span class="comment">//'C'</span></span><br><span class="line">      v12 = <span class="number">97</span>;                    <span class="comment">//'a'</span></span><br><span class="line">      v13 = <span class="number">78</span>;                    <span class="comment">//'N'</span></span><br><span class="line">      v14 = <span class="number">72</span>;                    <span class="comment">//'H'</span></span><br><span class="line">      v15 = <span class="number">51</span>;                    <span class="comment">//'3'</span></span><br><span class="line">      v16 = <span class="number">110</span>;                   <span class="comment">//'n'</span></span><br><span class="line">      v17 = <span class="number">103</span>;                   <span class="comment">//'g'</span></span><br><span class="line">      sub_4010F0(&amp;v7, <span class="number">0</span>, <span class="number">10</span>);      </span><br><span class="line">      <span class="built_in">memset</span>(&amp;v26, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">      v26 = v23;</span><br><span class="line">      v28 = v25;</span><br><span class="line">      v27 = v24;</span><br><span class="line">      v4 = (<span class="type">const</span> <span class="type">char</span> *)sub_401000(&amp;v26, <span class="built_in">strlen</span>(&amp;v26));</span><br><span class="line">      <span class="built_in">memset</span>(&amp;v26, <span class="number">0</span>, <span class="number">0xFFFF</span>u);</span><br><span class="line">      v27 = v21;</span><br><span class="line">      v26 = v20;</span><br><span class="line">      v28 = v22;</span><br><span class="line">      v5 = (<span class="type">const</span> <span class="type">char</span> *)sub_401000(&amp;v26, <span class="built_in">strlen</span>(&amp;v26));</span><br><span class="line">      <span class="keyword">if</span> ( String == v7 + <span class="number">34</span></span><br><span class="line">        &amp;&amp; v19 == v11</span><br><span class="line">        &amp;&amp; <span class="number">4</span> * v20 - <span class="number">141</span> == <span class="number">3</span> * v9</span><br><span class="line">        &amp;&amp; v21 / <span class="number">4</span> == <span class="number">2</span> * (v14 / <span class="number">9</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">"ak1w"</span>)</span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">"V1Ax"</span>) )</span><br><span class="line">      {</span><br><span class="line">        MessageBoxA(hDlg, <span class="string">"U g3t 1T!"</span>, <span class="string">"@_@"</span>, <span class="number">0</span>);</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( (_WORD)a3 != <span class="number">1</span> &amp;&amp; (_WORD)a3 != <span class="number">2</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  EndDialog(hDlg, (<span class="type">unsigned</span> __int16)a3);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>分析代码猜测第49行的函数<code>sub_4010F0</code>比较重要，双击进入，查看代码</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_4010F0</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  {</span><br><span class="line">    v5 = <span class="number">4</span> * i;</span><br><span class="line">    v6 = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    {</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; *(_DWORD *)(a1 + <span class="number">4</span> * result) )</span><br><span class="line">        {</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          *(_DWORD *)(v5 + a1) = *(_DWORD *)(a1 + <span class="number">4</span> * result);</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( *(_DWORD *)(a1 + <span class="number">4</span> * i) &lt;= v6 )</span><br><span class="line">          {</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          }</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = <span class="number">4</span> * i;</span><br><span class="line">          *(_DWORD *)(a1 + <span class="number">4</span> * result) = *(_DWORD *)(<span class="number">4</span> * i + a1);</span><br><span class="line">        }</span><br><span class="line">        --result;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    }</span><br><span class="line">LABEL_13:</span><br><span class="line">    *(_DWORD *)(a1 + <span class="number">4</span> * result) = v6;</span><br><span class="line">    sub_4010F0(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>根据传入的参数可知，<code>a1 = &amp;v7（即v7的地址）</code>，<code>a2 = 0</code>，<code>a3 = 10（v17与v7正好相差10）</code>，直接将v7~v17作为字符串带入，将上述函数稍作修改，运行以下代码</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">sub_4010F0</span><span class="params">(<span class="type">char</span> *a1, <span class="type">int</span> a2, <span class="type">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line"></span><br><span class="line">  result = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )</span><br><span class="line">  {</span><br><span class="line">    v5 = i;</span><br><span class="line">    v6 = a1[i];        <span class="comment">//*(_DWORD *)(i + a1);</span></span><br><span class="line">    <span class="keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )</span><br><span class="line">    {</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( v6 &gt; a1[result] )</span><br><span class="line">        {</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          ++i;</span><br><span class="line">          a1[v5] = a1[result];</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">while</span> ( a1[i]&lt;= v6 )</span><br><span class="line">          {</span><br><span class="line">            <span class="keyword">if</span> ( ++i &gt;= result )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_13;</span><br><span class="line">          }</span><br><span class="line">          <span class="keyword">if</span> ( i &gt;= result )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          v5 = i;</span><br><span class="line">          a1[result] = a1[i];</span><br><span class="line">        }</span><br><span class="line">        --result;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">while</span> ( i &lt; result );</span><br><span class="line">    }</span><br><span class="line">LABEL_13:</span><br><span class="line">    a1[result] = v6;</span><br><span class="line">    <span class="built_in">sub_4010F0</span>(a1, a2, i - <span class="number">1</span>);</span><br><span class="line">    result = a3;</span><br><span class="line">    ++i;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">  <span class="type">char</span> v[<span class="number">12</span>]=<span class="string">"ZJSECaNH3ng"</span>;</span><br><span class="line">  <span class="type">int</span> result;</span><br><span class="line">  result = <span class="built_in">sub_4010F0</span>(v,<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">  cout&lt;&lt;v&lt;&lt;endl;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>上述脚本中，主要将<code>4*i</code>修改为了<code>i</code>，因为原本的<code>a1</code>为int型，长度为4个字节，当<code>a1</code>作为起始地址时，所占空间为4个字节，因此下一个数字的地址应为<code>a1+4</code>；而我将原来的v7
~
v17字符转为了字符串，于是我将<code>sub_4010F0</code>中int类型的<code>a1</code>改为了字符指针，利用字符数组存放v7
~ v17的值，因此就不需要将 i 乘以 4
了，并将<code>*(_DWORD *)(i + a1)</code>改为了<code>a1[i]</code>，运行得到<code>3CEHJNSZagn</code>。</p>
<p>继续回到<code>DialogFunc</code>中查看，在第54和59行发现<code>sub_401000</code>函数，双击查看</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__cdecl <span class="title function_">sub_401000</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// esi</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// ebx</span></span><br><span class="line">  _BYTE *v5; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v8; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v10; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// edi</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v12; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v13; <span class="comment">// esi</span></span><br><span class="line">  _BYTE *result; <span class="comment">// eax</span></span><br><span class="line">  _BYTE *v15; <span class="comment">// [esp+Ch] [ebp-10h]</span></span><br><span class="line">  _BYTE *v16; <span class="comment">// [esp+10h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [esp+14h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [esp+18h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = a2 / <span class="number">3</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 % <span class="number">3</span> &gt; <span class="number">0</span> )</span><br><span class="line">    ++v2;</span><br><span class="line">  v4 = <span class="number">4</span> * v2 + <span class="number">1</span>;</span><br><span class="line">  v5 = <span class="built_in">malloc</span>(v4);</span><br><span class="line">  v6 = v5;</span><br><span class="line">  v15 = v5;</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="built_in">memset</span>(v5, <span class="number">0</span>, v4);</span><br><span class="line">  v7 = a2;</span><br><span class="line">  v8 = v6;</span><br><span class="line">  v16 = v6;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &gt; <span class="number">0</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    {</span><br><span class="line">      v9 = <span class="number">0</span>;</span><br><span class="line">      v10 = <span class="number">0</span>;</span><br><span class="line">      v18 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( v3 &gt;= v7 )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        v9 = *(<span class="type">unsigned</span> __int8 *)(v3++ + a1) | (v9 &lt;&lt; <span class="number">8</span>);</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">while</span> ( v10 &lt; <span class="number">3</span> );</span><br><span class="line">      v11 = v9 &lt;&lt; <span class="number">8</span> * (<span class="number">3</span> - v10);</span><br><span class="line">      v12 = <span class="number">0</span>;</span><br><span class="line">      v17 = v3;</span><br><span class="line">      v13 = <span class="number">18</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      {</span><br><span class="line">        <span class="keyword">if</span> ( v10 &gt;= v12 )</span><br><span class="line">        {</span><br><span class="line">          *((_BYTE *)&amp;v18 + v12) = (v11 &gt;&gt; v13) &amp; <span class="number">0x3F</span>;</span><br><span class="line">          v8 = v16;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        {</span><br><span class="line">          *((_BYTE *)&amp;v18 + v12) = <span class="number">64</span>;</span><br><span class="line">        }</span><br><span class="line">        *v8++ = byte_407830[*((<span class="type">char</span> *)&amp;v18 + v12)];</span><br><span class="line">        v13 -= <span class="number">6</span>;</span><br><span class="line">        ++v12;</span><br><span class="line">        v16 = v8;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">while</span> ( v13 &gt; <span class="number">-6</span> );</span><br><span class="line">      v3 = v17;</span><br><span class="line">      <span class="keyword">if</span> ( v17 &gt;= a2 )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      v7 = a2;</span><br><span class="line">    }</span><br><span class="line">    v6 = v15;</span><br><span class="line">  }</span><br><span class="line">  result = v6;</span><br><span class="line">  *v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>发现第65行的一个数组<code>byte_407830</code>，双击查看</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220905121435536.png" alt="image-20220905121435536">
<figcaption aria-hidden="true">image-20220905121435536</figcaption>
</figure>
<p>推测可能时base64编码。</p>
<p>回到<code>DialogFunc</code>中，前面得到v7~v17经过处理后的值为<code>3CEHJNSZagn</code>，分析剩下的代码</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( String == v7 + <span class="number">34</span>      <span class="comment">//v7对应的ASCII码 51 ，所以String的值为 85 ，对应的字符为'U'</span></span><br><span class="line">        &amp;&amp; v19 == v11       <span class="comment">//v19的值为经过处理后的v11的值'J'</span></span><br><span class="line">        &amp;&amp; <span class="number">4</span> * v20 - <span class="number">141</span> == <span class="number">3</span> * v9   <span class="comment">//v20 = (3 * v9 + 141) / 4，v20的值为'W'</span></span><br><span class="line">        &amp;&amp; v21 / <span class="number">4</span> == <span class="number">2</span> * (v14 / <span class="number">9</span>)  <span class="comment">//v21 = 2 * (v14 / 9) * 4，v21的值为'P'</span></span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v4, <span class="string">"ak1w"</span>)     <span class="comment">//由 v4 = (const char *)sub_401000(&amp;v26, strlen(&amp;v26))可知，需将'ak1w'进行base64解码，得到'jMp'</span></span><br><span class="line">        &amp;&amp; !<span class="built_in">strcmp</span>(v5, <span class="string">"V1Ax"</span>) )   <span class="comment">//同理，将'V1Ax'进行base64解码，得到'WP1'</span></span><br><span class="line">      {</span><br><span class="line">        MessageBoxA(hDlg, <span class="string">"U g3t 1T!"</span>, <span class="string">"@_@"</span>, <span class="number">0</span>);</span><br><span class="line">      }</span><br></pre></td></tr></tbody></table></figure>
<p>对得到的字符串进行拼接，得到<code>flag{UJWP1jMp}</code>。</p>
<h3 id="简单注册器">15.简单注册器</h3>
<p>打开下载的压缩包发现是apk文件，于是尝试用ApkIDE打开文件，发现一段特殊字符<strong>dd2940c04462b4dd7c450528835cca15</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">.line 44</span><br><span class="line">    :cond_1</span><br><span class="line">    if-ne v2, v10, :cond_3</span><br><span class="line"></span><br><span class="line">    .line 46</span><br><span class="line">    const-string v3, "dd2940c04462b4dd7c450528835cca15"</span><br><span class="line"></span><br><span class="line">    .line 47</span><br><span class="line">    .local v3, "flagtrue":Ljava/lang/String;</span><br><span class="line">    invoke-virtual {v3}, Ljava/lang/String;-&gt;toCharArray()[C</span><br><span class="line"></span><br><span class="line">    move-result-object v5</span><br><span class="line"></span><br><span class="line">    .line 48</span><br><span class="line">    .local v5, "x":[C</span><br><span class="line">    aget-char v7, v5, v9</span><br><span class="line"></span><br><span class="line">    const/4 v8, 0x3</span><br><span class="line"></span><br><span class="line">    aget-char v8, v5, v8</span><br><span class="line"></span><br><span class="line">    add-int/2addr v7, v8</span><br><span class="line"></span><br><span class="line">    add-int/lit8 v7, v7, -0x32</span><br><span class="line"></span><br><span class="line">    int-to-char v7, v7</span><br><span class="line"></span><br><span class="line">    aput-char v7, v5, v9</span><br><span class="line"></span><br><span class="line">    .line 49</span><br><span class="line">    const/4 v7, 0x4</span><br><span class="line"></span><br><span class="line">    aget-char v8, v5, v9</span><br><span class="line"></span><br><span class="line">    const/4 v9, 0x5</span><br><span class="line"></span><br><span class="line">    aget-char v9, v5, v9</span><br><span class="line"></span><br><span class="line">    add-int/2addr v8, v9</span><br><span class="line"></span><br><span class="line">    add-int/lit8 v8, v8, -0x30</span><br><span class="line"></span><br><span class="line">    int-to-char v8, v8</span><br><span class="line"></span><br><span class="line">    aput-char v8, v5, v7</span><br><span class="line"></span><br><span class="line">    .line 50</span><br><span class="line">    const/16 v7, 0x1e</span><br><span class="line"></span><br><span class="line">    aget-char v8, v5, v11</span><br><span class="line"></span><br><span class="line">    const/16 v9, 0x9</span><br><span class="line"></span><br><span class="line">    aget-char v9, v5, v9</span><br><span class="line"></span><br><span class="line">    add-int/2addr v8, v9</span><br><span class="line"></span><br><span class="line">    add-int/lit8 v8, v8, -0x30</span><br><span class="line"></span><br><span class="line">    int-to-char v8, v8</span><br><span class="line"></span><br><span class="line">    aput-char v8, v5, v7</span><br><span class="line"></span><br><span class="line">    .line 51</span><br><span class="line">    const/16 v7, 0xe</span><br><span class="line"></span><br><span class="line">    const/16 v8, 0x1b</span><br><span class="line"></span><br><span class="line">    aget-char v8, v5, v8</span><br><span class="line"></span><br><span class="line">    const/16 v9, 0x1c</span><br><span class="line"></span><br><span class="line">    aget-char v9, v5, v9</span><br><span class="line"></span><br><span class="line">    add-int/2addr v8, v9</span><br><span class="line"></span><br><span class="line">    add-int/lit8 v8, v8, -0x61</span><br><span class="line"></span><br><span class="line">    int-to-char v8, v8</span><br><span class="line"></span><br><span class="line">    aput-char v8, v5, v7</span><br><span class="line"></span><br><span class="line">    .line 52</span><br><span class="line">    const/4 v4, 0x0</span><br><span class="line"></span><br><span class="line">    .local v4, "i":I</span><br><span class="line">    :goto_0</span><br><span class="line">    const/16 v7, 0x10</span><br><span class="line"></span><br><span class="line">    if-lt v4, v7, :cond_2</span><br><span class="line"></span><br><span class="line">    .line 59</span><br><span class="line">    invoke-static {v5}, Ljava/lang/String;-&gt;valueOf([C)Ljava/lang/String;</span><br><span class="line"></span><br><span class="line">    move-result-object v1</span><br><span class="line"></span><br><span class="line">    .line 60</span><br><span class="line">    .local v1, "bbb":Ljava/lang/String;</span><br><span class="line">    iget-object v7, p0, Lcom/example/flag/MainActivity$1;-&gt;val$textview:Landroid/widget/TextView;</span><br><span class="line"></span><br><span class="line">    new-instance v8, Ljava/lang/StringBuilder;</span><br><span class="line"></span><br><span class="line">    const-string v9, "flag{"</span><br><span class="line"></span><br><span class="line">    invoke-direct {v8, v9}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;(Ljava/lang/String;)V</span><br><span class="line"></span><br><span class="line">    invoke-virtual {v8, v1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder;</span><br><span class="line"></span><br><span class="line">    move-result-object v8</span><br><span class="line"></span><br><span class="line">    const-string v9, "}"</span><br></pre></td></tr></tbody></table></figure>
<p>上述代码应该就是最重要的部分，但也看不出什么，网上搜索一番后，发现需要用到
<strong>jeb</strong> 这个工具。</p>
<p>利用 jeb 打开文件，再找到上述代码处，右击进行解析，得到</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.support.v4.app.Fragment;</span><br><span class="line"><span class="keyword">import</span> android.support.v7.app.ActionBarActivity;</span><br><span class="line"><span class="keyword">import</span> android.view.LayoutInflater;</span><br><span class="line"><span class="keyword">import</span> android.view.Menu;</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem;</span><br><span class="line"><span class="keyword">import</span> android.view.View$OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.ViewGroup;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">ActionBarActivity</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PlaceholderFragment</span> <span class="keyword">extends</span> <span class="title class_">Fragment</span> {</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">PlaceholderFragment</span><span class="params">()</span> {</span><br><span class="line">            <span class="built_in">super</span>();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(LayoutInflater arg4, ViewGroup arg5, Bundle arg6)</span> {</span><br><span class="line">            <span class="keyword">return</span> arg4.inflate(<span class="number">0x7F030018</span>, arg5, <span class="literal">false</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainActivity</span><span class="params">()</span> {</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle arg7)</span> {</span><br><span class="line">        <span class="built_in">super</span>.onCreate(arg7);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(<span class="number">0x7F030017</span>);</span><br><span class="line">        <span class="keyword">if</span>(arg7 == <span class="literal">null</span>) {</span><br><span class="line">            <span class="built_in">this</span>.getSupportFragmentManager().beginTransaction().add(<span class="number">0x7F05003C</span>, <span class="keyword">new</span> <span class="title class_">PlaceholderFragment</span>()).commit();</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="built_in">this</span>.findViewById(<span class="number">0x7F05003F</span>).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View$OnClickListener</span>(<span class="built_in">this</span>.findViewById(<span class="number">0x7F05003D</span>), <span class="built_in">this</span>.findViewById(<span class="number">0x7F05003E</span>)) {</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View arg13)</span> {</span><br><span class="line">                <span class="type">int</span> <span class="variable">v11</span> <span class="operator">=</span> <span class="number">0x1F</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v9</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v2</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">                <span class="type">String</span> <span class="variable">v6</span> <span class="operator">=</span> <span class="built_in">this</span>.val$editview.getText().toString();</span><br><span class="line">                <span class="keyword">if</span>(v6.length() != <span class="number">0x20</span> || v6.charAt(v11) != <span class="number">97</span> || v6.charAt(<span class="number">1</span>) != <span class="number">98</span> || v6.charAt(<span class="number">0</span>) + v6.charAt(v9) - <span class="number">0x30</span> != <span class="number">56</span>) {</span><br><span class="line">                    v2 = <span class="number">0</span>;</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(v2 == <span class="number">1</span>) {</span><br><span class="line">                    <span class="type">char</span>[] v5 = <span class="string">"dd2940c04462b4dd7c450528835cca15"</span>.toCharArray();</span><br><span class="line">                    v5[v9] = ((<span class="type">char</span>)(v5[v9] + v5[<span class="number">3</span>] - <span class="number">50</span>));</span><br><span class="line">                    v5[<span class="number">4</span>] = ((<span class="type">char</span>)(v5[v9] + v5[<span class="number">5</span>] - <span class="number">0x30</span>));</span><br><span class="line">                    v5[<span class="number">30</span>] = ((<span class="type">char</span>)(v5[v11] + v5[<span class="number">9</span>] - <span class="number">0x30</span>));</span><br><span class="line">                    v5[<span class="number">14</span>] = ((<span class="type">char</span>)(v5[<span class="number">27</span>] + v5[<span class="number">28</span>] - <span class="number">97</span>));</span><br><span class="line">                    <span class="type">int</span> v4;</span><br><span class="line">                    <span class="keyword">for</span>(v4 = <span class="number">0</span>; v4 &lt; <span class="number">16</span>; ++v4) {</span><br><span class="line">                        <span class="type">char</span> <span class="variable">v0</span> <span class="operator">=</span> v5[<span class="number">0x1F</span> - v4];</span><br><span class="line">                        v5[<span class="number">0x1F</span> - v4] = v5[v4];</span><br><span class="line">                        v5[v4] = v0;</span><br><span class="line">                    }</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">this</span>.val$textview.setText(<span class="string">"flag{"</span> + String.valueOf(v5) + <span class="string">"}"</span>);</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">else</span> {</span><br><span class="line">                    <span class="built_in">this</span>.val$textview.setText(<span class="string">"输入注册码错误"</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreateOptionsMenu</span><span class="params">(Menu arg3)</span> {</span><br><span class="line">        <span class="built_in">this</span>.getMenuInflater().inflate(<span class="number">0x7F0C0000</span>, arg3);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onOptionsItemSelected</span><span class="params">(MenuItem arg3)</span> {</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">v1</span> <span class="operator">=</span> arg3.getItemId() == <span class="number">0x7F050040</span> ? <span class="literal">true</span> : <span class="built_in">super</span>.onOptionsItemSelected(arg3);</span><br><span class="line">        <span class="keyword">return</span> v1;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>分析代码，编写脚本，基本语句不变，只需打印出经过处理后的v5的值</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="type">int</span> v9 = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> v2 = <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> v11 = <span class="number">0x1F</span>;</span><br><span class="line">    <span class="type">char</span> v5[] = <span class="string">"dd2940c04462b4dd7c450528835cca15"</span>;</span><br><span class="line">    v5[v9] = ((<span class="type">char</span>)(v5[v9] + v5[<span class="number">3</span>] - <span class="number">50</span>));</span><br><span class="line">    v5[<span class="number">4</span>] = ((<span class="type">char</span>)(v5[v9] + v5[<span class="number">5</span>] - <span class="number">0x30</span>));</span><br><span class="line">    v5[<span class="number">30</span>] = ((<span class="type">char</span>)(v5[v11] + v5[<span class="number">9</span>] - <span class="number">0x30</span>));</span><br><span class="line">    v5[<span class="number">14</span>] = ((<span class="type">char</span>)(v5[<span class="number">27</span>] + v5[<span class="number">28</span>] - <span class="number">97</span>));</span><br><span class="line">    <span class="type">int</span> v4;</span><br><span class="line">    <span class="keyword">for</span>(v4 = <span class="number">0</span>; v4 &lt; <span class="number">16</span>; ++v4) {</span><br><span class="line">        <span class="type">char</span> v0 = v5[<span class="number">0x1F</span> - v4];</span><br><span class="line">        v5[<span class="number">0x1F</span> - v4] = v5[v4];</span><br><span class="line">        v5[v4] = v0;</span><br><span class="line">    }</span><br><span class="line">    cout&lt;&lt;v5&lt;&lt;endl;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>运行得到 <code>flag{59acc538825054c7de4b26440c0999dd}</code>。</p>
<h3 id="gwctf-2019pyre">16.[GWCTF 2019]pyre</h3>
<p>本题参考 https://itcn.blog/p/5736602304.html</p>
<p>利用在线工具（https://tool.lu/pyc/）反编译pyc文件</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 2.7</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> <span class="string">'Welcome to Re World!'</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">'Your input1 is your flag~'</span></span><br><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [</span><br><span class="line">    <span class="string">'%1f'</span>,</span><br><span class="line">    <span class="string">'%12'</span>,</span><br><span class="line">    <span class="string">'%1d'</span>,</span><br><span class="line">    <span class="string">'('</span>,</span><br><span class="line">    <span class="string">'0'</span>,</span><br><span class="line">    <span class="string">'4'</span>,</span><br><span class="line">    <span class="string">'%01'</span>,</span><br><span class="line">    <span class="string">'%06'</span>,</span><br><span class="line">    <span class="string">'%14'</span>,</span><br><span class="line">    <span class="string">'4'</span>,</span><br><span class="line">    <span class="string">','</span>,</span><br><span class="line">    <span class="string">'%1b'</span>,</span><br><span class="line">    <span class="string">'U'</span>,</span><br><span class="line">    <span class="string">'?'</span>,</span><br><span class="line">    <span class="string">'o'</span>,</span><br><span class="line">    <span class="string">'6'</span>,</span><br><span class="line">    <span class="string">'*'</span>,</span><br><span class="line">    <span class="string">':'</span>,</span><br><span class="line">    <span class="string">'%01'</span>,</span><br><span class="line">    <span class="string">'D'</span>,</span><br><span class="line">    <span class="string">';'</span>,</span><br><span class="line">    <span class="string">'%'</span>,</span><br><span class="line">    <span class="string">'%13'</span>]</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>猜测 code 中的值为ASCII码相对应的字符。</p>
<p>将字符转换为对应的ASCII码，编写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 31 18 29 40 48 52 1 6 20 52 44 27 85 63 111 54 42 58 1 68 59 37 19</span></span><br><span class="line">s=[<span class="number">19</span>,<span class="number">37</span>,<span class="number">59</span>,<span class="number">68</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">42</span>,<span class="number">54</span>,<span class="number">111</span>,<span class="number">63</span>,<span class="number">85</span>,<span class="number">27</span>,<span class="number">44</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">52</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">29</span>,<span class="number">18</span>,<span class="number">31</span>]</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)-<span class="number">1</span>):</span><br><span class="line">    s[i+<span class="number">1</span>]=s[i+<span class="number">1</span>]^s[i]</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">s.reverse()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>((s[i]-i)%<span class="number">128</span>)    <span class="comment">#由A=(B-C)%D可知B-C=D*n+A,即B=A+C+D*n,当B&lt;D时，两边对D取模，则B%D=(A+C+D*n)%D=(A+C)%D</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行得到flag：<code>GWHT{Just_Re_1s_Ha66y!}</code>。</p>
<h3 id="actf新生赛2020easyre">17.[ACTF新生赛2020]easyre</h3>
<p>参考：https://blog.csdn.net/weixin_46009088/article/details/109521777</p>
<p>首先解压tar文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908202330115.png" alt="image-20220908202330115">
<figcaption aria-hidden="true">image-20220908202330115</figcaption>
</figure>
<p>利用Exeinfo PE打开文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908202507565.png" alt="image-20220908202507565">
<figcaption aria-hidden="true">image-20220908202507565</figcaption>
</figure>
<p>发现upx壳，直接利用upx脱壳</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908202848127.png" alt="image-20220908202848127">
<figcaption aria-hidden="true">image-20220908202848127</figcaption>
</figure>
<p>F5查看main函数伪代码</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [esp+12h] [ebp-2Eh]</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [esp+13h] [ebp-2Dh]</span></span><br><span class="line">  <span class="type">char</span> v6; <span class="comment">// [esp+14h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// [esp+15h] [ebp-2Bh]</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [esp+16h] [ebp-2Ah]</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [esp+17h] [ebp-29h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [esp+18h] [ebp-28h]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [esp+19h] [ebp-27h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [esp+1Ah] [ebp-26h]</span></span><br><span class="line">  <span class="type">char</span> v13; <span class="comment">// [esp+1Bh] [ebp-25h]</span></span><br><span class="line">  <span class="type">char</span> v14; <span class="comment">// [esp+1Ch] [ebp-24h]</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// [esp+1Dh] [ebp-23h]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [esp+1Eh] [ebp-22h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [esp+22h] [ebp-1Eh]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [esp+26h] [ebp-1Ah]</span></span><br><span class="line">  __int16 v19; <span class="comment">// [esp+2Ah] [ebp-16h]</span></span><br><span class="line">  <span class="type">char</span> v20; <span class="comment">// [esp+2Ch] [ebp-14h]</span></span><br><span class="line">  <span class="type">char</span> v21; <span class="comment">// [esp+2Dh] [ebp-13h]</span></span><br><span class="line">  <span class="type">char</span> v22; <span class="comment">// [esp+2Eh] [ebp-12h]</span></span><br><span class="line">  <span class="type">int</span> v23; <span class="comment">// [esp+2Fh] [ebp-11h]</span></span><br><span class="line">  <span class="type">int</span> v24; <span class="comment">// [esp+33h] [ebp-Dh]</span></span><br><span class="line">  <span class="type">int</span> v25; <span class="comment">// [esp+37h] [ebp-9h]</span></span><br><span class="line">  <span class="type">char</span> v26; <span class="comment">// [esp+3Bh] [ebp-5h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+3Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  v4 = <span class="string">'*'</span>;</span><br><span class="line">  v5 = <span class="string">'F'</span>;</span><br><span class="line">  v6 = <span class="string">'\''</span>;</span><br><span class="line">  v7 = <span class="string">'"'</span>;</span><br><span class="line">  v8 = <span class="number">78</span>;</span><br><span class="line">  v9 = <span class="number">44</span>;</span><br><span class="line">  v10 = <span class="number">34</span>;</span><br><span class="line">  v11 = <span class="number">40</span>;</span><br><span class="line">  v12 = <span class="number">73</span>;</span><br><span class="line">  v13 = <span class="number">63</span>;</span><br><span class="line">  v14 = <span class="number">43</span>;</span><br><span class="line">  v15 = <span class="number">64</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please input:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v19);</span><br><span class="line">  <span class="keyword">if</span> ( (_BYTE)v19 != <span class="number">65</span> || HIBYTE(v19) != <span class="number">67</span> || v20 != <span class="number">84</span> || v21 != <span class="number">70</span> || v22 != <span class="number">123</span> || v26 != <span class="number">125</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v16 = v23;</span><br><span class="line">  v17 = v24;</span><br><span class="line">  v18 = v25;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">11</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( *(&amp;v4 + i) != _data_start__[*((<span class="type">char</span> *)&amp;v16 + i) - <span class="number">1</span>] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"You are correct!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>将第43行的数字转为字符（按R键）</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (_BYTE)v19 != <span class="string">'A'</span> || HIBYTE(v19) != <span class="string">'C'</span> || v20 != <span class="string">'T'</span> || v21 != <span class="string">'F'</span> || v22 != <span class="string">'{'</span> || v26 != <span class="string">'}'</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>分析代码，双击<code>_data_start_</code>查看字符串</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220908203511791.png" alt="image-20220908203511791">
<figcaption aria-hidden="true">image-20220908203511791</figcaption>
</figure>
<p>猜测flag为<code>_data_start__[*((char *)&amp;v16 + i) - 1]</code>方括号里的内容，即<code>*((char *)&amp;v16 + i) - 1</code>，或者为<code>*((char *)&amp;v16 + i)</code>，编写脚本得到flag</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">data_start=<span class="string">'~}|{zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(\'&amp;%$# !"'</span></span><br><span class="line">v4=[<span class="number">42</span>,<span class="number">70</span>,<span class="number">39</span>,<span class="number">34</span>,<span class="number">78</span>,<span class="number">44</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">73</span>,<span class="number">63</span>,<span class="number">43</span>,<span class="number">64</span>]</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">v16=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(data_start.find(<span class="built_in">chr</span>(v4[i]))+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p><code>flag{U9X_1S_W6@T?}</code></p>
<h3 id="findit">18.findit</h3>
<p>下载附件，发现是压缩包里是apk文件，用 jeb 打开文件，发现中文提示</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">00000190  iget-object         v5, p0, MainActivity$1-&gt;val$text:TextView</span><br><span class="line">00000194  const-string        v6, "答案错了肿么办。。。不给你又不好意思。。。哎呀好纠结啊~~~"</span><br><span class="line">00000198  invoke-virtual      TextView-&gt;setText(CharSequence)V, v5, v6</span><br><span class="line">0000019E  goto/16             :6E</span><br><span class="line">.end method</span><br></pre></td></tr></tbody></table></figure>
<p>在此处右击进行解析，以下是部分代码</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">ActionBarActivity</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainActivity</span><span class="params">()</span> {</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle arg8)</span> {</span><br><span class="line">        <span class="built_in">super</span>.onCreate(arg8);</span><br><span class="line">        <span class="built_in">this</span>.setContentView(<span class="number">0x7F030018</span>);</span><br><span class="line">        <span class="built_in">this</span>.findViewById(<span class="number">0x7F05003D</span>).setOnClickListener(<span class="keyword">new</span> <span class="title class_">View$OnClickListener</span>(<span class="keyword">new</span> <span class="title class_">char</span>[]{<span class="string">'T'</span>, <span class="string">'h'</span>, <span class="string">'i'</span>, <span class="string">'s'</span>, <span class="string">'I'</span>, <span class="string">'s'</span>, <span class="string">'T'</span>, <span class="string">'h'</span>, <span class="string">'e'</span>, <span class="string">'F'</span>, <span class="string">'l'</span>, <span class="string">'a'</span>, <span class="string">'g'</span>, <span class="string">'H'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">'e'</span>}, <span class="built_in">this</span>.findViewById(<span class="number">0x7F05003E</span>), <span class="keyword">new</span> <span class="title class_">char</span>[]{<span class="string">'p'</span>, <span class="string">'v'</span>, <span class="string">'k'</span>, <span class="string">'q'</span>, <span class="string">'{'</span>, <span class="string">'m'</span>, <span class="string">'1'</span>, <span class="string">'6'</span>, <span class="string">'4'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'2'</span>, <span class="string">'6'</span>, <span class="string">'2'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'l'</span>, <span class="string">'4'</span>, <span class="string">'m'</span>, <span class="string">'4'</span>, <span class="string">'9'</span>, <span class="string">'l'</span>, <span class="string">'n'</span>, <span class="string">'p'</span>, <span class="string">'7'</span>, <span class="string">'p'</span>, <span class="string">'9'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'k'</span>, <span class="string">'2'</span>, <span class="string">'8'</span>, <span class="string">'k'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'}'</span>}, <span class="built_in">this</span>.findViewById(<span class="number">0x7F05003F</span>)) {</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View arg13)</span> {</span><br><span class="line">                <span class="type">int</span> <span class="variable">v11</span> <span class="operator">=</span> <span class="number">17</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v10</span> <span class="operator">=</span> <span class="number">0x7A</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v9</span> <span class="operator">=</span> <span class="number">90</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v8</span> <span class="operator">=</span> <span class="number">65</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">v7</span> <span class="operator">=</span> <span class="number">97</span>;</span><br><span class="line">                <span class="type">char</span>[] v3 = <span class="keyword">new</span> <span class="title class_">char</span>[v11];</span><br><span class="line">                <span class="type">char</span>[] v4 = <span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">38</span>];</span><br><span class="line">                <span class="type">int</span> v0;</span><br><span class="line">                <span class="keyword">for</span>(v0 = <span class="number">0</span>; v0 &lt; v11; ++v0) {</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">this</span>.val$a[v0] &gt;= <span class="number">73</span> || <span class="built_in">this</span>.val$a[v0] &lt; v8) {</span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">this</span>.val$a[v0] &lt; <span class="number">105</span> &amp;&amp; <span class="built_in">this</span>.val$a[v0] &gt;= v7) {</span><br><span class="line">                        label_39:</span><br><span class="line">                            v3[v0] = ((<span class="type">char</span>)(<span class="built_in">this</span>.val$a[v0] + <span class="number">18</span>));</span><br><span class="line">                            goto label_44;</span><br><span class="line">                        }</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">this</span>.val$a[v0] &gt;= v8 &amp;&amp; <span class="built_in">this</span>.val$a[v0] &lt;= v9 || <span class="built_in">this</span>.val$a[v0] &gt;= v7 &amp;&amp; <span class="built_in">this</span>.val$a[v0] &lt;= v10) {</span><br><span class="line">                            v3[v0] = ((<span class="type">char</span>)(<span class="built_in">this</span>.val$a[v0] - <span class="number">8</span>));</span><br><span class="line">                            goto label_44;</span><br><span class="line">                        }</span><br><span class="line"></span><br><span class="line">                        v3[v0] = <span class="built_in">this</span>.val$a[v0];</span><br><span class="line">                    }</span><br><span class="line">                    <span class="keyword">else</span> {</span><br><span class="line">                        goto label_39;</span><br><span class="line">                    }</span><br><span class="line"></span><br><span class="line">                label_44:</span><br><span class="line">                }</span><br></pre></td></tr></tbody></table></figure>
<p>在第17行发现类似flag的字符，利用python转为连贯的字符串</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag=[<span class="string">'p'</span>, <span class="string">'v'</span>, <span class="string">'k'</span>, <span class="string">'q'</span>, <span class="string">'{'</span>, <span class="string">'m'</span>, <span class="string">'1'</span>, <span class="string">'6'</span>, <span class="string">'4'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'2'</span>, <span class="string">'6'</span>, <span class="string">'2'</span>, <span class="string">'0'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'l'</span>, <span class="string">'4'</span>, <span class="string">'m'</span>, <span class="string">'4'</span>, <span class="string">'9'</span>, <span class="string">'l'</span>, <span class="string">'n'</span>, <span class="string">'p'</span>, <span class="string">'7'</span>, <span class="string">'p'</span>, <span class="string">'9'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'k'</span>, <span class="string">'2'</span>, <span class="string">'8'</span>, <span class="string">'k'</span>, <span class="string">'7'</span>, <span class="string">'5'</span>, <span class="string">'}'</span>]</span><br><span class="line">flag=<span class="string">''</span>.join(flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>得到<code>pvkq{m164675262033l4m49lnp7p9mnk28k75}</code>，猜测可能经过了凯撒加密，利用在线工具得到<code>flag{c164675262033b4c49bdf7f9cda28a75}</code></p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220906193246304.png" alt="image-20220906193246304">
<figcaption aria-hidden="true">image-20220906193246304</figcaption>
</figure>
<h3 id="rsa">19.rsa</h3>
<p>参考：https://www.cnblogs.com/Nickyl07/p/12670317.html</p>
<p>根据题目名称可知，本题考查的是RSA算法，首先将附件里的公钥进行解析（<a target="_blank" rel="noopener" href="http://www.hiencode.com/pub_asys.html">在线工具</a>），解析结果如下：</p>
<blockquote>
<p>密钥类型：RSA</p>
<p>密钥强度：256</p>
<p>PN(e)：65537(十进制)</p>
<p>PN(n)：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">86934482296048119190666062003494800588905656017203025617216654058378322103517</span><br></pre></td></tr></tbody></table></figure>
<p>DER格式：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">303c300d06092a864886f70d0101010500032b003028022100c0332c5c64ae47182f6c1c876d42336910545a58f7eefefc0bcaaf5af341ccdd0203010001</span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<p>利用<a target="_blank" rel="noopener" href="http://factordb.com/index.php?">在线工具</a>分解 n
，得到</p>
<blockquote>
<p>p = 285960468890451637935629440372639283459</p>
<p>q = 304008741604601924494328155975272418463</p>
</blockquote>
<p>通过下面的脚本解得flag</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p = <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q = <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#通过已知条件，生成私钥，并解密密文</span></span><br><span class="line">private_key = rsa.PrivateKey(n, e, d, p, q)<span class="comment">#生成私钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"C:/Users/19594/Desktop/flag.enc"</span>,<span class="string">"rb+"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = rsa.decrypt(f.read(), private_key)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p><code>flag{decrypt_256}</code></p>
<h3 id="actf新生赛2020rome">20.[ACTF新生赛2020]rome</h3>
<p>首先解压文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220913214655907.png" alt="image-20220913214655907">
<figcaption aria-hidden="true">image-20220913214655907</figcaption>
</figure>
<p>利用exeinfoPE查看文件架构</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220913214801996.png" alt="image-20220913214801996">
<figcaption aria-hidden="true">image-20220913214801996</figcaption>
</figure>
<p>用IDA打开文件，直接F5查看伪代码：</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  __main();</span><br><span class="line">  func();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>双击查看<code>_main()</code>函数</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __main()</span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !initialized )</span><br><span class="line">  {</span><br><span class="line">    initialized = <span class="number">1</span>;</span><br><span class="line">    result = __do_global_ctors();</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>再查看<code>func()</code>函数</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [esp+14h] [ebp-44h]</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// [esp+18h] [ebp-40h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+1Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+20h] [ebp-38h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v5; <span class="comment">// [esp+24h] [ebp-34h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v6; <span class="comment">// [esp+25h] [ebp-33h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v7; <span class="comment">// [esp+26h] [ebp-32h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v8; <span class="comment">// [esp+27h] [ebp-31h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// [esp+28h] [ebp-30h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+29h] [ebp-2Fh]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+2Dh] [ebp-2Bh]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+31h] [ebp-27h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+35h] [ebp-23h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v14; <span class="comment">// [esp+39h] [ebp-1Fh]</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// [esp+3Bh] [ebp-1Dh]</span></span><br><span class="line">  <span class="type">char</span> v16; <span class="comment">// [esp+3Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> v17; <span class="comment">// [esp+3Dh] [ebp-1Bh]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [esp+3Eh] [ebp-1Ah]</span></span><br><span class="line">  <span class="type">char</span> v19; <span class="comment">// [esp+3Fh] [ebp-19h]</span></span><br><span class="line">  <span class="type">char</span> v20; <span class="comment">// [esp+40h] [ebp-18h]</span></span><br><span class="line">  <span class="type">char</span> v21; <span class="comment">// [esp+41h] [ebp-17h]</span></span><br><span class="line">  <span class="type">char</span> v22; <span class="comment">// [esp+42h] [ebp-16h]</span></span><br><span class="line">  <span class="type">char</span> v23; <span class="comment">// [esp+43h] [ebp-15h]</span></span><br><span class="line">  <span class="type">char</span> v24; <span class="comment">// [esp+44h] [ebp-14h]</span></span><br><span class="line">  <span class="type">char</span> v25; <span class="comment">// [esp+45h] [ebp-13h]</span></span><br><span class="line">  <span class="type">char</span> v26; <span class="comment">// [esp+46h] [ebp-12h]</span></span><br><span class="line">  <span class="type">char</span> v27; <span class="comment">// [esp+47h] [ebp-11h]</span></span><br><span class="line">  <span class="type">char</span> v28; <span class="comment">// [esp+48h] [ebp-10h]</span></span><br><span class="line">  <span class="type">char</span> v29; <span class="comment">// [esp+49h] [ebp-Fh]</span></span><br><span class="line">  <span class="type">char</span> v30; <span class="comment">// [esp+4Ah] [ebp-Eh]</span></span><br><span class="line">  <span class="type">char</span> v31; <span class="comment">// [esp+4Bh] [ebp-Dh]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v15 = <span class="number">81</span>;</span><br><span class="line">  v16 = <span class="number">115</span>;</span><br><span class="line">  v17 = <span class="number">119</span>;</span><br><span class="line">  v18 = <span class="number">51</span>;</span><br><span class="line">  v19 = <span class="number">115</span>;</span><br><span class="line">  v20 = <span class="number">106</span>;</span><br><span class="line">  v21 = <span class="number">95</span>;</span><br><span class="line">  v22 = <span class="number">108</span>;</span><br><span class="line">  v23 = <span class="number">122</span>;</span><br><span class="line">  v24 = <span class="number">52</span>;</span><br><span class="line">  v25 = <span class="number">95</span>;</span><br><span class="line">  v26 = <span class="number">85</span>;</span><br><span class="line">  v27 = <span class="number">106</span>;</span><br><span class="line">  v28 = <span class="number">119</span>;</span><br><span class="line">  v29 = <span class="number">64</span>;</span><br><span class="line">  v30 = <span class="number">108</span>;</span><br><span class="line">  v31 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please input:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v5);</span><br><span class="line">  result = v5;</span><br><span class="line">  <span class="keyword">if</span> ( v5 == <span class="number">65</span> )</span><br><span class="line">  {</span><br><span class="line">    result = v6;</span><br><span class="line">    <span class="keyword">if</span> ( v6 == <span class="number">67</span> )</span><br><span class="line">    {</span><br><span class="line">      result = v7;</span><br><span class="line">      <span class="keyword">if</span> ( v7 == <span class="number">84</span> )</span><br><span class="line">      {</span><br><span class="line">        result = v8;</span><br><span class="line">        <span class="keyword">if</span> ( v8 == <span class="number">70</span> )</span><br><span class="line">        {</span><br><span class="line">          result = v9;</span><br><span class="line">          <span class="keyword">if</span> ( v9 == <span class="number">123</span> )</span><br><span class="line">          {</span><br><span class="line">            result = v14;</span><br><span class="line">            <span class="keyword">if</span> ( v14 == <span class="number">125</span> )</span><br><span class="line">            {</span><br><span class="line">              v1 = v10;</span><br><span class="line">              v2 = v11;</span><br><span class="line">              v3 = v12;</span><br><span class="line">              v4 = v13;</span><br><span class="line">              <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">              {</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)&amp;v1 + i) &gt; <span class="number">64</span> &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= <span class="number">90</span> )</span><br><span class="line">                  *((_BYTE *)&amp;v1 + i) = (*((<span class="type">char</span> *)&amp;v1 + i) - <span class="number">51</span>) % <span class="number">26</span> + <span class="number">65</span>;</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)&amp;v1 + i) &gt; <span class="number">96</span> &amp;&amp; *((_BYTE *)&amp;v1 + i) &lt;= <span class="number">122</span> )</span><br><span class="line">                  *((_BYTE *)&amp;v1 + i) = (*((<span class="type">char</span> *)&amp;v1 + i) - <span class="number">79</span>) % <span class="number">26</span> + <span class="number">97</span>;</span><br><span class="line">              }</span><br><span class="line">              <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">              {</span><br><span class="line">                result = (<span class="type">unsigned</span> __int8)*(&amp;v15 + i);</span><br><span class="line">                <span class="keyword">if</span> ( *((_BYTE *)&amp;v1 + i) != (_BYTE)result )</span><br><span class="line">                  <span class="keyword">return</span> result;</span><br><span class="line">              }</span><br><span class="line">              result = <span class="built_in">printf</span>(<span class="string">"You are correct!"</span>);</span><br><span class="line">            }</span><br><span class="line">          }</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>通过分析代码写出脚本，这里我不会对取模进行逆运算，就直接暴力求解</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="string">'Qsw3sj_lz4_Ujw@l'</span></span><br><span class="line">s=<span class="built_in">list</span>(s)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        x=j</span><br><span class="line">        <span class="keyword">if</span> j&gt;<span class="number">64</span> <span class="keyword">and</span> j&lt;=<span class="number">90</span>:</span><br><span class="line">            j = (j-<span class="number">51</span>)%<span class="number">26</span>+<span class="number">65</span></span><br><span class="line">        <span class="keyword">if</span> j&gt;<span class="number">96</span> <span class="keyword">and</span> j&lt;=<span class="number">122</span>:</span><br><span class="line">            j = (j-<span class="number">79</span>)%<span class="number">26</span>+<span class="number">97</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">chr</span>(j)==s[i]:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(x)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p><code>flag{Cae3ar_th4_Gre@t}</code></p>
<h3 id="flareon4login">21.[FlareOn4]login</h3>
<p>下载附件后，发现共两个文件，一个 txt 文件，一个 html 文件，双击打开
html 文件，看不出什么，于是按F12，查看网页代码</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"prompt"</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) {</span><br><span class="line">                <span class="keyword">var</span> flag = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"flag"</span>).<span class="property">value</span>;</span><br><span class="line">                <span class="keyword">var</span> rotFlag = flag.<span class="title function_">replace</span>(<span class="regexp">/[a-zA-Z]/g</span>, <span class="keyword">function</span>(<span class="params">c</span>){<span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>((c &lt;= <span class="string">"Z"</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.<span class="title function_">charCodeAt</span>(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);});</span><br><span class="line">                <span class="title function_">alert</span>(rotFlag);<span class="keyword">if</span> (<span class="string">"PyvragFvqrYbtvafNerRnfl@syner-ba.pbz"</span> == rotFlag) {</span><br><span class="line">                    <span class="title function_">alert</span>(<span class="string">"Correct flag!"</span>);</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    <span class="title function_">alert</span>(<span class="string">"Incorrect flag, rot again"</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br></pre></td></tr></tbody></table></figure>
<p>本来想要逆向分析代码，但是怎么也写不对脚本，后来参考网上的wp，发现是
<code>ROT13</code>加密</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220913220646105.png" alt="image-20220913220646105">
<figcaption aria-hidden="true">image-20220913220646105</figcaption>
</figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rot13</span>(<span class="params">message</span>):</span><br><span class="line">    res = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> message:</span><br><span class="line">        <span class="keyword">if</span>  (item &gt;= <span class="string">'A'</span> <span class="keyword">and</span> item &lt;= <span class="string">'M'</span>) <span class="keyword">or</span> (item &gt;= <span class="string">'a'</span> <span class="keyword">and</span> item &lt;= <span class="string">'m'</span>):</span><br><span class="line">            res += <span class="built_in">chr</span>(<span class="built_in">ord</span>(item)+<span class="number">13</span>)</span><br><span class="line">        <span class="keyword">elif</span>  (item &gt;= <span class="string">'N'</span> <span class="keyword">and</span> item &lt;= <span class="string">'Z'</span>) <span class="keyword">or</span> (item &gt;= <span class="string">'n'</span> <span class="keyword">and</span> item &lt;= <span class="string">'z'</span>):</span><br><span class="line">            res += <span class="built_in">chr</span>(<span class="built_in">ord</span>(item)-<span class="number">13</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += item</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">s = <span class="string">'PyvragFvqrYbtvafNerRnfl@syner-ba.pbz'</span>   </span><br><span class="line"><span class="built_in">print</span> (rot13(s))           <span class="comment">#参考：https://www.jianshu.com/p/18794a1533b2</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>flag{ClientSideLoginsAreEasy@flare-on.com}</code></p>
<h3 id="crackrtf">22.CrackRTF</h3>
<p>参考：https://www.52pojie.cn/thread-994588-1-1.html</p>
<h2 id="cftshow">cftshow</h2>
<h3 id="逆向签到题">1.逆向签到题</h3>
<p>将文件拖进IDA中，得到flag。</p>
<h2 id="攻防世界">攻防世界</h2>
<h3 id="game">1.game</h3>
<p>用IDA打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c2f5d121af2b4f0e83b5ad0a56b2ed7b.png" alt="在这里插入图片描述">
双击“_main_0”进入该函数中，发现一些字符串，按F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/8ff18d19eb6e43149aa2ce03d611e2ad.png" alt="在这里插入图片描述"> <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/63c37f5e1dc04387b8108e0ecacf3143.png" alt="在这里插入图片描述"> 发现最终会进入sub_457AB4中，双击进入该函数
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/51ed2f780e61456b8fea5d8cd5ea1eec.png" alt="在这里插入图片描述"> 再次双击sub_45E940函数 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/db11f50a22ce467c89f1ed07efc32667.png" alt="在这里插入图片描述">
（注：如果IDA不能正确的获得自定义函数的名字，那么IDA会用sub__加上自定义函数的起始地址来定义函数的名字）
发现有两组数组进行了异或运算，通过伪代码编写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">18</span>,<span class="number">64</span>,<span class="number">98</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">48</span>,<span class="number">49</span>,<span class="number">65</span>,<span class="number">32</span>,<span class="number">12</span>,<span class="number">48</span>,<span class="number">65</span>,<span class="number">31</span>,<span class="number">78</span>,<span class="number">62</span>,</span><br><span class="line"><span class="number">32</span>,<span class="number">49</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">57</span>,<span class="number">96</span>,<span class="number">3</span>,<span class="number">21</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">44</span>,<span class="number">65</span>,<span class="number">78</span>,<span class="number">32</span>,<span class="number">16</span>,</span><br><span class="line"><span class="number">97</span>,<span class="number">54</span>,<span class="number">16</span>,<span class="number">44</span>,<span class="number">52</span>,<span class="number">32</span>,<span class="number">64</span>,<span class="number">89</span>,<span class="number">45</span>,<span class="number">32</span>,<span class="number">65</span>,<span class="number">15</span>,<span class="number">34</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">0</span>]</span><br><span class="line">b=[<span class="number">123</span>,<span class="number">32</span>,<span class="number">18</span>,<span class="number">98</span>,<span class="number">119</span>,<span class="number">108</span>,<span class="number">65</span>,<span class="number">41</span>,<span class="number">124</span>,<span class="number">80</span>,<span class="number">125</span>,<span class="number">38</span>,<span class="number">124</span>,</span><br><span class="line"><span class="number">111</span>,<span class="number">74</span>,<span class="number">49</span>,<span class="number">83</span>,<span class="number">108</span>,<span class="number">94</span>,<span class="number">108</span>,<span class="number">84</span>,<span class="number">6</span>,<span class="number">96</span>,<span class="number">83</span>,<span class="number">44</span>,<span class="number">121</span>,<span class="number">104</span>,<span class="number">110</span>,</span><br><span class="line"><span class="number">32</span>,<span class="number">95</span>,<span class="number">117</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">123</span>,<span class="number">127</span>,<span class="number">119</span>,<span class="number">96</span>,<span class="number">48</span>,<span class="number">107</span>,<span class="number">71</span>,<span class="number">92</span>,<span class="number">29</span>,<span class="number">81</span>,</span><br><span class="line"><span class="number">107</span>,<span class="number">90</span>,<span class="number">85</span>,<span class="number">64</span>,<span class="number">12</span>,<span class="number">43</span>,<span class="number">76</span>,<span class="number">86</span>,<span class="number">13</span>,<span class="number">114</span>,<span class="number">1</span>,<span class="number">117</span>,<span class="number">126</span>,<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">while</span>(i&lt;<span class="number">56</span>):</span><br><span class="line">    b[i]^=a[i]</span><br><span class="line">    b[i]^=<span class="number">0x13</span></span><br><span class="line">    flag=flag+<span class="built_in">chr</span>(b[i])</span><br><span class="line">    i=i+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行结果为 </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zsctf{T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t}</span><br></pre></td></tr></tbody></table></figure> ### 2.open-source
下载附件，是.c文件，用文本编辑器打开 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/d606c4ac2c594c7c903df3afcd63fabe.png" alt="在这里插入图片描述">
根据代码可知first=0xcafe，second%17=8，最后算出hash=12648430，转为十六进制为：c0ffee。所以flag为c0ffee。<p></p>
<h3 id="simple-unpack">3.simple-unpack</h3>
<h4 id="方法一">方法一</h4>
<p>根据提示该文件为被加壳的二进制文件。 用exeinfope打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/9a02f2e97d0148cba285166c7088cd42.png" alt="在这里插入图片描述"> 直接尝试upx脱壳 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ac2439789e0d4ef297342427e7bc12d3.png" alt="在这里插入图片描述">
用IDA打开文件直接看见flag{Upx_1s_n0t_a_d3liv3r_c0mp4ny}。 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/c495350207434c99b5784d4225766df1.png" alt="在这里插入图片描述"></p>
<h4 id="方法二">方法二</h4>
<p>用IDA打开文件时选择二进制文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/d23e4a85f9414e2e87943e28c482941e.png" alt="在这里插入图片描述"> 按Shift+F12，然后搜索‘flag’ <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1810e9d9faed454f9a728943e9a9edca.png" alt="在这里插入图片描述"></p>
<h3 id="logmein">4.logmein</h3>
<p>用IDA打开，直接F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5a503386fe6a415bae01b8ee2b4337e3.png" alt="在这里插入图片描述"> 发现是异或运算，转换v7类型 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/448ef3fcf2aa4570941e8b607236d17f.png" alt="在这里插入图片描述">
又因为文件是x86-64架构，所以字节顺序为小端序（https://hxt616.github.io/2022/02/21/little-endian/）
因此v7做异或运算时的字符顺序为“harambe”，用python编写脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">':\"AL_RT^L*.?+6/46'</span></span><br><span class="line">b=<span class="string">"harambe"</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(b[i%<span class="number">7</span>])^<span class="built_in">ord</span>(a[i]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行结果为 </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RC3-<span class="number">2016</span>-XORISGUD</span><br></pre></td></tr></tbody></table></figure> ### 5.insanity 用exeinfo pe打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/04cbbc6e77144d55b687d54cf346693a.png" alt="在这里插入图片描述"> 发现是Linux下的32位的ELF文件
用IDA打开，进入main函数，F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1909d790c1fd42ad90732614588a343d.png" alt="在这里插入图片描述"> 未发现什么特殊字符，于是按Shift+F12查看字符
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/2078b7be2a154ea599fae3b4855df924.png" alt="在这里插入图片描述"> 发现flag：9447{This_is_a_flag}<p></p>
<h3 id="helloctf">6.Hello，CTF</h3>
<p>用IDA打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6c68bef755ad47629a52c94e440f246d.png" alt="在这里插入图片描述"> F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/e5e959d835b648f88ab5a748167c8754.png" alt="在这里插入图片描述">
得到一串特殊字符串，通过十六进制解码得到flag：CrackMeJustForFun</p>
<p><img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/3cd1ed483fa74c80940f19e7822df157.png" alt="在这里插入图片描述"> ### 7.python-trade
下载文件，发现是pyc文件。首先要了解pyc文件是什么。</p>
<p>参考（https://blog.csdn.net/zong596568821xp/article/details/87341933）
.pyc文件是由.py文件经过编译后生成的字节码文件，其加载速度相对于之前的.py文件有所提高，而且还可以实现源码隐藏，以及一定程度上的反编译。</p>
<p>了解了pyc文件后，尝试将其反编译，利用在线工具（https://tool.lu/pyc/）实现，结果如下：
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/f8e0588a947345c88ee2f65a454794bc.png" alt="在这里插入图片描述">
分析代码，发现flag经过加密后为“XlNkVmtUI1MgXWBZXCFeKY+AaXNt”，于是编写脚本进行解密</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">correct = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line"></span><br><span class="line">dec = base64.b64decode(correct)</span><br><span class="line"><span class="built_in">print</span>(dec)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'^SdVkT#S ]`Y\\!^)\x8f\x80ism'</span>:</span><br><span class="line">    flag += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i)-<span class="number">16</span>)^<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行结果为： </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">b'^SdVkT#S ]`Y\\!^)\x8f\x80ism'</span></span><br><span class="line">nctf{d3c0mpil1n9_PyC}</span><br></pre></td></tr></tbody></table></figure> ### 8.no-strings-attached
参考：https://www.cnblogs.com/Mayfly-nymph/p/11403297.html 首先用Exeinfo
PE查看文件架构 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5dd9baa0b1fa4b248888db6f6474cd6c.png" alt="在这里插入图片描述"> 用32位IDA打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/ee267419b82a44c8bf99024039e05ae9.png" alt="在这里插入图片描述"> F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/bd611bf38fdd4e8ca23b44525f06897c.png" alt="在这里插入图片描述">
对每个函数进行查看，发现authenticate()函数中可能含有flag。 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6a351ce0e6f44b0b850a186c913bac91.png" alt="在这里插入图片描述">
分析代码可知s2的内容为flag，ws为用户输入内容。然后查看decrypt函数内容
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/633ec1ecec8747e88667abfa1898163c.png" alt="在这里插入图片描述">
上图中的代码逻辑为：将s的值赋给dest，再将dest的每个值减去a2的每个值。
查看authenticate函数的汇编代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/1170c5b73a634e03b10996d9d9bd91ea.png" alt="在这里插入图片描述">
由上图红框中的内容可知eax储存着decryp函数返回的flag值，然后再保存到s2。
接着进行gdb调试 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/8855a06945be461ca80db3b1aa125bb5.png" alt="在这里插入图片描述"> 设置断点 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/f3b23be59432442e991473cd7f90c575.png" alt="在这里插入图片描述"> 执行到断点 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/823c9081338a4b029d4a121ec9b08e44.png" alt="在这里插入图片描述"> 单步运行 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/da38193b35c1466fbff24689ab6abf24.png" alt="在这里插入图片描述"> 查看eax的值 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/6b930b1bd2db4f5ea0d731ce069b697b.png" alt="在这里插入图片描述">
其中3为显示行数，s为字符串形式，w为word（4字节）形式。
得到flag：9447{you_are_an_international_mystery}<p></p>
<h3 id="getit">9.getit</h3>
<p>首先用Exeinfo PE查看文件架构，可知是64位文件，用IDA64打开 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/2ba1801ffc8146e3a84a4262615250a9.png" alt="在这里插入图片描述"> 在main处按下F5查看伪代码 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/73987c0a3dd64e14baba86b2417e4420.png" alt="在这里插入图片描述">
分析代码可知，flag.txt文件中的内容就是<strong>t</strong>。通过12到20行的代码编写出脚本</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">'c61b68366edeb7bdce3c6820314b7498'</span></span><br><span class="line">v5 = <span class="number">0</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> v5&lt;<span class="built_in">len</span>(s):</span><br><span class="line">    <span class="keyword">if</span> v5 &amp; <span class="number">1</span>:</span><br><span class="line">        v3 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v3 = -<span class="number">1</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(s[v5]) + v3)</span><br><span class="line">    v5+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>得到flag为<code>b70c59275fcfa8aebf2d5911223c6589</code> ###
10.Reversing-x64Elf-100 由题可知文件为64位，用IDA64打开文件 <img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/5ddd22044736463cb621f063519cfdf9.png" alt="在这里插入图片描述"> 发现main函数，双击进入，F5查看伪代码<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/3b0c90f6995f4fe9ac30ee8ba4941303.png" alt="在这里插入图片描述"> 分析代码可知sub_4006FD函数比较关键，双击查看
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/89beadfb0bc3436db4e85889162b9c26.png" alt="在这里插入图片描述">
分析代码可知上图代码中的<code>a1</code>为传入的参数，即用户输入的内容，同时也是flag。if语句中的式子可知v3为二维数组，又由给出的三个字符串可知，二维数组为：<code>v3=["Dufhbmf","pG`imos","ewUglpt"]</code>，当if条件成立返回1，则输出<code>Incorrect password!</code>,反之输出<code>Nice!</code>，此时等式成立，所以a1的值为二维数组的每个元素减一。用python脚本解决</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">i=<span class="number">0</span></span><br><span class="line">v3=[<span class="string">"Dufhbmf"</span>,<span class="string">"pG`imos"</span>,<span class="string">"ewUglpt"</span>]</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> i&lt;=<span class="number">11</span>:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(v3[i%<span class="number">3</span>][<span class="number">2</span>*<span class="built_in">int</span>(i/<span class="number">3</span>)])-<span class="number">1</span>)</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<p>运行得到flag为<code>Code_Talkers</code> ### 11.666
异或的运算优先级低于加减法 wp </p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">key=<span class="built_in">int</span>(<span class="string">'12'</span>,<span class="number">16</span>)   <span class="comment">#将12h转换为十进制，则key=18</span></span><br><span class="line">s=<span class="string">'izwhroz""w"v.K".Ni'</span></span><br><span class="line"><span class="comment">#s=list(s)</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> i&lt;key:</span><br><span class="line">    v5=s[i]</span><br><span class="line">    v4=s[i+<span class="number">1</span>]</span><br><span class="line">    v3=s[i+<span class="number">2</span>]</span><br><span class="line">    flag+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(v5)^key)-<span class="number">6</span>)    <span class="comment">#注意运算符优先级</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>((<span class="built_in">ord</span>(v4)^key)+<span class="number">6</span>)</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(v3)^key^<span class="number">6</span>)</span><br><span class="line">    i+=<span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></tbody></table></figure>
<code>unctf{b66_6b6_66b}</code><p></p>
<h2 id="bugku-ctf">BugKu CTF</h2>
<h3 id="easy_vb">1.Easy_vb</h3>
<p>下载附件，首先用Exeinfo
PE查看文件，发现是32位文件，用IDA打开文件，找到flag</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907165026692.png" alt="image-20220907165026692">
<figcaption aria-hidden="true">image-20220907165026692</figcaption>
</figure>
<p><code>flag{_N3t_Rev_1s_E4ay_}</code></p>
<h3 id="逆向入门">2.逆向入门</h3>
<p>打开附件压缩包发现exe文件，用Exeinfo PE打开文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907122850797.png" alt="image-20220907122850797">
<figcaption aria-hidden="true">image-20220907122850797</figcaption>
</figure>
<p>发现不是exe文件，再用010Editor打开文件，发现一段字符串，由于文本过长，以下展示部分字符串</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAgAElEQVR4Xu29CdhuyVXXW4dAmBIghqEDCIg5aWQmAyhT0oCgkj6CE4HjdT7pgHLVpGVwgsP14nBDixMGGofHxyYRRzodFS7Y6SBc0SSAECA5DDKmQcKUMKPnPr/vPdW9z9t77/rV3uutd7/fqXqe7+nkvLWrVv1r1frXsFbVhevXr19PPXUEOgIdgY5AR6ASgQudQCoR69k7Ah2BjkBH4AyBTiBdEToCHYGOQEdgEQKdQBbB1j/qCHQEOgIdgU4gXQc6Ah2BjkBHYBECnUAWwdY/6gh0BDoCHYFOIF0HOgIdgY5AR2ARAp1AFsHWP+oIdAQ6Ah2BTiBdBzoCHYGOQEdgEQJVBPLmN785PfDAA+kNb3hD+omf+ImbKiQe8cKFC4uE2P/IlBWVZ0rg22+/PT3taU9Lz33ucxe16TWveU3Kf0sKOHT7DOaRGDzjGc9Iz3nOc84wPVTKeKOfue/e8z3f81DVhZW7dlwZXUFYk28sDxhmPJ/4xCeGtXu/oJe+9KXpjW98YwKPNfVhm7Kdohx0j78lKZfz+te/fsnnizE343ORQBMfLe1jTSAMyrvvvvsxxBHZiC2WheK9+MUvTjUD5+rVq+nlL3/5FpuzSCYG4Vd+5VdWYXDPPfekr/mar3lMfc9//vMTf9Fpqr4XvvCF6bM+67Oiqwsr75TGFUaGsRA9CQCDL/7iLz6bmA7TkvoYd4y//YQOoAs2QWLYOyYlt1KqxVwRCGBevnz5liOPrDh33nln+qIv+iKlR1/1VV+V+DtvCSKFREyaGsT5W4wQq5GoVMIcuZfOQKNkHCvnFMcVE6n777+/ajJRwhDjvk8e+ZuayQvG/q677pqsrmbyct4mgaU+2Cfu++67T/WxIhBmkszwbuXEoDHbIc985jPPLUzWEF+6dGl2sgGO4BmVSpg//elP3ySpl4gvCp/ocmoMcanu0mSD75m8MYkrJeR67WtfO5vt1a9+damYM91Fh2/lZFfuikBYXrIXeCsnM2suzYBOHT+jVMyq77jjjmJTzUAuFpLS2czVbFFF1Wdksnle9KIXpYceeshm30y+Zz/72enLvuzLQuQxJPqZn/mZCaxKCb1D/+YSk+HSFtwrX/nKs+2rWzlx9ovdLyVFIIbZSxWd+u9m1tUJJJ0N4JYEYmaw6J5dQbbU01MdV5ErSIOBXUGyLfqWt7xlNYEYUmupJ8eoy2LeCUT2TieQdHYoXpq9ASfbDXjTTCXKGDtgl11xUzZmwnjvlJJZQZbKiP7dGM/oOqPKe/DBB9Ueeak+i4FZQZZWdE94whMSq4tS6gSSUieQkpZU/n6rE0jNtkVpC8CepZS6iL1qtq9Ks07KYdZsDwZL9Ub9bo1nVH2R5dQ4lszVazEw46+0nWm2YJG1E0gnkMixclaWUeDzuoUFebAfWuPKzAqDgTg07swAmSWaA9FSB065fs59xxYHB7I17SjJseZ3azzX1HHIb82YKNVfgwG6w3nIXGLygq7uTypqZO0EcmQCwVCwTUEg2lYGa1Y6Zq38lbw19pXUKOASAgEn/oyHV2kw8jttw7hOuU</span><br></pre></td></tr></tbody></table></figure>
<p>发现是png文件的base64编码，利用在线网站(https://tool.chinaz.com/tools/imgtobase)将编码转为图片</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907123348942.png" alt="image-20220907123348942">
<figcaption aria-hidden="true">image-20220907123348942</figcaption>
</figure>
<p>扫码得到flag：<code>bugku{inde_9882ihsd8-0}</code></p>
<h3 id="love">3.love</h3>
<p>用IDA打开文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907105903812.png" alt="image-20220907105903812">
<figcaption aria-hidden="true">image-20220907105903812</figcaption>
</figure>
<p>鼠标移至<code>_main_0</code>处，按F5查看伪代码</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">{</span><br><span class="line">  <span class="keyword">return</span> main_0();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>双击<code>main_0()</code>函数</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">__int64 __cdecl <span class="title function_">main_0</span><span class="params">()</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">size_t</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// edx</span></span><br><span class="line">  __int64 v4; <span class="comment">// ST08_8</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> j; <span class="comment">// [esp+DCh] [ebp-ACh]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+E8h] [ebp-A0h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v8; <span class="comment">// [esp+E8h] [ebp-A0h]</span></span><br><span class="line">  <span class="type">char</span> Dest[<span class="number">108</span>]; <span class="comment">// [esp+F4h] [ebp-94h]</span></span><br><span class="line">  <span class="type">char</span> Str; <span class="comment">// [esp+160h] [ebp-28h]</span></span><br><span class="line">  <span class="type">char</span> v11; <span class="comment">// [esp+17Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)i &gt;= <span class="number">0x64</span> )</span><br><span class="line">      j____report_rangecheckfailure();</span><br><span class="line">    Dest[i] = <span class="number">0</span>;</span><br><span class="line">  }</span><br><span class="line">  sub_41132F(<span class="string">"please enter the flag:"</span>);</span><br><span class="line">  sub_411375(<span class="string">"%20s"</span>, &amp;Str);</span><br><span class="line">  v0 = j_strlen(&amp;Str);</span><br><span class="line">  v1 = (<span class="type">const</span> <span class="type">char</span> *)sub_4110BE(&amp;Str, v0, &amp;v11);</span><br><span class="line">  <span class="built_in">strncpy</span>(Dest, v1, <span class="number">0x28</span>u);</span><br><span class="line">  v8 = j_strlen(Dest);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v8; ++j )</span><br><span class="line">    Dest[j] += j;</span><br><span class="line">  v2 = j_strlen(Dest);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strncmp</span>(Dest, Str2, v2) )</span><br><span class="line">    sub_41132F(<span class="string">"rigth flag!\n"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    sub_41132F(<span class="string">"wrong flag!\n"</span>);</span><br><span class="line">  HIDWORD(v4) = v3;</span><br><span class="line">  LODWORD(v4) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>分析代码，判断 flag 应为 Str
的值，其中可分析出第22行<code>sub_411375</code>函数为输入函数（scanf），接着往下分析，第24行
Str 被函数<code>sub_4110BE</code>处理，双击查看</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> *__cdecl <span class="title function_">sub_411AB0</span><span class="params">(<span class="type">char</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> a2, <span class="type">int</span> *a3)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// STE0_4</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// STE0_4</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// STE0_4</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+D4h] [ebp-38h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+E0h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [esp+ECh] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+ECh] [ebp-20h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v11; <span class="comment">// [esp+ECh] [ebp-20h]</span></span><br><span class="line">  <span class="type">void</span> *Dst; <span class="comment">// [esp+F8h] [ebp-14h]</span></span><br><span class="line">  <span class="type">char</span> *v13; <span class="comment">// [esp+104h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( !a1 || !a2 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v9 = a2 / <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">signed</span> <span class="type">int</span>)(a2 / <span class="number">3</span>) % <span class="number">3</span> )</span><br><span class="line">    ++v9;</span><br><span class="line">  v10 = <span class="number">4</span> * v9;</span><br><span class="line">  *a3 = v10;</span><br><span class="line">  Dst = <span class="built_in">malloc</span>(v10 + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !Dst )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  j_memset(Dst, <span class="number">0</span>, v10 + <span class="number">1</span>);</span><br><span class="line">  v13 = a1;</span><br><span class="line">  v11 = a2;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v11 &gt; <span class="number">0</span> )</span><br><span class="line">  {</span><br><span class="line">    byte_41A144[<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    byte_41A144[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    byte_41A144[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">3</span> &amp;&amp; v11 &gt;= <span class="number">1</span>; ++i )</span><br><span class="line">    {</span><br><span class="line">      byte_41A144[i] = *v13;</span><br><span class="line">      --v11;</span><br><span class="line">      ++v13;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> ( !i )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( i )</span><br><span class="line">    {</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        *((_BYTE *)Dst + v7) = aAbcdefghijklmn[(<span class="type">signed</span> <span class="type">int</span>)(<span class="type">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">        v4 = v7 + <span class="number">1</span>;</span><br><span class="line">        *((_BYTE *)Dst + v4++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">        *((_BYTE *)Dst + v4++) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        *((_BYTE *)Dst + v4) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        v7 = v4 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        *((_BYTE *)Dst + v7) = aAbcdefghijklmn[(<span class="type">signed</span> <span class="type">int</span>)(<span class="type">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">        v5 = v7 + <span class="number">1</span>;</span><br><span class="line">        *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">        *((_BYTE *)Dst + v5++) = aAbcdefghijklmn[((byte_41A144[<span class="number">2</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF</span>)];</span><br><span class="line">        *((_BYTE *)Dst + v5) = aAbcdefghijklmn[<span class="number">64</span>];</span><br><span class="line">        v7 = v5 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        *((_BYTE *)Dst + v7) = aAbcdefghijklmn[(<span class="type">signed</span> <span class="type">int</span>)(<span class="type">unsigned</span> __int8)byte_41A144[<span class="number">0</span>] &gt;&gt; <span class="number">2</span>];</span><br><span class="line">        v6 = v7 + <span class="number">1</span>;</span><br><span class="line">        *((_BYTE *)Dst + v6++) = aAbcdefghijklmn[((byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>) | <span class="number">16</span> * (byte_41A144[<span class="number">0</span>] &amp; <span class="number">3</span>)];</span><br><span class="line">        *((_BYTE *)Dst + v6++) = aAbcdefghijklmn[((byte_41A144[<span class="number">2</span>] &amp; <span class="number">0xC0</span>) &gt;&gt; <span class="number">6</span>) | <span class="number">4</span> * (byte_41A144[<span class="number">1</span>] &amp; <span class="number">0xF</span>)];</span><br><span class="line">        *((_BYTE *)Dst + v6) = aAbcdefghijklmn[byte_41A144[<span class="number">2</span>] &amp; <span class="number">0x3F</span>];</span><br><span class="line">        v7 = v6 + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  *((_BYTE *)Dst + v7) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> Dst;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>发现<code>aAbcdefghijklmn</code>出现多次，双击查看</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907110655390.png" alt="image-20220907110655390">
<figcaption aria-hidden="true">image-20220907110655390</figcaption>
</figure>
<p>猜测为base64加密，回到<code>main_0</code>函数中继续分析，猜测第25行的变量<code>Dest</code>的值为经过base64加密后的值，第27
~
28行<code>Dest</code>经过for循环处理，然后在第30行与<code>Str</code>进行比较，若相同则正确，说明<code>Str</code>的值与通过for循环处理的<code>Dest</code>的值相同，双击查看<code>Str</code>，发现</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907115838190.png" alt="image-20220907115838190">
<figcaption aria-hidden="true">image-20220907115838190</figcaption>
</figure>
<p>编写脚本得到for循环处理前的<code>Dest</code>，再通过base64解码，得到flag</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">s=<span class="string">'e3nifIH9b_C@n@dH'</span></span><br><span class="line">s=<span class="built_in">list</span>(s)</span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    s[i]=<span class="built_in">chr</span>(<span class="built_in">ord</span>(s[i])-i)</span><br><span class="line">    flag+=s[i]</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag))</span><br></pre></td></tr></tbody></table></figure>
<p><code>flag{i_l0ve_you}</code></p>
<h3 id="树木的小秘密">4.树木的小秘密</h3>
<p>参考：https://blog.csdn.net/qq_26961571/article/details/123334669</p>
<ul>
<li>本题学到的新知识：<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=PyInstaller&amp;spm=1001.2101.3001.7020">PyInstaller</a>是一个跨平台的Python应用打包工具，支持
Windows/Linux/MacOS三大主流平台，能够把 Python 脚本及其所在的 Python
解释器打包成可执行文件，从而允许最终用户在无需安装 Python
的情况下执行应用程序。 PyInstaller
制作出来的执行文件并不是跨平台的，如果需要为不同平台打包，就要在相应平台上运行PyInstaller进行打包。</li>
</ul>
<p>打开附件压缩包发现exe文件，用Exeinfo PE打开文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907123643112.png" alt="image-20220907123643112">
<figcaption aria-hidden="true">image-20220907123643112</figcaption>
</figure>
<p>利用IDA64打开文件</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907123925712.png" alt="image-20220907123925712">
<figcaption aria-hidden="true">image-20220907123925712</figcaption>
</figure>
<p>看来看去还是毫无思路，于是搜索别人的wp，发现本题的exe文件是由
pyinstaller 这个工具打包的，所以要利用工具<a target="_blank" rel="noopener" href="https://nchc.dl.sourceforge.net/project/pyinstallerextractor/dist/pyinstxtractor.py">pyinstxtractor.py</a>
进行反编译</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907171906770.png" alt="image-20220907171906770">
<figcaption aria-hidden="true">image-20220907171906770</figcaption>
</figure>
<p>得到一个文件夹，发现多个文件，其中一个文件名为123</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907172221181.png" alt="image-20220907172221181">
<figcaption aria-hidden="true">image-20220907172221181</figcaption>
</figure>
<p>打开该文件，发现一些乱码</p>
<figure>
<img src="https://cdn.jsdelivr.net/gh/hxt616/PicGo@main/img/image-20220907172336470.png" alt="image-20220907172336470">
<figcaption aria-hidden="true">image-20220907172336470</figcaption>
</figure>
<p>其中包含一段base64编码，解码后得到<code>flag{my_name_is_shumu}</code>。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Reverse/" rel="tag"># Reverse</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/08/21/x86%E6%8C%87%E4%BB%A4/" rel="prev" title="x86指令（Instructions）">
      <i class="fa fa-chevron-left"></i> x86指令（Instructions）
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/08/24/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%EF%BC%88%E5%9B%9B%EF%BC%89/" rel="next" title="汇编语言（四）">
      汇编语言（四） <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#buuctf"><span class="nav-number">1.</span> <span class="nav-text">BUUCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easyre"><span class="nav-number">1.1.</span> <span class="nav-text">1.easyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse1"><span class="nav-number">1.2.</span> <span class="nav-text">2.reverse1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse2"><span class="nav-number">1.3.</span> <span class="nav-text">3.reverse2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E6%B6%B5%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="nav-number">1.4.</span> <span class="nav-text">4.内涵的软件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90"><span class="nav-number">1.5.</span> <span class="nav-text">5.新年快乐</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xor"><span class="nav-number">1.6.</span> <span class="nav-text">6.xor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reverse3"><span class="nav-number">1.7.</span> <span class="nav-text">8.reverse3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84flag"><span class="nav-number">1.8.</span> <span class="nav-text">9.不一样的flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simplerev"><span class="nav-number">1.9.</span> <span class="nav-text">10.SimpleRev</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%AE%E5%BC%80%E6%9C%89%E5%A5%96"><span class="nav-number">1.10.</span> <span class="nav-text">14.刮开有奖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E6%B3%A8%E5%86%8C%E5%99%A8"><span class="nav-number">1.11.</span> <span class="nav-text">15.简单注册器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gwctf-2019pyre"><span class="nav-number">1.12.</span> <span class="nav-text">16.[GWCTF 2019]pyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#actf%E6%96%B0%E7%94%9F%E8%B5%9B2020easyre"><span class="nav-number">1.13.</span> <span class="nav-text">17.[ACTF新生赛2020]easyre</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#findit"><span class="nav-number">1.14.</span> <span class="nav-text">18.findit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rsa"><span class="nav-number">1.15.</span> <span class="nav-text">19.rsa</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#actf%E6%96%B0%E7%94%9F%E8%B5%9B2020rome"><span class="nav-number">1.16.</span> <span class="nav-text">20.[ACTF新生赛2020]rome</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flareon4login"><span class="nav-number">1.17.</span> <span class="nav-text">21.[FlareOn4]login</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crackrtf"><span class="nav-number">1.18.</span> <span class="nav-text">22.CrackRTF</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cftshow"><span class="nav-number">2.</span> <span class="nav-text">cftshow</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%86%E5%90%91%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="nav-number">2.1.</span> <span class="nav-text">1.逆向签到题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C"><span class="nav-number">3.</span> <span class="nav-text">攻防世界</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#game"><span class="nav-number">3.1.</span> <span class="nav-text">1.game</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simple-unpack"><span class="nav-number">3.2.</span> <span class="nav-text">3.simple-unpack</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">3.2.1.</span> <span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">3.2.2.</span> <span class="nav-text">方法二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#logmein"><span class="nav-number">3.3.</span> <span class="nav-text">4.logmein</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#helloctf"><span class="nav-number">3.4.</span> <span class="nav-text">6.Hello，CTF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#getit"><span class="nav-number">3.5.</span> <span class="nav-text">9.getit</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bugku-ctf"><span class="nav-number">4.</span> <span class="nav-text">BugKu CTF</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#easy_vb"><span class="nav-number">4.1.</span> <span class="nav-text">1.Easy_vb</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%86%E5%90%91%E5%85%A5%E9%97%A8"><span class="nav-number">4.2.</span> <span class="nav-text">2.逆向入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#love"><span class="nav-number">4.3.</span> <span class="nav-text">3.love</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E6%9C%A8%E7%9A%84%E5%B0%8F%E7%A7%98%E5%AF%86"><span class="nav-number">4.4.</span> <span class="nav-text">4.树木的小秘密</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="hxt"
      src="/images/hxt.jpg">
  <p class="site-author-name" itemprop="name">hxt</p>
  <div class="site-description" itemprop="description">May the Force be with you.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">55</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hxt</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">164k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:29</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
